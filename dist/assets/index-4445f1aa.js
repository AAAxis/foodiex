(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function ih(t,e){const n=Object.create(null),r=t.split(",");for(let s=0;s<r.length;s++)n[r[s]]=!0;return e?s=>!!n[s.toLowerCase()]:s=>!!n[s]}function oh(t){if(Q(t)){const e={};for(let n=0;n<t.length;n++){const r=t[n],s=Ye(r)?II(r):oh(r);if(s)for(const i in s)e[i]=s[i]}return e}else{if(Ye(t))return t;if(Pe(t))return t}}const yI=/;(?![^(]*\))/g,wI=/:([^]+)/,EI=/\/\*.*?\*\//gs;function II(t){const e={};return t.replace(EI,"").split(yI).forEach(n=>{if(n){const r=n.split(wI);r.length>1&&(e[r[0].trim()]=r[1].trim())}}),e}function wc(t){let e="";if(Ye(t))e=t;else if(Q(t))for(let n=0;n<t.length;n++){const r=wc(t[n]);r&&(e+=r+" ")}else if(Pe(t))for(const n in t)t[n]&&(e+=n+" ");return e.trim()}const vI="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",TI=ih(vI);function Qp(t){return!!t||t===""}function bI(t,e){if(t.length!==e.length)return!1;let n=!0;for(let r=0;n&&r<t.length;r++)n=Ec(t[r],e[r]);return n}function Ec(t,e){if(t===e)return!0;let n=lf(t),r=lf(e);if(n||r)return n&&r?t.getTime()===e.getTime():!1;if(n=so(t),r=so(e),n||r)return t===e;if(n=Q(t),r=Q(e),n||r)return n&&r?bI(t,e):!1;if(n=Pe(t),r=Pe(e),n||r){if(!n||!r)return!1;const s=Object.keys(t).length,i=Object.keys(e).length;if(s!==i)return!1;for(const o in t){const a=t.hasOwnProperty(o),c=e.hasOwnProperty(o);if(a&&!c||!a&&c||!Ec(t[o],e[o]))return!1}}return String(t)===String(e)}function Yp(t,e){return t.findIndex(n=>Ec(n,e))}const he=t=>Ye(t)?t:t==null?"":Q(t)||Pe(t)&&(t.toString===Zp||!se(t.toString))?JSON.stringify(t,Jp,2):String(t),Jp=(t,e)=>e&&e.__v_isRef?Jp(t,e.value):Os(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((n,[r,s])=>(n[`${r} =>`]=s,n),{})}:vc(e)?{[`Set(${e.size})`]:[...e.values()]}:Pe(e)&&!Q(e)&&!eg(e)?String(e):e,Ce={},Ns=[],Zt=()=>{},AI=()=>!1,RI=/^on[^a-z]/,Ic=t=>RI.test(t),ah=t=>t.startsWith("onUpdate:"),Rt=Object.assign,ch=(t,e)=>{const n=t.indexOf(e);n>-1&&t.splice(n,1)},PI=Object.prototype.hasOwnProperty,fe=(t,e)=>PI.call(t,e),Q=Array.isArray,Os=t=>Mo(t)==="[object Map]",vc=t=>Mo(t)==="[object Set]",lf=t=>Mo(t)==="[object Date]",se=t=>typeof t=="function",Ye=t=>typeof t=="string",so=t=>typeof t=="symbol",Pe=t=>t!==null&&typeof t=="object",Xp=t=>Pe(t)&&se(t.then)&&se(t.catch),Zp=Object.prototype.toString,Mo=t=>Zp.call(t),SI=t=>Mo(t).slice(8,-1),eg=t=>Mo(t)==="[object Object]",lh=t=>Ye(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,Sa=ih(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Tc=t=>{const e=Object.create(null);return n=>e[n]||(e[n]=t(n))},CI=/-(\w)/g,Tn=Tc(t=>t.replace(CI,(e,n)=>n?n.toUpperCase():"")),xI=/\B([A-Z])/g,fi=Tc(t=>t.replace(xI,"-$1").toLowerCase()),bc=Tc(t=>t.charAt(0).toUpperCase()+t.slice(1)),Rl=Tc(t=>t?`on${bc(t)}`:""),io=(t,e)=>!Object.is(t,e),Ca=(t,e)=>{for(let n=0;n<t.length;n++)t[n](e)},ja=(t,e,n)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,value:n})},tu=t=>{const e=parseFloat(t);return isNaN(e)?t:e};let uf;const DI=()=>uf||(uf=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});let Yt;class kI{constructor(e=!1){this.detached=e,this._active=!0,this.effects=[],this.cleanups=[],this.parent=Yt,!e&&Yt&&(this.index=(Yt.scopes||(Yt.scopes=[])).push(this)-1)}get active(){return this._active}run(e){if(this._active){const n=Yt;try{return Yt=this,e()}finally{Yt=n}}}on(){Yt=this}off(){Yt=this.parent}stop(e){if(this._active){let n,r;for(n=0,r=this.effects.length;n<r;n++)this.effects[n].stop();for(n=0,r=this.cleanups.length;n<r;n++)this.cleanups[n]();if(this.scopes)for(n=0,r=this.scopes.length;n<r;n++)this.scopes[n].stop(!0);if(!this.detached&&this.parent&&!e){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0,this._active=!1}}}function VI(t,e=Yt){e&&e.active&&e.effects.push(t)}function NI(){return Yt}const uh=t=>{const e=new Set(t);return e.w=0,e.n=0,e},tg=t=>(t.w&ir)>0,ng=t=>(t.n&ir)>0,OI=({deps:t})=>{if(t.length)for(let e=0;e<t.length;e++)t[e].w|=ir},MI=t=>{const{deps:e}=t;if(e.length){let n=0;for(let r=0;r<e.length;r++){const s=e[r];tg(s)&&!ng(s)?s.delete(t):e[n++]=s,s.w&=~ir,s.n&=~ir}e.length=n}},nu=new WeakMap;let Ui=0,ir=1;const ru=30;let Jt;const Wr=Symbol(""),su=Symbol("");class hh{constructor(e,n=null,r){this.fn=e,this.scheduler=n,this.active=!0,this.deps=[],this.parent=void 0,VI(this,r)}run(){if(!this.active)return this.fn();let e=Jt,n=tr;for(;e;){if(e===this)return;e=e.parent}try{return this.parent=Jt,Jt=this,tr=!0,ir=1<<++Ui,Ui<=ru?OI(this):hf(this),this.fn()}finally{Ui<=ru&&MI(this),ir=1<<--Ui,Jt=this.parent,tr=n,this.parent=void 0,this.deferStop&&this.stop()}}stop(){Jt===this?this.deferStop=!0:this.active&&(hf(this),this.onStop&&this.onStop(),this.active=!1)}}function hf(t){const{deps:e}=t;if(e.length){for(let n=0;n<e.length;n++)e[n].delete(t);e.length=0}}let tr=!0;const rg=[];function mi(){rg.push(tr),tr=!1}function pi(){const t=rg.pop();tr=t===void 0?!0:t}function Ot(t,e,n){if(tr&&Jt){let r=nu.get(t);r||nu.set(t,r=new Map);let s=r.get(n);s||r.set(n,s=uh()),sg(s)}}function sg(t,e){let n=!1;Ui<=ru?ng(t)||(t.n|=ir,n=!tg(t)):n=!t.has(Jt),n&&(t.add(Jt),Jt.deps.push(t))}function Nn(t,e,n,r,s,i){const o=nu.get(t);if(!o)return;let a=[];if(e==="clear")a=[...o.values()];else if(n==="length"&&Q(t)){const c=Number(r);o.forEach((l,u)=>{(u==="length"||u>=c)&&a.push(l)})}else switch(n!==void 0&&a.push(o.get(n)),e){case"add":Q(t)?lh(n)&&a.push(o.get("length")):(a.push(o.get(Wr)),Os(t)&&a.push(o.get(su)));break;case"delete":Q(t)||(a.push(o.get(Wr)),Os(t)&&a.push(o.get(su)));break;case"set":Os(t)&&a.push(o.get(Wr));break}if(a.length===1)a[0]&&iu(a[0]);else{const c=[];for(const l of a)l&&c.push(...l);iu(uh(c))}}function iu(t,e){const n=Q(t)?t:[...t];for(const r of n)r.computed&&df(r);for(const r of n)r.computed||df(r)}function df(t,e){(t!==Jt||t.allowRecurse)&&(t.scheduler?t.scheduler():t.run())}const FI=ih("__proto__,__v_isRef,__isVue"),ig=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(so)),LI=dh(),BI=dh(!1,!0),UI=dh(!0),ff=$I();function $I(){const t={};return["includes","indexOf","lastIndexOf"].forEach(e=>{t[e]=function(...n){const r=_e(this);for(let i=0,o=this.length;i<o;i++)Ot(r,"get",i+"");const s=r[e](...n);return s===-1||s===!1?r[e](...n.map(_e)):s}}),["push","pop","shift","unshift","splice"].forEach(e=>{t[e]=function(...n){mi();const r=_e(this)[e].apply(this,n);return pi(),r}}),t}function qI(t){const e=_e(this);return Ot(e,"has",t),e.hasOwnProperty(t)}function dh(t=!1,e=!1){return function(r,s,i){if(s==="__v_isReactive")return!t;if(s==="__v_isReadonly")return t;if(s==="__v_isShallow")return e;if(s==="__v_raw"&&i===(t?e?sv:ug:e?lg:cg).get(r))return r;const o=Q(r);if(!t){if(o&&fe(ff,s))return Reflect.get(ff,s,i);if(s==="hasOwnProperty")return qI}const a=Reflect.get(r,s,i);return(so(s)?ig.has(s):FI(s))||(t||Ot(r,"get",s),e)?a:ht(a)?o&&lh(s)?a:a.value:Pe(a)?t?hg(a):gi(a):a}}const jI=og(),zI=og(!0);function og(t=!1){return function(n,r,s,i){let o=n[r];if(zs(o)&&ht(o)&&!ht(s))return!1;if(!t&&(!za(s)&&!zs(s)&&(o=_e(o),s=_e(s)),!Q(n)&&ht(o)&&!ht(s)))return o.value=s,!0;const a=Q(n)&&lh(r)?Number(r)<n.length:fe(n,r),c=Reflect.set(n,r,s,i);return n===_e(i)&&(a?io(s,o)&&Nn(n,"set",r,s):Nn(n,"add",r,s)),c}}function KI(t,e){const n=fe(t,e);t[e];const r=Reflect.deleteProperty(t,e);return r&&n&&Nn(t,"delete",e,void 0),r}function GI(t,e){const n=Reflect.has(t,e);return(!so(e)||!ig.has(e))&&Ot(t,"has",e),n}function HI(t){return Ot(t,"iterate",Q(t)?"length":Wr),Reflect.ownKeys(t)}const ag={get:LI,set:jI,deleteProperty:KI,has:GI,ownKeys:HI},WI={get:UI,set(t,e){return!0},deleteProperty(t,e){return!0}},QI=Rt({},ag,{get:BI,set:zI}),fh=t=>t,Ac=t=>Reflect.getPrototypeOf(t);function la(t,e,n=!1,r=!1){t=t.__v_raw;const s=_e(t),i=_e(e);n||(e!==i&&Ot(s,"get",e),Ot(s,"get",i));const{has:o}=Ac(s),a=r?fh:n?gh:oo;if(o.call(s,e))return a(t.get(e));if(o.call(s,i))return a(t.get(i));t!==s&&t.get(e)}function ua(t,e=!1){const n=this.__v_raw,r=_e(n),s=_e(t);return e||(t!==s&&Ot(r,"has",t),Ot(r,"has",s)),t===s?n.has(t):n.has(t)||n.has(s)}function ha(t,e=!1){return t=t.__v_raw,!e&&Ot(_e(t),"iterate",Wr),Reflect.get(t,"size",t)}function mf(t){t=_e(t);const e=_e(this);return Ac(e).has.call(e,t)||(e.add(t),Nn(e,"add",t,t)),this}function pf(t,e){e=_e(e);const n=_e(this),{has:r,get:s}=Ac(n);let i=r.call(n,t);i||(t=_e(t),i=r.call(n,t));const o=s.call(n,t);return n.set(t,e),i?io(e,o)&&Nn(n,"set",t,e):Nn(n,"add",t,e),this}function gf(t){const e=_e(this),{has:n,get:r}=Ac(e);let s=n.call(e,t);s||(t=_e(t),s=n.call(e,t)),r&&r.call(e,t);const i=e.delete(t);return s&&Nn(e,"delete",t,void 0),i}function _f(){const t=_e(this),e=t.size!==0,n=t.clear();return e&&Nn(t,"clear",void 0,void 0),n}function da(t,e){return function(r,s){const i=this,o=i.__v_raw,a=_e(o),c=e?fh:t?gh:oo;return!t&&Ot(a,"iterate",Wr),o.forEach((l,u)=>r.call(s,c(l),c(u),i))}}function fa(t,e,n){return function(...r){const s=this.__v_raw,i=_e(s),o=Os(i),a=t==="entries"||t===Symbol.iterator&&o,c=t==="keys"&&o,l=s[t](...r),u=n?fh:e?gh:oo;return!e&&Ot(i,"iterate",c?su:Wr),{next(){const{value:h,done:d}=l.next();return d?{value:h,done:d}:{value:a?[u(h[0]),u(h[1])]:u(h),done:d}},[Symbol.iterator](){return this}}}}function Kn(t){return function(...e){return t==="delete"?!1:this}}function YI(){const t={get(i){return la(this,i)},get size(){return ha(this)},has:ua,add:mf,set:pf,delete:gf,clear:_f,forEach:da(!1,!1)},e={get(i){return la(this,i,!1,!0)},get size(){return ha(this)},has:ua,add:mf,set:pf,delete:gf,clear:_f,forEach:da(!1,!0)},n={get(i){return la(this,i,!0)},get size(){return ha(this,!0)},has(i){return ua.call(this,i,!0)},add:Kn("add"),set:Kn("set"),delete:Kn("delete"),clear:Kn("clear"),forEach:da(!0,!1)},r={get(i){return la(this,i,!0,!0)},get size(){return ha(this,!0)},has(i){return ua.call(this,i,!0)},add:Kn("add"),set:Kn("set"),delete:Kn("delete"),clear:Kn("clear"),forEach:da(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(i=>{t[i]=fa(i,!1,!1),n[i]=fa(i,!0,!1),e[i]=fa(i,!1,!0),r[i]=fa(i,!0,!0)}),[t,n,e,r]}const[JI,XI,ZI,ev]=YI();function mh(t,e){const n=e?t?ev:ZI:t?XI:JI;return(r,s,i)=>s==="__v_isReactive"?!t:s==="__v_isReadonly"?t:s==="__v_raw"?r:Reflect.get(fe(n,s)&&s in r?n:r,s,i)}const tv={get:mh(!1,!1)},nv={get:mh(!1,!0)},rv={get:mh(!0,!1)},cg=new WeakMap,lg=new WeakMap,ug=new WeakMap,sv=new WeakMap;function iv(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function ov(t){return t.__v_skip||!Object.isExtensible(t)?0:iv(SI(t))}function gi(t){return zs(t)?t:ph(t,!1,ag,tv,cg)}function av(t){return ph(t,!1,QI,nv,lg)}function hg(t){return ph(t,!0,WI,rv,ug)}function ph(t,e,n,r,s){if(!Pe(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const i=s.get(t);if(i)return i;const o=ov(t);if(o===0)return t;const a=new Proxy(t,o===2?r:n);return s.set(t,a),a}function Ms(t){return zs(t)?Ms(t.__v_raw):!!(t&&t.__v_isReactive)}function zs(t){return!!(t&&t.__v_isReadonly)}function za(t){return!!(t&&t.__v_isShallow)}function dg(t){return Ms(t)||zs(t)}function _e(t){const e=t&&t.__v_raw;return e?_e(e):t}function fg(t){return ja(t,"__v_skip",!0),t}const oo=t=>Pe(t)?gi(t):t,gh=t=>Pe(t)?hg(t):t;function mg(t){tr&&Jt&&(t=_e(t),sg(t.dep||(t.dep=uh())))}function pg(t,e){t=_e(t);const n=t.dep;n&&iu(n)}function ht(t){return!!(t&&t.__v_isRef===!0)}function cv(t){return gg(t,!1)}function lv(t){return gg(t,!0)}function gg(t,e){return ht(t)?t:new uv(t,e)}class uv{constructor(e,n){this.__v_isShallow=n,this.dep=void 0,this.__v_isRef=!0,this._rawValue=n?e:_e(e),this._value=n?e:oo(e)}get value(){return mg(this),this._value}set value(e){const n=this.__v_isShallow||za(e)||zs(e);e=n?e:_e(e),io(e,this._rawValue)&&(this._rawValue=e,this._value=n?e:oo(e),pg(this))}}function Fs(t){return ht(t)?t.value:t}const hv={get:(t,e,n)=>Fs(Reflect.get(t,e,n)),set:(t,e,n,r)=>{const s=t[e];return ht(s)&&!ht(n)?(s.value=n,!0):Reflect.set(t,e,n,r)}};function _g(t){return Ms(t)?t:new Proxy(t,hv)}var yg;class dv{constructor(e,n,r,s){this._setter=n,this.dep=void 0,this.__v_isRef=!0,this[yg]=!1,this._dirty=!0,this.effect=new hh(e,()=>{this._dirty||(this._dirty=!0,pg(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!s,this.__v_isReadonly=r}get value(){const e=_e(this);return mg(e),(e._dirty||!e._cacheable)&&(e._dirty=!1,e._value=e.effect.run()),e._value}set value(e){this._setter(e)}}yg="__v_isReadonly";function fv(t,e,n=!1){let r,s;const i=se(t);return i?(r=t,s=Zt):(r=t.get,s=t.set),new dv(r,s,i||!s,n)}function nr(t,e,n,r){let s;try{s=r?t(...r):t()}catch(i){Rc(i,e,n)}return s}function en(t,e,n,r){if(se(t)){const i=nr(t,e,n,r);return i&&Xp(i)&&i.catch(o=>{Rc(o,e,n)}),i}const s=[];for(let i=0;i<t.length;i++)s.push(en(t[i],e,n,r));return s}function Rc(t,e,n,r=!0){const s=e?e.vnode:null;if(e){let i=e.parent;const o=e.proxy,a=n;for(;i;){const l=i.ec;if(l){for(let u=0;u<l.length;u++)if(l[u](t,o,a)===!1)return}i=i.parent}const c=e.appContext.config.errorHandler;if(c){nr(c,null,10,[t,o,a]);return}}mv(t,n,s,r)}function mv(t,e,n,r=!0){console.error(t)}let ao=!1,ou=!1;const ut=[];let dn=0;const Ls=[];let Pn=null,Or=0;const wg=Promise.resolve();let _h=null;function Eg(t){const e=_h||wg;return t?e.then(this?t.bind(this):t):e}function pv(t){let e=dn+1,n=ut.length;for(;e<n;){const r=e+n>>>1;co(ut[r])<t?e=r+1:n=r}return e}function yh(t){(!ut.length||!ut.includes(t,ao&&t.allowRecurse?dn+1:dn))&&(t.id==null?ut.push(t):ut.splice(pv(t.id),0,t),Ig())}function Ig(){!ao&&!ou&&(ou=!0,_h=wg.then(Tg))}function gv(t){const e=ut.indexOf(t);e>dn&&ut.splice(e,1)}function _v(t){Q(t)?Ls.push(...t):(!Pn||!Pn.includes(t,t.allowRecurse?Or+1:Or))&&Ls.push(t),Ig()}function yf(t,e=ao?dn+1:0){for(;e<ut.length;e++){const n=ut[e];n&&n.pre&&(ut.splice(e,1),e--,n())}}function vg(t){if(Ls.length){const e=[...new Set(Ls)];if(Ls.length=0,Pn){Pn.push(...e);return}for(Pn=e,Pn.sort((n,r)=>co(n)-co(r)),Or=0;Or<Pn.length;Or++)Pn[Or]();Pn=null,Or=0}}const co=t=>t.id==null?1/0:t.id,yv=(t,e)=>{const n=co(t)-co(e);if(n===0){if(t.pre&&!e.pre)return-1;if(e.pre&&!t.pre)return 1}return n};function Tg(t){ou=!1,ao=!0,ut.sort(yv);const e=Zt;try{for(dn=0;dn<ut.length;dn++){const n=ut[dn];n&&n.active!==!1&&nr(n,null,14)}}finally{dn=0,ut.length=0,vg(),ao=!1,_h=null,(ut.length||Ls.length)&&Tg()}}function wv(t,e,...n){if(t.isUnmounted)return;const r=t.vnode.props||Ce;let s=n;const i=e.startsWith("update:"),o=i&&e.slice(7);if(o&&o in r){const u=`${o==="modelValue"?"model":o}Modifiers`,{number:h,trim:d}=r[u]||Ce;d&&(s=n.map(f=>Ye(f)?f.trim():f)),h&&(s=n.map(tu))}let a,c=r[a=Rl(e)]||r[a=Rl(Tn(e))];!c&&i&&(c=r[a=Rl(fi(e))]),c&&en(c,t,6,s);const l=r[a+"Once"];if(l){if(!t.emitted)t.emitted={};else if(t.emitted[a])return;t.emitted[a]=!0,en(l,t,6,s)}}function bg(t,e,n=!1){const r=e.emitsCache,s=r.get(t);if(s!==void 0)return s;const i=t.emits;let o={},a=!1;if(!se(t)){const c=l=>{const u=bg(l,e,!0);u&&(a=!0,Rt(o,u))};!n&&e.mixins.length&&e.mixins.forEach(c),t.extends&&c(t.extends),t.mixins&&t.mixins.forEach(c)}return!i&&!a?(Pe(t)&&r.set(t,null),null):(Q(i)?i.forEach(c=>o[c]=null):Rt(o,i),Pe(t)&&r.set(t,o),o)}function Pc(t,e){return!t||!Ic(e)?!1:(e=e.slice(2).replace(/Once$/,""),fe(t,e[0].toLowerCase()+e.slice(1))||fe(t,fi(e))||fe(t,e))}let jt=null,Sc=null;function Ka(t){const e=jt;return jt=t,Sc=t&&t.type.__scopeId||null,e}function gr(t){Sc=t}function _r(){Sc=null}function Ks(t,e=jt,n){if(!e||t._n)return t;const r=(...s)=>{r._d&&Pf(-1);const i=Ka(e);let o;try{o=t(...s)}finally{Ka(i),r._d&&Pf(1)}return o};return r._n=!0,r._c=!0,r._d=!0,r}function Pl(t){const{type:e,vnode:n,proxy:r,withProxy:s,props:i,propsOptions:[o],slots:a,attrs:c,emit:l,render:u,renderCache:h,data:d,setupState:f,ctx:y,inheritAttrs:w}=t;let I,b;const D=Ka(t);try{if(n.shapeFlag&4){const B=s||r;I=hn(u.call(B,B,h,i,f,d,y)),b=c}else{const B=e;I=hn(B.length>1?B(i,{attrs:c,slots:a,emit:l}):B(i,null)),b=e.props?c:Ev(c)}}catch(B){Hi.length=0,Rc(B,t,1),I=Qe(Xr)}let R=I;if(b&&w!==!1){const B=Object.keys(b),{shapeFlag:Y}=R;B.length&&Y&7&&(o&&B.some(ah)&&(b=Iv(b,o)),R=Hs(R,b))}return n.dirs&&(R=Hs(R),R.dirs=R.dirs?R.dirs.concat(n.dirs):n.dirs),n.transition&&(R.transition=n.transition),I=R,Ka(D),I}const Ev=t=>{let e;for(const n in t)(n==="class"||n==="style"||Ic(n))&&((e||(e={}))[n]=t[n]);return e},Iv=(t,e)=>{const n={};for(const r in t)(!ah(r)||!(r.slice(9)in e))&&(n[r]=t[r]);return n};function vv(t,e,n){const{props:r,children:s,component:i}=t,{props:o,children:a,patchFlag:c}=e,l=i.emitsOptions;if(e.dirs||e.transition)return!0;if(n&&c>=0){if(c&1024)return!0;if(c&16)return r?wf(r,o,l):!!o;if(c&8){const u=e.dynamicProps;for(let h=0;h<u.length;h++){const d=u[h];if(o[d]!==r[d]&&!Pc(l,d))return!0}}}else return(s||a)&&(!a||!a.$stable)?!0:r===o?!1:r?o?wf(r,o,l):!0:!!o;return!1}function wf(t,e,n){const r=Object.keys(e);if(r.length!==Object.keys(t).length)return!0;for(let s=0;s<r.length;s++){const i=r[s];if(e[i]!==t[i]&&!Pc(n,i))return!0}return!1}function Tv({vnode:t,parent:e},n){for(;e&&e.subTree===t;)(t=e.vnode).el=n,e=e.parent}const bv=t=>t.__isSuspense;function Av(t,e){e&&e.pendingBranch?Q(t)?e.effects.push(...t):e.effects.push(t):_v(t)}function xa(t,e){if(We){let n=We.provides;const r=We.parent&&We.parent.provides;r===n&&(n=We.provides=Object.create(r)),n[t]=e}}function kn(t,e,n=!1){const r=We||jt;if(r){const s=r.parent==null?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides;if(s&&t in s)return s[t];if(arguments.length>1)return n&&se(e)?e.call(r.proxy):e}}const ma={};function Da(t,e,n){return Ag(t,e,n)}function Ag(t,e,{immediate:n,deep:r,flush:s,onTrack:i,onTrigger:o}=Ce){const a=NI()===(We==null?void 0:We.scope)?We:null;let c,l=!1,u=!1;if(ht(t)?(c=()=>t.value,l=za(t)):Ms(t)?(c=()=>t,r=!0):Q(t)?(u=!0,l=t.some(R=>Ms(R)||za(R)),c=()=>t.map(R=>{if(ht(R))return R.value;if(Ms(R))return jr(R);if(se(R))return nr(R,a,2)})):se(t)?e?c=()=>nr(t,a,2):c=()=>{if(!(a&&a.isUnmounted))return h&&h(),en(t,a,3,[d])}:c=Zt,e&&r){const R=c;c=()=>jr(R())}let h,d=R=>{h=b.onStop=()=>{nr(R,a,4)}},f;if(uo)if(d=Zt,e?n&&en(e,a,3,[c(),u?[]:void 0,d]):c(),s==="sync"){const R=ET();f=R.__watcherHandles||(R.__watcherHandles=[])}else return Zt;let y=u?new Array(t.length).fill(ma):ma;const w=()=>{if(b.active)if(e){const R=b.run();(r||l||(u?R.some((B,Y)=>io(B,y[Y])):io(R,y)))&&(h&&h(),en(e,a,3,[R,y===ma?void 0:u&&y[0]===ma?[]:y,d]),y=R)}else b.run()};w.allowRecurse=!!e;let I;s==="sync"?I=w:s==="post"?I=()=>Ct(w,a&&a.suspense):(w.pre=!0,a&&(w.id=a.uid),I=()=>yh(w));const b=new hh(c,I);e?n?w():y=b.run():s==="post"?Ct(b.run.bind(b),a&&a.suspense):b.run();const D=()=>{b.stop(),a&&a.scope&&ch(a.scope.effects,b)};return f&&f.push(D),D}function Rv(t,e,n){const r=this.proxy,s=Ye(t)?t.includes(".")?Rg(r,t):()=>r[t]:t.bind(r,r);let i;se(e)?i=e:(i=e.handler,n=e);const o=We;Ws(this);const a=Ag(s,i.bind(r),n);return o?Ws(o):Qr(),a}function Rg(t,e){const n=e.split(".");return()=>{let r=t;for(let s=0;s<n.length&&r;s++)r=r[n[s]];return r}}function jr(t,e){if(!Pe(t)||t.__v_skip||(e=e||new Set,e.has(t)))return t;if(e.add(t),ht(t))jr(t.value,e);else if(Q(t))for(let n=0;n<t.length;n++)jr(t[n],e);else if(vc(t)||Os(t))t.forEach(n=>{jr(n,e)});else if(eg(t))for(const n in t)jr(t[n],e);return t}function wh(t){return se(t)?{setup:t,name:t.name}:t}const ka=t=>!!t.type.__asyncLoader,Pg=t=>t.type.__isKeepAlive;function Pv(t,e){Sg(t,"a",e)}function Sv(t,e){Sg(t,"da",e)}function Sg(t,e,n=We){const r=t.__wdc||(t.__wdc=()=>{let s=n;for(;s;){if(s.isDeactivated)return;s=s.parent}return t()});if(Cc(e,r,n),n){let s=n.parent;for(;s&&s.parent;)Pg(s.parent.vnode)&&Cv(r,e,n,s),s=s.parent}}function Cv(t,e,n,r){const s=Cc(e,t,r,!0);Cg(()=>{ch(r[e],s)},n)}function Cc(t,e,n=We,r=!1){if(n){const s=n[t]||(n[t]=[]),i=e.__weh||(e.__weh=(...o)=>{if(n.isUnmounted)return;mi(),Ws(n);const a=en(e,n,t,o);return Qr(),pi(),a});return r?s.unshift(i):s.push(i),i}}const Bn=t=>(e,n=We)=>(!uo||t==="sp")&&Cc(t,(...r)=>e(...r),n),xv=Bn("bm"),Dv=Bn("m"),kv=Bn("bu"),Vv=Bn("u"),Nv=Bn("bum"),Cg=Bn("um"),Ov=Bn("sp"),Mv=Bn("rtg"),Fv=Bn("rtc");function Lv(t,e=We){Cc("ec",t,e)}function tn(t,e){const n=jt;if(n===null)return t;const r=kc(n)||n.proxy,s=t.dirs||(t.dirs=[]);for(let i=0;i<e.length;i++){let[o,a,c,l=Ce]=e[i];o&&(se(o)&&(o={mounted:o,updated:o}),o.deep&&jr(a),s.push({dir:o,instance:r,value:a,oldValue:void 0,arg:c,modifiers:l}))}return t}function Cr(t,e,n,r){const s=t.dirs,i=e&&e.dirs;for(let o=0;o<s.length;o++){const a=s[o];i&&(a.oldValue=i[o].value);let c=a.dir[r];c&&(mi(),en(c,n,8,[t.el,a,t,e]),pi())}}const xg="components";function Fo(t,e){return Uv(xg,t,!0,e)||t}const Bv=Symbol();function Uv(t,e,n=!0,r=!1){const s=jt||We;if(s){const i=s.type;if(t===xg){const a=_T(i,!1);if(a&&(a===e||a===Tn(e)||a===bc(Tn(e))))return i}const o=Ef(s[t]||i[t],e)||Ef(s.appContext[t],e);return!o&&r?i:o}}function Ef(t,e){return t&&(t[e]||t[Tn(e)]||t[bc(Tn(e))])}function Gs(t,e,n,r){let s;const i=n&&n[r];if(Q(t)||Ye(t)){s=new Array(t.length);for(let o=0,a=t.length;o<a;o++)s[o]=e(t[o],o,void 0,i&&i[o])}else if(typeof t=="number"){s=new Array(t);for(let o=0;o<t;o++)s[o]=e(o+1,o,void 0,i&&i[o])}else if(Pe(t))if(t[Symbol.iterator])s=Array.from(t,(o,a)=>e(o,a,void 0,i&&i[a]));else{const o=Object.keys(t);s=new Array(o.length);for(let a=0,c=o.length;a<c;a++){const l=o[a];s[a]=e(t[l],l,a,i&&i[a])}}else s=[];return n&&(n[r]=s),s}const au=t=>t?$g(t)?kc(t)||t.proxy:au(t.parent):null,Gi=Rt(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>au(t.parent),$root:t=>au(t.root),$emit:t=>t.emit,$options:t=>Eh(t),$forceUpdate:t=>t.f||(t.f=()=>yh(t.update)),$nextTick:t=>t.n||(t.n=Eg.bind(t.proxy)),$watch:t=>Rv.bind(t)}),Sl=(t,e)=>t!==Ce&&!t.__isScriptSetup&&fe(t,e),$v={get({_:t},e){const{ctx:n,setupState:r,data:s,props:i,accessCache:o,type:a,appContext:c}=t;let l;if(e[0]!=="$"){const f=o[e];if(f!==void 0)switch(f){case 1:return r[e];case 2:return s[e];case 4:return n[e];case 3:return i[e]}else{if(Sl(r,e))return o[e]=1,r[e];if(s!==Ce&&fe(s,e))return o[e]=2,s[e];if((l=t.propsOptions[0])&&fe(l,e))return o[e]=3,i[e];if(n!==Ce&&fe(n,e))return o[e]=4,n[e];cu&&(o[e]=0)}}const u=Gi[e];let h,d;if(u)return e==="$attrs"&&Ot(t,"get",e),u(t);if((h=a.__cssModules)&&(h=h[e]))return h;if(n!==Ce&&fe(n,e))return o[e]=4,n[e];if(d=c.config.globalProperties,fe(d,e))return d[e]},set({_:t},e,n){const{data:r,setupState:s,ctx:i}=t;return Sl(s,e)?(s[e]=n,!0):r!==Ce&&fe(r,e)?(r[e]=n,!0):fe(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(i[e]=n,!0)},has({_:{data:t,setupState:e,accessCache:n,ctx:r,appContext:s,propsOptions:i}},o){let a;return!!n[o]||t!==Ce&&fe(t,o)||Sl(e,o)||(a=i[0])&&fe(a,o)||fe(r,o)||fe(Gi,o)||fe(s.config.globalProperties,o)},defineProperty(t,e,n){return n.get!=null?t._.accessCache[e]=0:fe(n,"value")&&this.set(t,e,n.value,null),Reflect.defineProperty(t,e,n)}};let cu=!0;function qv(t){const e=Eh(t),n=t.proxy,r=t.ctx;cu=!1,e.beforeCreate&&If(e.beforeCreate,t,"bc");const{data:s,computed:i,methods:o,watch:a,provide:c,inject:l,created:u,beforeMount:h,mounted:d,beforeUpdate:f,updated:y,activated:w,deactivated:I,beforeDestroy:b,beforeUnmount:D,destroyed:R,unmounted:B,render:Y,renderTracked:Z,renderTriggered:ge,errorCaptured:Be,serverPrefetch:Ut,expose:Mt,inheritAttrs:zn,components:cn,directives:_s,filters:Pr}=e;if(l&&jv(l,r,null,t.appContext.config.unwrapInjectedRef),o)for(const Ae in o){const Ie=o[Ae];se(Ie)&&(r[Ae]=Ie.bind(n))}if(s){const Ae=s.call(n,n);Pe(Ae)&&(t.data=gi(Ae))}if(cu=!0,i)for(const Ae in i){const Ie=i[Ae],Ht=se(Ie)?Ie.bind(n,n):se(Ie.get)?Ie.get.bind(n,n):Zt,Sr=!se(Ie)&&se(Ie.set)?Ie.set.bind(n):Zt,Wt=$t({get:Ht,set:Sr});Object.defineProperty(r,Ae,{enumerable:!0,configurable:!0,get:()=>Wt.value,set:St=>Wt.value=St})}if(a)for(const Ae in a)Dg(a[Ae],r,n,Ae);if(c){const Ae=se(c)?c.call(n):c;Reflect.ownKeys(Ae).forEach(Ie=>{xa(Ie,Ae[Ie])})}u&&If(u,t,"c");function Ke(Ae,Ie){Q(Ie)?Ie.forEach(Ht=>Ae(Ht.bind(n))):Ie&&Ae(Ie.bind(n))}if(Ke(xv,h),Ke(Dv,d),Ke(kv,f),Ke(Vv,y),Ke(Pv,w),Ke(Sv,I),Ke(Lv,Be),Ke(Fv,Z),Ke(Mv,ge),Ke(Nv,D),Ke(Cg,B),Ke(Ov,Ut),Q(Mt))if(Mt.length){const Ae=t.exposed||(t.exposed={});Mt.forEach(Ie=>{Object.defineProperty(Ae,Ie,{get:()=>n[Ie],set:Ht=>n[Ie]=Ht})})}else t.exposed||(t.exposed={});Y&&t.render===Zt&&(t.render=Y),zn!=null&&(t.inheritAttrs=zn),cn&&(t.components=cn),_s&&(t.directives=_s)}function jv(t,e,n=Zt,r=!1){Q(t)&&(t=lu(t));for(const s in t){const i=t[s];let o;Pe(i)?"default"in i?o=kn(i.from||s,i.default,!0):o=kn(i.from||s):o=kn(i),ht(o)&&r?Object.defineProperty(e,s,{enumerable:!0,configurable:!0,get:()=>o.value,set:a=>o.value=a}):e[s]=o}}function If(t,e,n){en(Q(t)?t.map(r=>r.bind(e.proxy)):t.bind(e.proxy),e,n)}function Dg(t,e,n,r){const s=r.includes(".")?Rg(n,r):()=>n[r];if(Ye(t)){const i=e[t];se(i)&&Da(s,i)}else if(se(t))Da(s,t.bind(n));else if(Pe(t))if(Q(t))t.forEach(i=>Dg(i,e,n,r));else{const i=se(t.handler)?t.handler.bind(n):e[t.handler];se(i)&&Da(s,i,t)}}function Eh(t){const e=t.type,{mixins:n,extends:r}=e,{mixins:s,optionsCache:i,config:{optionMergeStrategies:o}}=t.appContext,a=i.get(e);let c;return a?c=a:!s.length&&!n&&!r?c=e:(c={},s.length&&s.forEach(l=>Ga(c,l,o,!0)),Ga(c,e,o)),Pe(e)&&i.set(e,c),c}function Ga(t,e,n,r=!1){const{mixins:s,extends:i}=e;i&&Ga(t,i,n,!0),s&&s.forEach(o=>Ga(t,o,n,!0));for(const o in e)if(!(r&&o==="expose")){const a=zv[o]||n&&n[o];t[o]=a?a(t[o],e[o]):e[o]}return t}const zv={data:vf,props:kr,emits:kr,methods:kr,computed:kr,beforeCreate:_t,created:_t,beforeMount:_t,mounted:_t,beforeUpdate:_t,updated:_t,beforeDestroy:_t,beforeUnmount:_t,destroyed:_t,unmounted:_t,activated:_t,deactivated:_t,errorCaptured:_t,serverPrefetch:_t,components:kr,directives:kr,watch:Gv,provide:vf,inject:Kv};function vf(t,e){return e?t?function(){return Rt(se(t)?t.call(this,this):t,se(e)?e.call(this,this):e)}:e:t}function Kv(t,e){return kr(lu(t),lu(e))}function lu(t){if(Q(t)){const e={};for(let n=0;n<t.length;n++)e[t[n]]=t[n];return e}return t}function _t(t,e){return t?[...new Set([].concat(t,e))]:e}function kr(t,e){return t?Rt(Rt(Object.create(null),t),e):e}function Gv(t,e){if(!t)return e;if(!e)return t;const n=Rt(Object.create(null),t);for(const r in e)n[r]=_t(t[r],e[r]);return n}function Hv(t,e,n,r=!1){const s={},i={};ja(i,Dc,1),t.propsDefaults=Object.create(null),kg(t,e,s,i);for(const o in t.propsOptions[0])o in s||(s[o]=void 0);n?t.props=r?s:av(s):t.type.props?t.props=s:t.props=i,t.attrs=i}function Wv(t,e,n,r){const{props:s,attrs:i,vnode:{patchFlag:o}}=t,a=_e(s),[c]=t.propsOptions;let l=!1;if((r||o>0)&&!(o&16)){if(o&8){const u=t.vnode.dynamicProps;for(let h=0;h<u.length;h++){let d=u[h];if(Pc(t.emitsOptions,d))continue;const f=e[d];if(c)if(fe(i,d))f!==i[d]&&(i[d]=f,l=!0);else{const y=Tn(d);s[y]=uu(c,a,y,f,t,!1)}else f!==i[d]&&(i[d]=f,l=!0)}}}else{kg(t,e,s,i)&&(l=!0);let u;for(const h in a)(!e||!fe(e,h)&&((u=fi(h))===h||!fe(e,u)))&&(c?n&&(n[h]!==void 0||n[u]!==void 0)&&(s[h]=uu(c,a,h,void 0,t,!0)):delete s[h]);if(i!==a)for(const h in i)(!e||!fe(e,h))&&(delete i[h],l=!0)}l&&Nn(t,"set","$attrs")}function kg(t,e,n,r){const[s,i]=t.propsOptions;let o=!1,a;if(e)for(let c in e){if(Sa(c))continue;const l=e[c];let u;s&&fe(s,u=Tn(c))?!i||!i.includes(u)?n[u]=l:(a||(a={}))[u]=l:Pc(t.emitsOptions,c)||(!(c in r)||l!==r[c])&&(r[c]=l,o=!0)}if(i){const c=_e(n),l=a||Ce;for(let u=0;u<i.length;u++){const h=i[u];n[h]=uu(s,c,h,l[h],t,!fe(l,h))}}return o}function uu(t,e,n,r,s,i){const o=t[n];if(o!=null){const a=fe(o,"default");if(a&&r===void 0){const c=o.default;if(o.type!==Function&&se(c)){const{propsDefaults:l}=s;n in l?r=l[n]:(Ws(s),r=l[n]=c.call(null,e),Qr())}else r=c}o[0]&&(i&&!a?r=!1:o[1]&&(r===""||r===fi(n))&&(r=!0))}return r}function Vg(t,e,n=!1){const r=e.propsCache,s=r.get(t);if(s)return s;const i=t.props,o={},a=[];let c=!1;if(!se(t)){const u=h=>{c=!0;const[d,f]=Vg(h,e,!0);Rt(o,d),f&&a.push(...f)};!n&&e.mixins.length&&e.mixins.forEach(u),t.extends&&u(t.extends),t.mixins&&t.mixins.forEach(u)}if(!i&&!c)return Pe(t)&&r.set(t,Ns),Ns;if(Q(i))for(let u=0;u<i.length;u++){const h=Tn(i[u]);Tf(h)&&(o[h]=Ce)}else if(i)for(const u in i){const h=Tn(u);if(Tf(h)){const d=i[u],f=o[h]=Q(d)||se(d)?{type:d}:Object.assign({},d);if(f){const y=Rf(Boolean,f.type),w=Rf(String,f.type);f[0]=y>-1,f[1]=w<0||y<w,(y>-1||fe(f,"default"))&&a.push(h)}}}const l=[o,a];return Pe(t)&&r.set(t,l),l}function Tf(t){return t[0]!=="$"}function bf(t){const e=t&&t.toString().match(/^\s*(function|class) (\w+)/);return e?e[2]:t===null?"null":""}function Af(t,e){return bf(t)===bf(e)}function Rf(t,e){return Q(e)?e.findIndex(n=>Af(n,t)):se(e)&&Af(e,t)?0:-1}const Ng=t=>t[0]==="_"||t==="$stable",Ih=t=>Q(t)?t.map(hn):[hn(t)],Qv=(t,e,n)=>{if(e._n)return e;const r=Ks((...s)=>Ih(e(...s)),n);return r._c=!1,r},Og=(t,e,n)=>{const r=t._ctx;for(const s in t){if(Ng(s))continue;const i=t[s];if(se(i))e[s]=Qv(s,i,r);else if(i!=null){const o=Ih(i);e[s]=()=>o}}},Mg=(t,e)=>{const n=Ih(e);t.slots.default=()=>n},Yv=(t,e)=>{if(t.vnode.shapeFlag&32){const n=e._;n?(t.slots=_e(e),ja(e,"_",n)):Og(e,t.slots={})}else t.slots={},e&&Mg(t,e);ja(t.slots,Dc,1)},Jv=(t,e,n)=>{const{vnode:r,slots:s}=t;let i=!0,o=Ce;if(r.shapeFlag&32){const a=e._;a?n&&a===1?i=!1:(Rt(s,e),!n&&a===1&&delete s._):(i=!e.$stable,Og(e,s)),o=e}else e&&(Mg(t,e),o={default:1});if(i)for(const a in s)!Ng(a)&&!(a in o)&&delete s[a]};function Fg(){return{app:null,config:{isNativeTag:AI,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Xv=0;function Zv(t,e){return function(r,s=null){se(r)||(r=Object.assign({},r)),s!=null&&!Pe(s)&&(s=null);const i=Fg(),o=new Set;let a=!1;const c=i.app={_uid:Xv++,_component:r,_props:s,_container:null,_context:i,_instance:null,version:IT,get config(){return i.config},set config(l){},use(l,...u){return o.has(l)||(l&&se(l.install)?(o.add(l),l.install(c,...u)):se(l)&&(o.add(l),l(c,...u))),c},mixin(l){return i.mixins.includes(l)||i.mixins.push(l),c},component(l,u){return u?(i.components[l]=u,c):i.components[l]},directive(l,u){return u?(i.directives[l]=u,c):i.directives[l]},mount(l,u,h){if(!a){const d=Qe(r,s);return d.appContext=i,u&&e?e(d,l):t(d,l,h),a=!0,c._container=l,l.__vue_app__=c,kc(d.component)||d.component.proxy}},unmount(){a&&(t(null,c._container),delete c._container.__vue_app__)},provide(l,u){return i.provides[l]=u,c}};return c}}function hu(t,e,n,r,s=!1){if(Q(t)){t.forEach((d,f)=>hu(d,e&&(Q(e)?e[f]:e),n,r,s));return}if(ka(r)&&!s)return;const i=r.shapeFlag&4?kc(r.component)||r.component.proxy:r.el,o=s?null:i,{i:a,r:c}=t,l=e&&e.r,u=a.refs===Ce?a.refs={}:a.refs,h=a.setupState;if(l!=null&&l!==c&&(Ye(l)?(u[l]=null,fe(h,l)&&(h[l]=null)):ht(l)&&(l.value=null)),se(c))nr(c,a,12,[o,u]);else{const d=Ye(c),f=ht(c);if(d||f){const y=()=>{if(t.f){const w=d?fe(h,c)?h[c]:u[c]:c.value;s?Q(w)&&ch(w,i):Q(w)?w.includes(i)||w.push(i):d?(u[c]=[i],fe(h,c)&&(h[c]=u[c])):(c.value=[i],t.k&&(u[t.k]=c.value))}else d?(u[c]=o,fe(h,c)&&(h[c]=o)):f&&(c.value=o,t.k&&(u[t.k]=o))};o?(y.id=-1,Ct(y,n)):y()}}}const Ct=Av;function eT(t){return tT(t)}function tT(t,e){const n=DI();n.__VUE__=!0;const{insert:r,remove:s,patchProp:i,createElement:o,createText:a,createComment:c,setText:l,setElementText:u,parentNode:h,nextSibling:d,setScopeId:f=Zt,insertStaticContent:y}=t,w=(p,g,v,T=null,C=null,V=null,U=!1,k=null,O=!!g.dynamicChildren)=>{if(p===g)return;p&&!xi(p,g)&&(T=L(p),St(p,C,V,!0),p=null),g.patchFlag===-2&&(O=!1,g.dynamicChildren=null);const{type:x,ref:H,shapeFlag:j}=g;switch(x){case xc:I(p,g,v,T);break;case Xr:b(p,g,v,T);break;case Va:p==null&&D(g,v,T,U);break;case It:cn(p,g,v,T,C,V,U,k,O);break;default:j&1?Y(p,g,v,T,C,V,U,k,O):j&6?_s(p,g,v,T,C,V,U,k,O):(j&64||j&128)&&x.process(p,g,v,T,C,V,U,k,O,de)}H!=null&&C&&hu(H,p&&p.ref,V,g||p,!g)},I=(p,g,v,T)=>{if(p==null)r(g.el=a(g.children),v,T);else{const C=g.el=p.el;g.children!==p.children&&l(C,g.children)}},b=(p,g,v,T)=>{p==null?r(g.el=c(g.children||""),v,T):g.el=p.el},D=(p,g,v,T)=>{[p.el,p.anchor]=y(p.children,g,v,T,p.el,p.anchor)},R=({el:p,anchor:g},v,T)=>{let C;for(;p&&p!==g;)C=d(p),r(p,v,T),p=C;r(g,v,T)},B=({el:p,anchor:g})=>{let v;for(;p&&p!==g;)v=d(p),s(p),p=v;s(g)},Y=(p,g,v,T,C,V,U,k,O)=>{U=U||g.type==="svg",p==null?Z(g,v,T,C,V,U,k,O):Ut(p,g,C,V,U,k,O)},Z=(p,g,v,T,C,V,U,k)=>{let O,x;const{type:H,props:j,shapeFlag:W,transition:X,dirs:oe}=p;if(O=p.el=o(p.type,V,j&&j.is,j),W&8?u(O,p.children):W&16&&Be(p.children,O,null,T,C,V&&H!=="foreignObject",U,k),oe&&Cr(p,null,T,"created"),ge(O,p,p.scopeId,U,T),j){for(const ve in j)ve!=="value"&&!Sa(ve)&&i(O,ve,null,j[ve],V,p.children,T,C,q);"value"in j&&i(O,"value",null,j.value),(x=j.onVnodeBeforeMount)&&un(x,T,p)}oe&&Cr(p,null,T,"beforeMount");const Re=(!C||C&&!C.pendingBranch)&&X&&!X.persisted;Re&&X.beforeEnter(O),r(O,g,v),((x=j&&j.onVnodeMounted)||Re||oe)&&Ct(()=>{x&&un(x,T,p),Re&&X.enter(O),oe&&Cr(p,null,T,"mounted")},C)},ge=(p,g,v,T,C)=>{if(v&&f(p,v),T)for(let V=0;V<T.length;V++)f(p,T[V]);if(C){let V=C.subTree;if(g===V){const U=C.vnode;ge(p,U,U.scopeId,U.slotScopeIds,C.parent)}}},Be=(p,g,v,T,C,V,U,k,O=0)=>{for(let x=O;x<p.length;x++){const H=p[x]=k?Yn(p[x]):hn(p[x]);w(null,H,g,v,T,C,V,U,k)}},Ut=(p,g,v,T,C,V,U)=>{const k=g.el=p.el;let{patchFlag:O,dynamicChildren:x,dirs:H}=g;O|=p.patchFlag&16;const j=p.props||Ce,W=g.props||Ce;let X;v&&xr(v,!1),(X=W.onVnodeBeforeUpdate)&&un(X,v,g,p),H&&Cr(g,p,v,"beforeUpdate"),v&&xr(v,!0);const oe=C&&g.type!=="foreignObject";if(x?Mt(p.dynamicChildren,x,k,v,T,oe,V):U||Ie(p,g,k,null,v,T,oe,V,!1),O>0){if(O&16)zn(k,g,j,W,v,T,C);else if(O&2&&j.class!==W.class&&i(k,"class",null,W.class,C),O&4&&i(k,"style",j.style,W.style,C),O&8){const Re=g.dynamicProps;for(let ve=0;ve<Re.length;ve++){const Ge=Re[ve],Qt=j[Ge],ws=W[Ge];(ws!==Qt||Ge==="value")&&i(k,Ge,Qt,ws,C,p.children,v,T,q)}}O&1&&p.children!==g.children&&u(k,g.children)}else!U&&x==null&&zn(k,g,j,W,v,T,C);((X=W.onVnodeUpdated)||H)&&Ct(()=>{X&&un(X,v,g,p),H&&Cr(g,p,v,"updated")},T)},Mt=(p,g,v,T,C,V,U)=>{for(let k=0;k<g.length;k++){const O=p[k],x=g[k],H=O.el&&(O.type===It||!xi(O,x)||O.shapeFlag&70)?h(O.el):v;w(O,x,H,null,T,C,V,U,!0)}},zn=(p,g,v,T,C,V,U)=>{if(v!==T){if(v!==Ce)for(const k in v)!Sa(k)&&!(k in T)&&i(p,k,v[k],null,U,g.children,C,V,q);for(const k in T){if(Sa(k))continue;const O=T[k],x=v[k];O!==x&&k!=="value"&&i(p,k,x,O,U,g.children,C,V,q)}"value"in T&&i(p,"value",v.value,T.value)}},cn=(p,g,v,T,C,V,U,k,O)=>{const x=g.el=p?p.el:a(""),H=g.anchor=p?p.anchor:a("");let{patchFlag:j,dynamicChildren:W,slotScopeIds:X}=g;X&&(k=k?k.concat(X):X),p==null?(r(x,v,T),r(H,v,T),Be(g.children,v,H,C,V,U,k,O)):j>0&&j&64&&W&&p.dynamicChildren?(Mt(p.dynamicChildren,W,v,C,V,U,k),(g.key!=null||C&&g===C.subTree)&&Lg(p,g,!0)):Ie(p,g,v,H,C,V,U,k,O)},_s=(p,g,v,T,C,V,U,k,O)=>{g.slotScopeIds=k,p==null?g.shapeFlag&512?C.ctx.activate(g,v,T,U,O):Pr(g,v,T,C,V,U,O):Si(p,g,O)},Pr=(p,g,v,T,C,V,U)=>{const k=p.component=dT(p,T,C);if(Pg(p)&&(k.ctx.renderer=de),fT(k),k.asyncDep){if(C&&C.registerDep(k,Ke),!p.el){const O=k.subTree=Qe(Xr);b(null,O,g,v)}return}Ke(k,p,g,v,C,V,U)},Si=(p,g,v)=>{const T=g.component=p.component;if(vv(p,g,v))if(T.asyncDep&&!T.asyncResolved){Ae(T,g,v);return}else T.next=g,gv(T.update),T.update();else g.el=p.el,T.vnode=g},Ke=(p,g,v,T,C,V,U)=>{const k=()=>{if(p.isMounted){let{next:H,bu:j,u:W,parent:X,vnode:oe}=p,Re=H,ve;xr(p,!1),H?(H.el=oe.el,Ae(p,H,U)):H=oe,j&&Ca(j),(ve=H.props&&H.props.onVnodeBeforeUpdate)&&un(ve,X,H,oe),xr(p,!0);const Ge=Pl(p),Qt=p.subTree;p.subTree=Ge,w(Qt,Ge,h(Qt.el),L(Qt),p,C,V),H.el=Ge.el,Re===null&&Tv(p,Ge.el),W&&Ct(W,C),(ve=H.props&&H.props.onVnodeUpdated)&&Ct(()=>un(ve,X,H,oe),C)}else{let H;const{el:j,props:W}=g,{bm:X,m:oe,parent:Re}=p,ve=ka(g);if(xr(p,!1),X&&Ca(X),!ve&&(H=W&&W.onVnodeBeforeMount)&&un(H,Re,g),xr(p,!0),j&&ie){const Ge=()=>{p.subTree=Pl(p),ie(j,p.subTree,p,C,null)};ve?g.type.__asyncLoader().then(()=>!p.isUnmounted&&Ge()):Ge()}else{const Ge=p.subTree=Pl(p);w(null,Ge,v,T,p,C,V),g.el=Ge.el}if(oe&&Ct(oe,C),!ve&&(H=W&&W.onVnodeMounted)){const Ge=g;Ct(()=>un(H,Re,Ge),C)}(g.shapeFlag&256||Re&&ka(Re.vnode)&&Re.vnode.shapeFlag&256)&&p.a&&Ct(p.a,C),p.isMounted=!0,g=v=T=null}},O=p.effect=new hh(k,()=>yh(x),p.scope),x=p.update=()=>O.run();x.id=p.uid,xr(p,!0),x()},Ae=(p,g,v)=>{g.component=p;const T=p.vnode.props;p.vnode=g,p.next=null,Wv(p,g.props,T,v),Jv(p,g.children,v),mi(),yf(),pi()},Ie=(p,g,v,T,C,V,U,k,O=!1)=>{const x=p&&p.children,H=p?p.shapeFlag:0,j=g.children,{patchFlag:W,shapeFlag:X}=g;if(W>0){if(W&128){Sr(x,j,v,T,C,V,U,k,O);return}else if(W&256){Ht(x,j,v,T,C,V,U,k,O);return}}X&8?(H&16&&q(x,C,V),j!==x&&u(v,j)):H&16?X&16?Sr(x,j,v,T,C,V,U,k,O):q(x,C,V,!0):(H&8&&u(v,""),X&16&&Be(j,v,T,C,V,U,k,O))},Ht=(p,g,v,T,C,V,U,k,O)=>{p=p||Ns,g=g||Ns;const x=p.length,H=g.length,j=Math.min(x,H);let W;for(W=0;W<j;W++){const X=g[W]=O?Yn(g[W]):hn(g[W]);w(p[W],X,v,null,C,V,U,k,O)}x>H?q(p,C,V,!0,!1,j):Be(g,v,T,C,V,U,k,O,j)},Sr=(p,g,v,T,C,V,U,k,O)=>{let x=0;const H=g.length;let j=p.length-1,W=H-1;for(;x<=j&&x<=W;){const X=p[x],oe=g[x]=O?Yn(g[x]):hn(g[x]);if(xi(X,oe))w(X,oe,v,null,C,V,U,k,O);else break;x++}for(;x<=j&&x<=W;){const X=p[j],oe=g[W]=O?Yn(g[W]):hn(g[W]);if(xi(X,oe))w(X,oe,v,null,C,V,U,k,O);else break;j--,W--}if(x>j){if(x<=W){const X=W+1,oe=X<H?g[X].el:T;for(;x<=W;)w(null,g[x]=O?Yn(g[x]):hn(g[x]),v,oe,C,V,U,k,O),x++}}else if(x>W)for(;x<=j;)St(p[x],C,V,!0),x++;else{const X=x,oe=x,Re=new Map;for(x=oe;x<=W;x++){const Ft=g[x]=O?Yn(g[x]):hn(g[x]);Ft.key!=null&&Re.set(Ft.key,x)}let ve,Ge=0;const Qt=W-oe+1;let ws=!1,of=0;const Ci=new Array(Qt);for(x=0;x<Qt;x++)Ci[x]=0;for(x=X;x<=j;x++){const Ft=p[x];if(Ge>=Qt){St(Ft,C,V,!0);continue}let ln;if(Ft.key!=null)ln=Re.get(Ft.key);else for(ve=oe;ve<=W;ve++)if(Ci[ve-oe]===0&&xi(Ft,g[ve])){ln=ve;break}ln===void 0?St(Ft,C,V,!0):(Ci[ln-oe]=x+1,ln>=of?of=ln:ws=!0,w(Ft,g[ln],v,null,C,V,U,k,O),Ge++)}const af=ws?nT(Ci):Ns;for(ve=af.length-1,x=Qt-1;x>=0;x--){const Ft=oe+x,ln=g[Ft],cf=Ft+1<H?g[Ft+1].el:T;Ci[x]===0?w(null,ln,v,cf,C,V,U,k,O):ws&&(ve<0||x!==af[ve]?Wt(ln,v,cf,2):ve--)}}},Wt=(p,g,v,T,C=null)=>{const{el:V,type:U,transition:k,children:O,shapeFlag:x}=p;if(x&6){Wt(p.component.subTree,g,v,T);return}if(x&128){p.suspense.move(g,v,T);return}if(x&64){U.move(p,g,v,de);return}if(U===It){r(V,g,v);for(let j=0;j<O.length;j++)Wt(O[j],g,v,T);r(p.anchor,g,v);return}if(U===Va){R(p,g,v);return}if(T!==2&&x&1&&k)if(T===0)k.beforeEnter(V),r(V,g,v),Ct(()=>k.enter(V),C);else{const{leave:j,delayLeave:W,afterLeave:X}=k,oe=()=>r(V,g,v),Re=()=>{j(V,()=>{oe(),X&&X()})};W?W(V,oe,Re):Re()}else r(V,g,v)},St=(p,g,v,T=!1,C=!1)=>{const{type:V,props:U,ref:k,children:O,dynamicChildren:x,shapeFlag:H,patchFlag:j,dirs:W}=p;if(k!=null&&hu(k,null,v,p,!0),H&256){g.ctx.deactivate(p);return}const X=H&1&&W,oe=!ka(p);let Re;if(oe&&(Re=U&&U.onVnodeBeforeUnmount)&&un(Re,g,p),H&6)A(p.component,v,T);else{if(H&128){p.suspense.unmount(v,T);return}X&&Cr(p,null,g,"beforeUnmount"),H&64?p.type.remove(p,g,v,C,de,T):x&&(V!==It||j>0&&j&64)?q(x,g,v,!1,!0):(V===It&&j&384||!C&&H&16)&&q(O,g,v),T&&ys(p)}(oe&&(Re=U&&U.onVnodeUnmounted)||X)&&Ct(()=>{Re&&un(Re,g,p),X&&Cr(p,null,g,"unmounted")},v)},ys=p=>{const{type:g,el:v,anchor:T,transition:C}=p;if(g===It){ca(v,T);return}if(g===Va){B(p);return}const V=()=>{s(v),C&&!C.persisted&&C.afterLeave&&C.afterLeave()};if(p.shapeFlag&1&&C&&!C.persisted){const{leave:U,delayLeave:k}=C,O=()=>U(v,V);k?k(p.el,V,O):O()}else V()},ca=(p,g)=>{let v;for(;p!==g;)v=d(p),s(p),p=v;s(g)},A=(p,g,v)=>{const{bum:T,scope:C,update:V,subTree:U,um:k}=p;T&&Ca(T),C.stop(),V&&(V.active=!1,St(U,p,g,v)),k&&Ct(k,g),Ct(()=>{p.isUnmounted=!0},g),g&&g.pendingBranch&&!g.isUnmounted&&p.asyncDep&&!p.asyncResolved&&p.suspenseId===g.pendingId&&(g.deps--,g.deps===0&&g.resolve())},q=(p,g,v,T=!1,C=!1,V=0)=>{for(let U=V;U<p.length;U++)St(p[U],g,v,T,C)},L=p=>p.shapeFlag&6?L(p.component.subTree):p.shapeFlag&128?p.suspense.next():d(p.anchor||p.el),G=(p,g,v)=>{p==null?g._vnode&&St(g._vnode,null,null,!0):w(g._vnode||null,p,g,null,null,null,v),yf(),vg(),g._vnode=p},de={p:w,um:St,m:Wt,r:ys,mt:Pr,mc:Be,pc:Ie,pbc:Mt,n:L,o:t};let Me,ie;return e&&([Me,ie]=e(de)),{render:G,hydrate:Me,createApp:Zv(G,Me)}}function xr({effect:t,update:e},n){t.allowRecurse=e.allowRecurse=n}function Lg(t,e,n=!1){const r=t.children,s=e.children;if(Q(r)&&Q(s))for(let i=0;i<r.length;i++){const o=r[i];let a=s[i];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=s[i]=Yn(s[i]),a.el=o.el),n||Lg(o,a)),a.type===xc&&(a.el=o.el)}}function nT(t){const e=t.slice(),n=[0];let r,s,i,o,a;const c=t.length;for(r=0;r<c;r++){const l=t[r];if(l!==0){if(s=n[n.length-1],t[s]<l){e[r]=s,n.push(r);continue}for(i=0,o=n.length-1;i<o;)a=i+o>>1,t[n[a]]<l?i=a+1:o=a;l<t[n[i]]&&(i>0&&(e[r]=n[i-1]),n[i]=r)}}for(i=n.length,o=n[i-1];i-- >0;)n[i]=o,o=e[o];return n}const rT=t=>t.__isTeleport,It=Symbol(void 0),xc=Symbol(void 0),Xr=Symbol(void 0),Va=Symbol(void 0),Hi=[];let Xt=null;function te(t=!1){Hi.push(Xt=t?null:[])}function sT(){Hi.pop(),Xt=Hi[Hi.length-1]||null}let lo=1;function Pf(t){lo+=t}function Bg(t){return t.dynamicChildren=lo>0?Xt||Ns:null,sT(),lo>0&&Xt&&Xt.push(t),t}function ne(t,e,n,r,s,i){return Bg(m(t,e,n,r,s,i,!0))}function iT(t,e,n,r,s){return Bg(Qe(t,e,n,r,s,!0))}function du(t){return t?t.__v_isVNode===!0:!1}function xi(t,e){return t.type===e.type&&t.key===e.key}const Dc="__vInternal",Ug=({key:t})=>t??null,Na=({ref:t,ref_key:e,ref_for:n})=>t!=null?Ye(t)||ht(t)||se(t)?{i:jt,r:t,k:e,f:!!n}:t:null;function m(t,e=null,n=null,r=0,s=null,i=t===It?0:1,o=!1,a=!1){const c={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&Ug(e),ref:e&&Na(e),scopeId:Sc,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:r,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:jt};return a?(vh(c,n),i&128&&t.normalize(c)):n&&(c.shapeFlag|=Ye(n)?8:16),lo>0&&!o&&Xt&&(c.patchFlag>0||i&6)&&c.patchFlag!==32&&Xt.push(c),c}const Qe=oT;function oT(t,e=null,n=null,r=0,s=null,i=!1){if((!t||t===Bv)&&(t=Xr),du(t)){const a=Hs(t,e,!0);return n&&vh(a,n),lo>0&&!i&&Xt&&(a.shapeFlag&6?Xt[Xt.indexOf(t)]=a:Xt.push(a)),a.patchFlag|=-2,a}if(yT(t)&&(t=t.__vccOpts),e){e=aT(e);let{class:a,style:c}=e;a&&!Ye(a)&&(e.class=wc(a)),Pe(c)&&(dg(c)&&!Q(c)&&(c=Rt({},c)),e.style=oh(c))}const o=Ye(t)?1:bv(t)?128:rT(t)?64:Pe(t)?4:se(t)?2:0;return m(t,e,n,r,s,o,i,!0)}function aT(t){return t?dg(t)||Dc in t?Rt({},t):t:null}function Hs(t,e,n=!1){const{props:r,ref:s,patchFlag:i,children:o}=t,a=e?lT(r||{},e):r;return{__v_isVNode:!0,__v_skip:!0,type:t.type,props:a,key:a&&Ug(a),ref:e&&e.ref?n&&s?Q(s)?s.concat(Na(e)):[s,Na(e)]:Na(e):s,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:o,target:t.target,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==It?i===-1?16:i|16:i,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:t.transition,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&Hs(t.ssContent),ssFallback:t.ssFallback&&Hs(t.ssFallback),el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce}}function Dt(t=" ",e=0){return Qe(xc,null,t,e)}function cT(t,e){const n=Qe(Va,null,t);return n.staticCount=e,n}function Tt(t="",e=!1){return e?(te(),iT(Xr,null,t)):Qe(Xr,null,t)}function hn(t){return t==null||typeof t=="boolean"?Qe(Xr):Q(t)?Qe(It,null,t.slice()):typeof t=="object"?Yn(t):Qe(xc,null,String(t))}function Yn(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:Hs(t)}function vh(t,e){let n=0;const{shapeFlag:r}=t;if(e==null)e=null;else if(Q(e))n=16;else if(typeof e=="object")if(r&65){const s=e.default;s&&(s._c&&(s._d=!1),vh(t,s()),s._c&&(s._d=!0));return}else{n=32;const s=e._;!s&&!(Dc in e)?e._ctx=jt:s===3&&jt&&(jt.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else se(e)?(e={default:e,_ctx:jt},n=32):(e=String(e),r&64?(n=16,e=[Dt(e)]):n=8);t.children=e,t.shapeFlag|=n}function lT(...t){const e={};for(let n=0;n<t.length;n++){const r=t[n];for(const s in r)if(s==="class")e.class!==r.class&&(e.class=wc([e.class,r.class]));else if(s==="style")e.style=oh([e.style,r.style]);else if(Ic(s)){const i=e[s],o=r[s];o&&i!==o&&!(Q(i)&&i.includes(o))&&(e[s]=i?[].concat(i,o):o)}else s!==""&&(e[s]=r[s])}return e}function un(t,e,n,r=null){en(t,e,7,[n,r])}const uT=Fg();let hT=0;function dT(t,e,n){const r=t.type,s=(e?e.appContext:t.appContext)||uT,i={uid:hT++,vnode:t,type:r,parent:e,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,scope:new kI(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(s.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Vg(r,s),emitsOptions:bg(r,s),emit:null,emitted:null,propsDefaults:Ce,inheritAttrs:r.inheritAttrs,ctx:Ce,data:Ce,props:Ce,attrs:Ce,slots:Ce,refs:Ce,setupState:Ce,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=e?e.root:i,i.emit=wv.bind(null,i),t.ce&&t.ce(i),i}let We=null;const Ws=t=>{We=t,t.scope.on()},Qr=()=>{We&&We.scope.off(),We=null};function $g(t){return t.vnode.shapeFlag&4}let uo=!1;function fT(t,e=!1){uo=e;const{props:n,children:r}=t.vnode,s=$g(t);Hv(t,n,s,e),Yv(t,r);const i=s?mT(t,e):void 0;return uo=!1,i}function mT(t,e){const n=t.type;t.accessCache=Object.create(null),t.proxy=fg(new Proxy(t.ctx,$v));const{setup:r}=n;if(r){const s=t.setupContext=r.length>1?gT(t):null;Ws(t),mi();const i=nr(r,t,0,[t.props,s]);if(pi(),Qr(),Xp(i)){if(i.then(Qr,Qr),e)return i.then(o=>{Sf(t,o,e)}).catch(o=>{Rc(o,t,0)});t.asyncDep=i}else Sf(t,i,e)}else qg(t,e)}function Sf(t,e,n){se(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:Pe(e)&&(t.setupState=_g(e)),qg(t,n)}let Cf;function qg(t,e,n){const r=t.type;if(!t.render){if(!e&&Cf&&!r.render){const s=r.template||Eh(t).template;if(s){const{isCustomElement:i,compilerOptions:o}=t.appContext.config,{delimiters:a,compilerOptions:c}=r,l=Rt(Rt({isCustomElement:i,delimiters:a},o),c);r.render=Cf(s,l)}}t.render=r.render||Zt}Ws(t),mi(),qv(t),pi(),Qr()}function pT(t){return new Proxy(t.attrs,{get(e,n){return Ot(t,"get","$attrs"),e[n]}})}function gT(t){const e=r=>{t.exposed=r||{}};let n;return{get attrs(){return n||(n=pT(t))},slots:t.slots,emit:t.emit,expose:e}}function kc(t){if(t.exposed)return t.exposeProxy||(t.exposeProxy=new Proxy(_g(fg(t.exposed)),{get(e,n){if(n in e)return e[n];if(n in Gi)return Gi[n](t)},has(e,n){return n in e||n in Gi}}))}function _T(t,e=!0){return se(t)?t.displayName||t.name:t.name||e&&t.__name}function yT(t){return se(t)&&"__vccOpts"in t}const $t=(t,e)=>fv(t,e,uo);function jg(t,e,n){const r=arguments.length;return r===2?Pe(e)&&!Q(e)?du(e)?Qe(t,null,[e]):Qe(t,e):Qe(t,null,e):(r>3?n=Array.prototype.slice.call(arguments,2):r===3&&du(n)&&(n=[n]),Qe(t,e,n))}const wT=Symbol(""),ET=()=>kn(wT),IT="3.2.47",vT="http://www.w3.org/2000/svg",Mr=typeof document<"u"?document:null,xf=Mr&&Mr.createElement("template"),TT={insert:(t,e,n)=>{e.insertBefore(t,n||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,n,r)=>{const s=e?Mr.createElementNS(vT,t):Mr.createElement(t,n?{is:n}:void 0);return t==="select"&&r&&r.multiple!=null&&s.setAttribute("multiple",r.multiple),s},createText:t=>Mr.createTextNode(t),createComment:t=>Mr.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>Mr.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,n,r,s,i){const o=n?n.previousSibling:e.lastChild;if(s&&(s===i||s.nextSibling))for(;e.insertBefore(s.cloneNode(!0),n),!(s===i||!(s=s.nextSibling)););else{xf.innerHTML=r?`<svg>${t}</svg>`:t;const a=xf.content;if(r){const c=a.firstChild;for(;c.firstChild;)a.appendChild(c.firstChild);a.removeChild(c)}e.insertBefore(a,n)}return[o?o.nextSibling:e.firstChild,n?n.previousSibling:e.lastChild]}};function bT(t,e,n){const r=t._vtc;r&&(e=(e?[e,...r]:[...r]).join(" ")),e==null?t.removeAttribute("class"):n?t.setAttribute("class",e):t.className=e}function AT(t,e,n){const r=t.style,s=Ye(n);if(n&&!s){if(e&&!Ye(e))for(const i in e)n[i]==null&&fu(r,i,"");for(const i in n)fu(r,i,n[i])}else{const i=r.display;s?e!==n&&(r.cssText=n):e&&t.removeAttribute("style"),"_vod"in t&&(r.display=i)}}const Df=/\s*!important$/;function fu(t,e,n){if(Q(n))n.forEach(r=>fu(t,e,r));else if(n==null&&(n=""),e.startsWith("--"))t.setProperty(e,n);else{const r=RT(t,e);Df.test(n)?t.setProperty(fi(r),n.replace(Df,""),"important"):t[r]=n}}const kf=["Webkit","Moz","ms"],Cl={};function RT(t,e){const n=Cl[e];if(n)return n;let r=Tn(e);if(r!=="filter"&&r in t)return Cl[e]=r;r=bc(r);for(let s=0;s<kf.length;s++){const i=kf[s]+r;if(i in t)return Cl[e]=i}return e}const Vf="http://www.w3.org/1999/xlink";function PT(t,e,n,r,s){if(r&&e.startsWith("xlink:"))n==null?t.removeAttributeNS(Vf,e.slice(6,e.length)):t.setAttributeNS(Vf,e,n);else{const i=TI(e);n==null||i&&!Qp(n)?t.removeAttribute(e):t.setAttribute(e,i?"":n)}}function ST(t,e,n,r,s,i,o){if(e==="innerHTML"||e==="textContent"){r&&o(r,s,i),t[e]=n??"";return}if(e==="value"&&t.tagName!=="PROGRESS"&&!t.tagName.includes("-")){t._value=n;const c=n??"";(t.value!==c||t.tagName==="OPTION")&&(t.value=c),n==null&&t.removeAttribute(e);return}let a=!1;if(n===""||n==null){const c=typeof t[e];c==="boolean"?n=Qp(n):n==null&&c==="string"?(n="",a=!0):c==="number"&&(n=0,a=!0)}try{t[e]=n}catch{}a&&t.removeAttribute(e)}function Fr(t,e,n,r){t.addEventListener(e,n,r)}function CT(t,e,n,r){t.removeEventListener(e,n,r)}function xT(t,e,n,r,s=null){const i=t._vei||(t._vei={}),o=i[e];if(r&&o)o.value=r;else{const[a,c]=DT(e);if(r){const l=i[e]=NT(r,s);Fr(t,a,l,c)}else o&&(CT(t,a,o,c),i[e]=void 0)}}const Nf=/(?:Once|Passive|Capture)$/;function DT(t){let e;if(Nf.test(t)){e={};let r;for(;r=t.match(Nf);)t=t.slice(0,t.length-r[0].length),e[r[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):fi(t.slice(2)),e]}let xl=0;const kT=Promise.resolve(),VT=()=>xl||(kT.then(()=>xl=0),xl=Date.now());function NT(t,e){const n=r=>{if(!r._vts)r._vts=Date.now();else if(r._vts<=n.attached)return;en(OT(r,n.value),e,5,[r])};return n.value=t,n.attached=VT(),n}function OT(t,e){if(Q(e)){const n=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{n.call(t),t._stopped=!0},e.map(r=>s=>!s._stopped&&r&&r(s))}else return e}const Of=/^on[a-z]/,MT=(t,e,n,r,s=!1,i,o,a,c)=>{e==="class"?bT(t,r,s):e==="style"?AT(t,n,r):Ic(e)?ah(e)||xT(t,e,n,r,o):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):FT(t,e,r,s))?ST(t,e,r,i,o,a,c):(e==="true-value"?t._trueValue=r:e==="false-value"&&(t._falseValue=r),PT(t,e,r,s))};function FT(t,e,n,r){return r?!!(e==="innerHTML"||e==="textContent"||e in t&&Of.test(e)&&se(n)):e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA"||Of.test(e)&&Ye(n)?!1:e in t}const Ha=t=>{const e=t.props["onUpdate:modelValue"]||!1;return Q(e)?n=>Ca(e,n):e};function LT(t){t.target.composing=!0}function Mf(t){const e=t.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const wn={created(t,{modifiers:{lazy:e,trim:n,number:r}},s){t._assign=Ha(s);const i=r||s.props&&s.props.type==="number";Fr(t,e?"change":"input",o=>{if(o.target.composing)return;let a=t.value;n&&(a=a.trim()),i&&(a=tu(a)),t._assign(a)}),n&&Fr(t,"change",()=>{t.value=t.value.trim()}),e||(Fr(t,"compositionstart",LT),Fr(t,"compositionend",Mf),Fr(t,"change",Mf))},mounted(t,{value:e}){t.value=e??""},beforeUpdate(t,{value:e,modifiers:{lazy:n,trim:r,number:s}},i){if(t._assign=Ha(i),t.composing||document.activeElement===t&&t.type!=="range"&&(n||r&&t.value.trim()===e||(s||t.type==="number")&&tu(t.value)===e))return;const o=e??"";t.value!==o&&(t.value=o)}},BT={deep:!0,created(t,e,n){t._assign=Ha(n),Fr(t,"change",()=>{const r=t._modelValue,s=UT(t),i=t.checked,o=t._assign;if(Q(r)){const a=Yp(r,s),c=a!==-1;if(i&&!c)o(r.concat(s));else if(!i&&c){const l=[...r];l.splice(a,1),o(l)}}else if(vc(r)){const a=new Set(r);i?a.add(s):a.delete(s),o(a)}else o(zg(t,i))})},mounted:Ff,beforeUpdate(t,e,n){t._assign=Ha(n),Ff(t,e,n)}};function Ff(t,{value:e,oldValue:n},r){t._modelValue=e,Q(e)?t.checked=Yp(e,r.props.value)>-1:vc(e)?t.checked=e.has(r.props.value):e!==n&&(t.checked=Ec(e,zg(t,!0)))}function UT(t){return"_value"in t?t._value:t.value}function zg(t,e){const n=e?"_trueValue":"_falseValue";return n in t?t[n]:e}const $T=["ctrl","shift","alt","meta"],qT={stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:t=>t.target!==t.currentTarget,ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>"button"in t&&t.button!==0,middle:t=>"button"in t&&t.button!==1,right:t=>"button"in t&&t.button!==2,exact:(t,e)=>$T.some(n=>t[`${n}Key`]&&!e.includes(n))},Vc=(t,e)=>(n,...r)=>{for(let s=0;s<e.length;s++){const i=qT[e[s]];if(i&&i(n,e))return}return t(n,...r)},jT=Rt({patchProp:MT},TT);let Lf;function zT(){return Lf||(Lf=eT(jT))}const KT=(...t)=>{const e=zT().createApp(...t),{mount:n}=e;return e.mount=r=>{const s=GT(r);if(!s)return;const i=e._component;!se(i)&&!i.render&&!i.template&&(i.template=s.innerHTML),s.innerHTML="";const o=n(s,!1,s instanceof SVGElement);return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),o},e};function GT(t){return Ye(t)?document.querySelector(t):t}const an=(t,e)=>{const n=t.__vccOpts||t;for(const[r,s]of e)n[r]=s;return n},HT=wh({name:"App"}),WT={id:"app"};function QT(t,e,n,r,s,i){const o=Fo("router-view");return te(),ne("div",WT,[Qe(o)])}const YT=an(HT,[["render",QT]]);/*!
  * vue-router v4.1.6
  * (c) 2022 Eduardo San Martin Morote
  * @license MIT
  */const Ps=typeof window<"u";function JT(t){return t.__esModule||t[Symbol.toStringTag]==="Module"}const ye=Object.assign;function Dl(t,e){const n={};for(const r in e){const s=e[r];n[r]=rn(s)?s.map(t):t(s)}return n}const Wi=()=>{},rn=Array.isArray,XT=/\/$/,ZT=t=>t.replace(XT,"");function kl(t,e,n="/"){let r,s={},i="",o="";const a=e.indexOf("#");let c=e.indexOf("?");return a<c&&a>=0&&(c=-1),c>-1&&(r=e.slice(0,c),i=e.slice(c+1,a>-1?a:e.length),s=t(i)),a>-1&&(r=r||e.slice(0,a),o=e.slice(a,e.length)),r=rb(r??e,n),{fullPath:r+(i&&"?")+i+o,path:r,query:s,hash:o}}function eb(t,e){const n=e.query?t(e.query):"";return e.path+(n&&"?")+n+(e.hash||"")}function Bf(t,e){return!e||!t.toLowerCase().startsWith(e.toLowerCase())?t:t.slice(e.length)||"/"}function tb(t,e,n){const r=e.matched.length-1,s=n.matched.length-1;return r>-1&&r===s&&Qs(e.matched[r],n.matched[s])&&Kg(e.params,n.params)&&t(e.query)===t(n.query)&&e.hash===n.hash}function Qs(t,e){return(t.aliasOf||t)===(e.aliasOf||e)}function Kg(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(!nb(t[n],e[n]))return!1;return!0}function nb(t,e){return rn(t)?Uf(t,e):rn(e)?Uf(e,t):t===e}function Uf(t,e){return rn(e)?t.length===e.length&&t.every((n,r)=>n===e[r]):t.length===1&&t[0]===e}function rb(t,e){if(t.startsWith("/"))return t;if(!t)return e;const n=e.split("/"),r=t.split("/");let s=n.length-1,i,o;for(i=0;i<r.length;i++)if(o=r[i],o!==".")if(o==="..")s>1&&s--;else break;return n.slice(0,s).join("/")+"/"+r.slice(i-(i===r.length?1:0)).join("/")}var ho;(function(t){t.pop="pop",t.push="push"})(ho||(ho={}));var Qi;(function(t){t.back="back",t.forward="forward",t.unknown=""})(Qi||(Qi={}));function sb(t){if(!t)if(Ps){const e=document.querySelector("base");t=e&&e.getAttribute("href")||"/",t=t.replace(/^\w+:\/\/[^\/]+/,"")}else t="/";return t[0]!=="/"&&t[0]!=="#"&&(t="/"+t),ZT(t)}const ib=/^[^#]+#/;function ob(t,e){return t.replace(ib,"#")+e}function ab(t,e){const n=document.documentElement.getBoundingClientRect(),r=t.getBoundingClientRect();return{behavior:e.behavior,left:r.left-n.left-(e.left||0),top:r.top-n.top-(e.top||0)}}const Nc=()=>({left:window.pageXOffset,top:window.pageYOffset});function cb(t){let e;if("el"in t){const n=t.el,r=typeof n=="string"&&n.startsWith("#"),s=typeof n=="string"?r?document.getElementById(n.slice(1)):document.querySelector(n):n;if(!s)return;e=ab(s,t)}else e=t;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.pageXOffset,e.top!=null?e.top:window.pageYOffset)}function $f(t,e){return(history.state?history.state.position-e:-1)+t}const mu=new Map;function lb(t,e){mu.set(t,e)}function ub(t){const e=mu.get(t);return mu.delete(t),e}let hb=()=>location.protocol+"//"+location.host;function Gg(t,e){const{pathname:n,search:r,hash:s}=e,i=t.indexOf("#");if(i>-1){let a=s.includes(t.slice(i))?t.slice(i).length:1,c=s.slice(a);return c[0]!=="/"&&(c="/"+c),Bf(c,"")}return Bf(n,t)+r+s}function db(t,e,n,r){let s=[],i=[],o=null;const a=({state:d})=>{const f=Gg(t,location),y=n.value,w=e.value;let I=0;if(d){if(n.value=f,e.value=d,o&&o===y){o=null;return}I=w?d.position-w.position:0}else r(f);s.forEach(b=>{b(n.value,y,{delta:I,type:ho.pop,direction:I?I>0?Qi.forward:Qi.back:Qi.unknown})})};function c(){o=n.value}function l(d){s.push(d);const f=()=>{const y=s.indexOf(d);y>-1&&s.splice(y,1)};return i.push(f),f}function u(){const{history:d}=window;d.state&&d.replaceState(ye({},d.state,{scroll:Nc()}),"")}function h(){for(const d of i)d();i=[],window.removeEventListener("popstate",a),window.removeEventListener("beforeunload",u)}return window.addEventListener("popstate",a),window.addEventListener("beforeunload",u),{pauseListeners:c,listen:l,destroy:h}}function qf(t,e,n,r=!1,s=!1){return{back:t,current:e,forward:n,replaced:r,position:window.history.length,scroll:s?Nc():null}}function fb(t){const{history:e,location:n}=window,r={value:Gg(t,n)},s={value:e.state};s.value||i(r.value,{back:null,current:r.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function i(c,l,u){const h=t.indexOf("#"),d=h>-1?(n.host&&document.querySelector("base")?t:t.slice(h))+c:hb()+t+c;try{e[u?"replaceState":"pushState"](l,"",d),s.value=l}catch(f){console.error(f),n[u?"replace":"assign"](d)}}function o(c,l){const u=ye({},e.state,qf(s.value.back,c,s.value.forward,!0),l,{position:s.value.position});i(c,u,!0),r.value=c}function a(c,l){const u=ye({},s.value,e.state,{forward:c,scroll:Nc()});i(u.current,u,!0);const h=ye({},qf(r.value,c,null),{position:u.position+1},l);i(c,h,!1),r.value=c}return{location:r,state:s,push:a,replace:o}}function mb(t){t=sb(t);const e=fb(t),n=db(t,e.state,e.location,e.replace);function r(i,o=!0){o||n.pauseListeners(),history.go(i)}const s=ye({location:"",base:t,go:r,createHref:ob.bind(null,t)},e,n);return Object.defineProperty(s,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(s,"state",{enumerable:!0,get:()=>e.state.value}),s}function pb(t){return typeof t=="string"||t&&typeof t=="object"}function Hg(t){return typeof t=="string"||typeof t=="symbol"}const Gn={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},Wg=Symbol("");var jf;(function(t){t[t.aborted=4]="aborted",t[t.cancelled=8]="cancelled",t[t.duplicated=16]="duplicated"})(jf||(jf={}));function Ys(t,e){return ye(new Error,{type:t,[Wg]:!0},e)}function Rn(t,e){return t instanceof Error&&Wg in t&&(e==null||!!(t.type&e))}const zf="[^/]+?",gb={sensitive:!1,strict:!1,start:!0,end:!0},_b=/[.+*?^${}()[\]/\\]/g;function yb(t,e){const n=ye({},gb,e),r=[];let s=n.start?"^":"";const i=[];for(const l of t){const u=l.length?[]:[90];n.strict&&!l.length&&(s+="/");for(let h=0;h<l.length;h++){const d=l[h];let f=40+(n.sensitive?.25:0);if(d.type===0)h||(s+="/"),s+=d.value.replace(_b,"\\$&"),f+=40;else if(d.type===1){const{value:y,repeatable:w,optional:I,regexp:b}=d;i.push({name:y,repeatable:w,optional:I});const D=b||zf;if(D!==zf){f+=10;try{new RegExp(`(${D})`)}catch(B){throw new Error(`Invalid custom RegExp for param "${y}" (${D}): `+B.message)}}let R=w?`((?:${D})(?:/(?:${D}))*)`:`(${D})`;h||(R=I&&l.length<2?`(?:/${R})`:"/"+R),I&&(R+="?"),s+=R,f+=20,I&&(f+=-8),w&&(f+=-20),D===".*"&&(f+=-50)}u.push(f)}r.push(u)}if(n.strict&&n.end){const l=r.length-1;r[l][r[l].length-1]+=.7000000000000001}n.strict||(s+="/?"),n.end?s+="$":n.strict&&(s+="(?:/|$)");const o=new RegExp(s,n.sensitive?"":"i");function a(l){const u=l.match(o),h={};if(!u)return null;for(let d=1;d<u.length;d++){const f=u[d]||"",y=i[d-1];h[y.name]=f&&y.repeatable?f.split("/"):f}return h}function c(l){let u="",h=!1;for(const d of t){(!h||!u.endsWith("/"))&&(u+="/"),h=!1;for(const f of d)if(f.type===0)u+=f.value;else if(f.type===1){const{value:y,repeatable:w,optional:I}=f,b=y in l?l[y]:"";if(rn(b)&&!w)throw new Error(`Provided param "${y}" is an array but it is not repeatable (* or + modifiers)`);const D=rn(b)?b.join("/"):b;if(!D)if(I)d.length<2&&(u.endsWith("/")?u=u.slice(0,-1):h=!0);else throw new Error(`Missing required param "${y}"`);u+=D}}return u||"/"}return{re:o,score:r,keys:i,parse:a,stringify:c}}function wb(t,e){let n=0;for(;n<t.length&&n<e.length;){const r=e[n]-t[n];if(r)return r;n++}return t.length<e.length?t.length===1&&t[0]===40+40?-1:1:t.length>e.length?e.length===1&&e[0]===40+40?1:-1:0}function Eb(t,e){let n=0;const r=t.score,s=e.score;for(;n<r.length&&n<s.length;){const i=wb(r[n],s[n]);if(i)return i;n++}if(Math.abs(s.length-r.length)===1){if(Kf(r))return 1;if(Kf(s))return-1}return s.length-r.length}function Kf(t){const e=t[t.length-1];return t.length>0&&e[e.length-1]<0}const Ib={type:0,value:""},vb=/[a-zA-Z0-9_]/;function Tb(t){if(!t)return[[]];if(t==="/")return[[Ib]];if(!t.startsWith("/"))throw new Error(`Invalid path "${t}"`);function e(f){throw new Error(`ERR (${n})/"${l}": ${f}`)}let n=0,r=n;const s=[];let i;function o(){i&&s.push(i),i=[]}let a=0,c,l="",u="";function h(){l&&(n===0?i.push({type:0,value:l}):n===1||n===2||n===3?(i.length>1&&(c==="*"||c==="+")&&e(`A repeatable param (${l}) must be alone in its segment. eg: '/:ids+.`),i.push({type:1,value:l,regexp:u,repeatable:c==="*"||c==="+",optional:c==="*"||c==="?"})):e("Invalid state to consume buffer"),l="")}function d(){l+=c}for(;a<t.length;){if(c=t[a++],c==="\\"&&n!==2){r=n,n=4;continue}switch(n){case 0:c==="/"?(l&&h(),o()):c===":"?(h(),n=1):d();break;case 4:d(),n=r;break;case 1:c==="("?n=2:vb.test(c)?d():(h(),n=0,c!=="*"&&c!=="?"&&c!=="+"&&a--);break;case 2:c===")"?u[u.length-1]=="\\"?u=u.slice(0,-1)+c:n=3:u+=c;break;case 3:h(),n=0,c!=="*"&&c!=="?"&&c!=="+"&&a--,u="";break;default:e("Unknown state");break}}return n===2&&e(`Unfinished custom RegExp for param "${l}"`),h(),o(),s}function bb(t,e,n){const r=yb(Tb(t.path),n),s=ye(r,{record:t,parent:e,children:[],alias:[]});return e&&!s.record.aliasOf==!e.record.aliasOf&&e.children.push(s),s}function Ab(t,e){const n=[],r=new Map;e=Wf({strict:!1,end:!0,sensitive:!1},e);function s(u){return r.get(u)}function i(u,h,d){const f=!d,y=Rb(u);y.aliasOf=d&&d.record;const w=Wf(e,u),I=[y];if("alias"in u){const R=typeof u.alias=="string"?[u.alias]:u.alias;for(const B of R)I.push(ye({},y,{components:d?d.record.components:y.components,path:B,aliasOf:d?d.record:y}))}let b,D;for(const R of I){const{path:B}=R;if(h&&B[0]!=="/"){const Y=h.record.path,Z=Y[Y.length-1]==="/"?"":"/";R.path=h.record.path+(B&&Z+B)}if(b=bb(R,h,w),d?d.alias.push(b):(D=D||b,D!==b&&D.alias.push(b),f&&u.name&&!Hf(b)&&o(u.name)),y.children){const Y=y.children;for(let Z=0;Z<Y.length;Z++)i(Y[Z],b,d&&d.children[Z])}d=d||b,(b.record.components&&Object.keys(b.record.components).length||b.record.name||b.record.redirect)&&c(b)}return D?()=>{o(D)}:Wi}function o(u){if(Hg(u)){const h=r.get(u);h&&(r.delete(u),n.splice(n.indexOf(h),1),h.children.forEach(o),h.alias.forEach(o))}else{const h=n.indexOf(u);h>-1&&(n.splice(h,1),u.record.name&&r.delete(u.record.name),u.children.forEach(o),u.alias.forEach(o))}}function a(){return n}function c(u){let h=0;for(;h<n.length&&Eb(u,n[h])>=0&&(u.record.path!==n[h].record.path||!Qg(u,n[h]));)h++;n.splice(h,0,u),u.record.name&&!Hf(u)&&r.set(u.record.name,u)}function l(u,h){let d,f={},y,w;if("name"in u&&u.name){if(d=r.get(u.name),!d)throw Ys(1,{location:u});w=d.record.name,f=ye(Gf(h.params,d.keys.filter(D=>!D.optional).map(D=>D.name)),u.params&&Gf(u.params,d.keys.map(D=>D.name))),y=d.stringify(f)}else if("path"in u)y=u.path,d=n.find(D=>D.re.test(y)),d&&(f=d.parse(y),w=d.record.name);else{if(d=h.name?r.get(h.name):n.find(D=>D.re.test(h.path)),!d)throw Ys(1,{location:u,currentLocation:h});w=d.record.name,f=ye({},h.params,u.params),y=d.stringify(f)}const I=[];let b=d;for(;b;)I.unshift(b.record),b=b.parent;return{name:w,path:y,params:f,matched:I,meta:Sb(I)}}return t.forEach(u=>i(u)),{addRoute:i,resolve:l,removeRoute:o,getRoutes:a,getRecordMatcher:s}}function Gf(t,e){const n={};for(const r of e)r in t&&(n[r]=t[r]);return n}function Rb(t){return{path:t.path,redirect:t.redirect,name:t.name,meta:t.meta||{},aliasOf:void 0,beforeEnter:t.beforeEnter,props:Pb(t),children:t.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in t?t.components||null:t.component&&{default:t.component}}}function Pb(t){const e={},n=t.props||!1;if("component"in t)e.default=n;else for(const r in t.components)e[r]=typeof n=="boolean"?n:n[r];return e}function Hf(t){for(;t;){if(t.record.aliasOf)return!0;t=t.parent}return!1}function Sb(t){return t.reduce((e,n)=>ye(e,n.meta),{})}function Wf(t,e){const n={};for(const r in t)n[r]=r in e?e[r]:t[r];return n}function Qg(t,e){return e.children.some(n=>n===t||Qg(t,n))}const Yg=/#/g,Cb=/&/g,xb=/\//g,Db=/=/g,kb=/\?/g,Jg=/\+/g,Vb=/%5B/g,Nb=/%5D/g,Xg=/%5E/g,Ob=/%60/g,Zg=/%7B/g,Mb=/%7C/g,e_=/%7D/g,Fb=/%20/g;function Th(t){return encodeURI(""+t).replace(Mb,"|").replace(Vb,"[").replace(Nb,"]")}function Lb(t){return Th(t).replace(Zg,"{").replace(e_,"}").replace(Xg,"^")}function pu(t){return Th(t).replace(Jg,"%2B").replace(Fb,"+").replace(Yg,"%23").replace(Cb,"%26").replace(Ob,"`").replace(Zg,"{").replace(e_,"}").replace(Xg,"^")}function Bb(t){return pu(t).replace(Db,"%3D")}function Ub(t){return Th(t).replace(Yg,"%23").replace(kb,"%3F")}function $b(t){return t==null?"":Ub(t).replace(xb,"%2F")}function Wa(t){try{return decodeURIComponent(""+t)}catch{}return""+t}function qb(t){const e={};if(t===""||t==="?")return e;const r=(t[0]==="?"?t.slice(1):t).split("&");for(let s=0;s<r.length;++s){const i=r[s].replace(Jg," "),o=i.indexOf("="),a=Wa(o<0?i:i.slice(0,o)),c=o<0?null:Wa(i.slice(o+1));if(a in e){let l=e[a];rn(l)||(l=e[a]=[l]),l.push(c)}else e[a]=c}return e}function Qf(t){let e="";for(let n in t){const r=t[n];if(n=Bb(n),r==null){r!==void 0&&(e+=(e.length?"&":"")+n);continue}(rn(r)?r.map(i=>i&&pu(i)):[r&&pu(r)]).forEach(i=>{i!==void 0&&(e+=(e.length?"&":"")+n,i!=null&&(e+="="+i))})}return e}function jb(t){const e={};for(const n in t){const r=t[n];r!==void 0&&(e[n]=rn(r)?r.map(s=>s==null?null:""+s):r==null?r:""+r)}return e}const zb=Symbol(""),Yf=Symbol(""),bh=Symbol(""),t_=Symbol(""),gu=Symbol("");function Di(){let t=[];function e(r){return t.push(r),()=>{const s=t.indexOf(r);s>-1&&t.splice(s,1)}}function n(){t=[]}return{add:e,list:()=>t,reset:n}}function Jn(t,e,n,r,s){const i=r&&(r.enterCallbacks[s]=r.enterCallbacks[s]||[]);return()=>new Promise((o,a)=>{const c=h=>{h===!1?a(Ys(4,{from:n,to:e})):h instanceof Error?a(h):pb(h)?a(Ys(2,{from:e,to:h})):(i&&r.enterCallbacks[s]===i&&typeof h=="function"&&i.push(h),o())},l=t.call(r&&r.instances[s],e,n,c);let u=Promise.resolve(l);t.length<3&&(u=u.then(c)),u.catch(h=>a(h))})}function Vl(t,e,n,r){const s=[];for(const i of t)for(const o in i.components){let a=i.components[o];if(!(e!=="beforeRouteEnter"&&!i.instances[o]))if(Kb(a)){const l=(a.__vccOpts||a)[e];l&&s.push(Jn(l,n,r,i,o))}else{let c=a();s.push(()=>c.then(l=>{if(!l)return Promise.reject(new Error(`Couldn't resolve component "${o}" at "${i.path}"`));const u=JT(l)?l.default:l;i.components[o]=u;const d=(u.__vccOpts||u)[e];return d&&Jn(d,n,r,i,o)()}))}}return s}function Kb(t){return typeof t=="object"||"displayName"in t||"props"in t||"__vccOpts"in t}function Jf(t){const e=kn(bh),n=kn(t_),r=$t(()=>e.resolve(Fs(t.to))),s=$t(()=>{const{matched:c}=r.value,{length:l}=c,u=c[l-1],h=n.matched;if(!u||!h.length)return-1;const d=h.findIndex(Qs.bind(null,u));if(d>-1)return d;const f=Xf(c[l-2]);return l>1&&Xf(u)===f&&h[h.length-1].path!==f?h.findIndex(Qs.bind(null,c[l-2])):d}),i=$t(()=>s.value>-1&&Qb(n.params,r.value.params)),o=$t(()=>s.value>-1&&s.value===n.matched.length-1&&Kg(n.params,r.value.params));function a(c={}){return Wb(c)?e[Fs(t.replace)?"replace":"push"](Fs(t.to)).catch(Wi):Promise.resolve()}return{route:r,href:$t(()=>r.value.href),isActive:i,isExactActive:o,navigate:a}}const Gb=wh({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:Jf,setup(t,{slots:e}){const n=gi(Jf(t)),{options:r}=kn(bh),s=$t(()=>({[Zf(t.activeClass,r.linkActiveClass,"router-link-active")]:n.isActive,[Zf(t.exactActiveClass,r.linkExactActiveClass,"router-link-exact-active")]:n.isExactActive}));return()=>{const i=e.default&&e.default(n);return t.custom?i:jg("a",{"aria-current":n.isExactActive?t.ariaCurrentValue:null,href:n.href,onClick:n.navigate,class:s.value},i)}}}),Hb=Gb;function Wb(t){if(!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)&&!t.defaultPrevented&&!(t.button!==void 0&&t.button!==0)){if(t.currentTarget&&t.currentTarget.getAttribute){const e=t.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return t.preventDefault&&t.preventDefault(),!0}}function Qb(t,e){for(const n in e){const r=e[n],s=t[n];if(typeof r=="string"){if(r!==s)return!1}else if(!rn(s)||s.length!==r.length||r.some((i,o)=>i!==s[o]))return!1}return!0}function Xf(t){return t?t.aliasOf?t.aliasOf.path:t.path:""}const Zf=(t,e,n)=>t??e??n,Yb=wh({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(t,{attrs:e,slots:n}){const r=kn(gu),s=$t(()=>t.route||r.value),i=kn(Yf,0),o=$t(()=>{let l=Fs(i);const{matched:u}=s.value;let h;for(;(h=u[l])&&!h.components;)l++;return l}),a=$t(()=>s.value.matched[o.value]);xa(Yf,$t(()=>o.value+1)),xa(zb,a),xa(gu,s);const c=cv();return Da(()=>[c.value,a.value,t.name],([l,u,h],[d,f,y])=>{u&&(u.instances[h]=l,f&&f!==u&&l&&l===d&&(u.leaveGuards.size||(u.leaveGuards=f.leaveGuards),u.updateGuards.size||(u.updateGuards=f.updateGuards))),l&&u&&(!f||!Qs(u,f)||!d)&&(u.enterCallbacks[h]||[]).forEach(w=>w(l))},{flush:"post"}),()=>{const l=s.value,u=t.name,h=a.value,d=h&&h.components[u];if(!d)return em(n.default,{Component:d,route:l});const f=h.props[u],y=f?f===!0?l.params:typeof f=="function"?f(l):f:null,I=jg(d,ye({},y,e,{onVnodeUnmounted:b=>{b.component.isUnmounted&&(h.instances[u]=null)},ref:c}));return em(n.default,{Component:I,route:l})||I}}});function em(t,e){if(!t)return null;const n=t(e);return n.length===1?n[0]:n}const Jb=Yb;function Xb(t){const e=Ab(t.routes,t),n=t.parseQuery||qb,r=t.stringifyQuery||Qf,s=t.history,i=Di(),o=Di(),a=Di(),c=lv(Gn);let l=Gn;Ps&&t.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const u=Dl.bind(null,A=>""+A),h=Dl.bind(null,$b),d=Dl.bind(null,Wa);function f(A,q){let L,G;return Hg(A)?(L=e.getRecordMatcher(A),G=q):G=A,e.addRoute(G,L)}function y(A){const q=e.getRecordMatcher(A);q&&e.removeRoute(q)}function w(){return e.getRoutes().map(A=>A.record)}function I(A){return!!e.getRecordMatcher(A)}function b(A,q){if(q=ye({},q||c.value),typeof A=="string"){const p=kl(n,A,q.path),g=e.resolve({path:p.path},q),v=s.createHref(p.fullPath);return ye(p,g,{params:d(g.params),hash:Wa(p.hash),redirectedFrom:void 0,href:v})}let L;if("path"in A)L=ye({},A,{path:kl(n,A.path,q.path).path});else{const p=ye({},A.params);for(const g in p)p[g]==null&&delete p[g];L=ye({},A,{params:h(A.params)}),q.params=h(q.params)}const G=e.resolve(L,q),de=A.hash||"";G.params=u(d(G.params));const Me=eb(r,ye({},A,{hash:Lb(de),path:G.path})),ie=s.createHref(Me);return ye({fullPath:Me,hash:de,query:r===Qf?jb(A.query):A.query||{}},G,{redirectedFrom:void 0,href:ie})}function D(A){return typeof A=="string"?kl(n,A,c.value.path):ye({},A)}function R(A,q){if(l!==A)return Ys(8,{from:q,to:A})}function B(A){return ge(A)}function Y(A){return B(ye(D(A),{replace:!0}))}function Z(A){const q=A.matched[A.matched.length-1];if(q&&q.redirect){const{redirect:L}=q;let G=typeof L=="function"?L(A):L;return typeof G=="string"&&(G=G.includes("?")||G.includes("#")?G=D(G):{path:G},G.params={}),ye({query:A.query,hash:A.hash,params:"path"in G?{}:A.params},G)}}function ge(A,q){const L=l=b(A),G=c.value,de=A.state,Me=A.force,ie=A.replace===!0,p=Z(L);if(p)return ge(ye(D(p),{state:typeof p=="object"?ye({},de,p.state):de,force:Me,replace:ie}),q||L);const g=L;g.redirectedFrom=q;let v;return!Me&&tb(r,G,L)&&(v=Ys(16,{to:g,from:G}),Sr(G,G,!0,!1)),(v?Promise.resolve(v):Ut(g,G)).catch(T=>Rn(T)?Rn(T,2)?T:Ht(T):Ae(T,g,G)).then(T=>{if(T){if(Rn(T,2))return ge(ye({replace:ie},D(T.to),{state:typeof T.to=="object"?ye({},de,T.to.state):de,force:Me}),q||g)}else T=zn(g,G,!0,ie,de);return Mt(g,G,T),T})}function Be(A,q){const L=R(A,q);return L?Promise.reject(L):Promise.resolve()}function Ut(A,q){let L;const[G,de,Me]=Zb(A,q);L=Vl(G.reverse(),"beforeRouteLeave",A,q);for(const p of G)p.leaveGuards.forEach(g=>{L.push(Jn(g,A,q))});const ie=Be.bind(null,A,q);return L.push(ie),Es(L).then(()=>{L=[];for(const p of i.list())L.push(Jn(p,A,q));return L.push(ie),Es(L)}).then(()=>{L=Vl(de,"beforeRouteUpdate",A,q);for(const p of de)p.updateGuards.forEach(g=>{L.push(Jn(g,A,q))});return L.push(ie),Es(L)}).then(()=>{L=[];for(const p of A.matched)if(p.beforeEnter&&!q.matched.includes(p))if(rn(p.beforeEnter))for(const g of p.beforeEnter)L.push(Jn(g,A,q));else L.push(Jn(p.beforeEnter,A,q));return L.push(ie),Es(L)}).then(()=>(A.matched.forEach(p=>p.enterCallbacks={}),L=Vl(Me,"beforeRouteEnter",A,q),L.push(ie),Es(L))).then(()=>{L=[];for(const p of o.list())L.push(Jn(p,A,q));return L.push(ie),Es(L)}).catch(p=>Rn(p,8)?p:Promise.reject(p))}function Mt(A,q,L){for(const G of a.list())G(A,q,L)}function zn(A,q,L,G,de){const Me=R(A,q);if(Me)return Me;const ie=q===Gn,p=Ps?history.state:{};L&&(G||ie?s.replace(A.fullPath,ye({scroll:ie&&p&&p.scroll},de)):s.push(A.fullPath,de)),c.value=A,Sr(A,q,L,ie),Ht()}let cn;function _s(){cn||(cn=s.listen((A,q,L)=>{if(!ca.listening)return;const G=b(A),de=Z(G);if(de){ge(ye(de,{replace:!0}),G).catch(Wi);return}l=G;const Me=c.value;Ps&&lb($f(Me.fullPath,L.delta),Nc()),Ut(G,Me).catch(ie=>Rn(ie,12)?ie:Rn(ie,2)?(ge(ie.to,G).then(p=>{Rn(p,20)&&!L.delta&&L.type===ho.pop&&s.go(-1,!1)}).catch(Wi),Promise.reject()):(L.delta&&s.go(-L.delta,!1),Ae(ie,G,Me))).then(ie=>{ie=ie||zn(G,Me,!1),ie&&(L.delta&&!Rn(ie,8)?s.go(-L.delta,!1):L.type===ho.pop&&Rn(ie,20)&&s.go(-1,!1)),Mt(G,Me,ie)}).catch(Wi)}))}let Pr=Di(),Si=Di(),Ke;function Ae(A,q,L){Ht(A);const G=Si.list();return G.length?G.forEach(de=>de(A,q,L)):console.error(A),Promise.reject(A)}function Ie(){return Ke&&c.value!==Gn?Promise.resolve():new Promise((A,q)=>{Pr.add([A,q])})}function Ht(A){return Ke||(Ke=!A,_s(),Pr.list().forEach(([q,L])=>A?L(A):q()),Pr.reset()),A}function Sr(A,q,L,G){const{scrollBehavior:de}=t;if(!Ps||!de)return Promise.resolve();const Me=!L&&ub($f(A.fullPath,0))||(G||!L)&&history.state&&history.state.scroll||null;return Eg().then(()=>de(A,q,Me)).then(ie=>ie&&cb(ie)).catch(ie=>Ae(ie,A,q))}const Wt=A=>s.go(A);let St;const ys=new Set,ca={currentRoute:c,listening:!0,addRoute:f,removeRoute:y,hasRoute:I,getRoutes:w,resolve:b,options:t,push:B,replace:Y,go:Wt,back:()=>Wt(-1),forward:()=>Wt(1),beforeEach:i.add,beforeResolve:o.add,afterEach:a.add,onError:Si.add,isReady:Ie,install(A){const q=this;A.component("RouterLink",Hb),A.component("RouterView",Jb),A.config.globalProperties.$router=q,Object.defineProperty(A.config.globalProperties,"$route",{enumerable:!0,get:()=>Fs(c)}),Ps&&!St&&c.value===Gn&&(St=!0,B(s.location).catch(de=>{}));const L={};for(const de in Gn)L[de]=$t(()=>c.value[de]);A.provide(bh,q),A.provide(t_,gi(L)),A.provide(gu,c);const G=A.unmount;ys.add(A),A.unmount=function(){ys.delete(A),ys.size<1&&(l=Gn,cn&&cn(),cn=null,c.value=Gn,St=!1,Ke=!1),G()}}};return ca}function Es(t){return t.reduce((e,n)=>e.then(()=>n()),Promise.resolve())}function Zb(t,e){const n=[],r=[],s=[],i=Math.max(e.matched.length,t.matched.length);for(let o=0;o<i;o++){const a=e.matched[o];a&&(t.matched.find(l=>Qs(l,a))?r.push(a):n.push(a));const c=t.matched[o];c&&(e.matched.find(l=>Qs(l,c))||s.push(c))}return[n,r,s]}const eA="/hero.jpg",tA="/post2.png",nA="/post1.png",rA="/post3.png";const sA={data(){return{}}},iA={class:"hero-image"},oA={class:"image-container"},aA=m("img",{src:eA,alt:"Hero Image"},null,-1),cA={class:"centered-hero-title"},lA=m("h1",null,"Foodiex - Smart Meals Delivery",-1),uA=m("p",{class:"hero-subtitle"},"Fresh ingredients delivered to your door",-1),hA=m("div",{style:{padding:"1rem"},class:"container"},[m("br"),m("div",{class:"row"},[m("div",{class:"col-12"},[m("button",{class:"open-chat-button",onclick:"window.open('https://t.me/polskoydm')"},[m("i",{class:"fas fa-comments"})])])]),m("h2",{style:{"text-align":"center",margin:"2rem",color:"black"}},"How it works"),m("br"),m("div",{class:"row featurette"},[m("div",{class:"col-md-7"},[m("h2",{class:"featurette-heading fw-normal lh-1"},[Dt("QUICK ONLINE SUPERMARKET"),m("span",{class:"text-muted"}," Groceries delivered every week ")]),m("p",{class:"lead"},"cheeses, fruit, vegetables, snacks, nuts, and other products")]),m("div",{class:"col-md-5"},[m("img",{style:{height:"25rem","object-position":"center","object-fit":"cover","background-repeat":"no-repeat"},class:"d-block w-100",src:tA,alt:"First Photo"})])]),m("br"),m("hr",{class:"featurette-divider"}),m("br"),m("div",{class:"row featurette"},[m("div",{class:"col-md-7 order-md-2"},[m("h2",{class:"featurette-heading fw-normal lh-1"},[Dt("Get Free Products "),m("span",{class:"text-muted"},"Enjoy a free Foodiex box.")]),m("p",{class:"lead"}," and share experience with your family or friends.")]),m("div",{class:"col-md-5 order-md-1"},[m("img",{style:{height:"25rem","object-position":"center","object-fit":"cover","background-repeat":"no-repeat"},class:"d-block w-100",src:nA,alt:"Second Photo"})])]),m("br"),m("hr",{class:"featurette-divider"}),m("br"),m("div",{class:"row featurette"},[m("div",{class:"col-md-7"},[m("h2",{class:"featurette-heading fw-normal lh-1"},[Dt("Ambassador Program"),m("span",{class:"text-muted"},"is designed for passionate creators ")]),m("p",{class:"text-muted"}," Looking to share Foodiex with their audience. As an ambassador, you'll receive a personalized code to share, and you'll earn a reward for every box ordered! ")]),m("div",{class:"col-md-5"},[m("img",{style:{height:"25rem","object-position":"center","object-fit":"cover","background-repeat":"no-repeat"},class:"d-block w-100",src:rA,alt:"Third photo"})])]),m("br"),m("hr",{class:"featurette-divider"}),m("br")],-1);function dA(t,e,n,r,s,i){const o=Fo("router-link");return te(),ne("div",null,[m("div",iA,[m("div",oA,[aA,m("div",cA,[lA,uA,Qe(o,{to:"/shop",class:"btn btn-primary btn-lg mt-3"},{default:Ks(()=>[Dt("Start Shopping")]),_:1})])])]),hA])}const fA=an(sA,[["render",dA]]);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n_=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},mA=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],a=t[n++],c=((s&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},r_={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,a=o?t[s+1]:0,c=s+2<t.length,l=c?t[s+2]:0,u=i>>2,h=(i&3)<<4|a>>4;let d=(a&15)<<2|l>>6,f=l&63;c||(f=64,o||(d=64)),r.push(n[u],n[h],n[d],n[f])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(n_(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):mA(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],a=s<t.length?n[t.charAt(s)]:0;++s;const l=s<t.length?n[t.charAt(s)]:64;++s;const h=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||a==null||l==null||h==null)throw new pA;const d=i<<2|a>>4;if(r.push(d),l!==64){const f=a<<4&240|l>>2;if(r.push(f),h!==64){const y=l<<6&192|h;r.push(y)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class pA extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const gA=function(t){const e=n_(t);return r_.encodeByteArray(e,!0)},Qa=function(t){return gA(t).replace(/\./g,"")},_A=function(t){try{return r_.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function Ya(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const n=e;return new Date(n.getTime());case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(const n in e)!e.hasOwnProperty(n)||!yA(n)||(t[n]=Ya(t[n],e[n]));return t}function yA(t){return t!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wA(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EA=()=>wA().__FIREBASE_DEFAULTS__,IA=()=>{if(typeof process>"u"||typeof process.env>"u")return;const t={}.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},vA=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&_A(t[1]);return e&&JSON.parse(e)},s_=()=>{try{return EA()||IA()||vA()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},i_=()=>{var t;return(t=s_())===null||t===void 0?void 0:t.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TA{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o_(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t),a="";return[Qa(JSON.stringify(n)),Qa(JSON.stringify(o)),a].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ja(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function bA(){var t;const e=(t=s_())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function a_(){return typeof self=="object"&&self.self===self}function c_(){return!bA()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function l_(){try{return typeof indexedDB=="object"}catch{return!1}}function AA(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RA="FirebaseError";class yr extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=RA,Object.setPrototypeOf(this,yr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Oc.prototype.create)}}class Oc{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?PA(i,r):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new yr(s,a,r)}}function PA(t,e){return t.replace(SA,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const SA=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tm(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function fo(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(nm(i)&&nm(o)){if(!fo(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function nm(t){return t!==null&&typeof t=="object"}function CA(t,e){const n=new xA(t,e);return n.subscribe.bind(n)}class xA{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");DA(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=Nl),s.error===void 0&&(s.error=Nl),s.complete===void 0&&(s.complete=Nl);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function DA(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Nl(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function be(t){return t&&t._delegate?t._delegate:t}class On{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vr="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kA{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new TA;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(NA(e))try{this.getOrInitializeService({instanceIdentifier:Vr})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=Vr){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Vr){return this.instances.has(e)}getOptions(e=Vr){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);r===a&&o.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:VA(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Vr){return this.component?this.component.multipleInstances?e:Vr:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function VA(t){return t===Vr?void 0:t}function NA(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u_{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new kA(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ah=[];var le;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(le||(le={}));const h_={debug:le.DEBUG,verbose:le.VERBOSE,info:le.INFO,warn:le.WARN,error:le.ERROR,silent:le.SILENT},OA=le.INFO,MA={[le.DEBUG]:"log",[le.VERBOSE]:"log",[le.INFO]:"info",[le.WARN]:"warn",[le.ERROR]:"error"},FA=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=MA[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Rh{constructor(e){this.name=e,this._logLevel=OA,this._logHandler=FA,this._userLogHandler=null,Ah.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in le))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?h_[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,le.DEBUG,...e),this._logHandler(this,le.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,le.VERBOSE,...e),this._logHandler(this,le.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,le.INFO,...e),this._logHandler(this,le.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,le.WARN,...e),this._logHandler(this,le.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,le.ERROR,...e),this._logHandler(this,le.ERROR,...e)}}function LA(t){Ah.forEach(e=>{e.setLogLevel(t)})}function BA(t,e){for(const n of Ah){let r=null;e&&e.level&&(r=h_[e.level]),t===null?n.userLogHandler=null:n.userLogHandler=(s,i,...o)=>{const a=o.map(c=>{if(c==null)return null;if(typeof c=="string")return c;if(typeof c=="number"||typeof c=="boolean")return c.toString();if(c instanceof Error)return c.message;try{return JSON.stringify(c)}catch{return null}}).filter(c=>c).join(" ");i>=(r??s.logLevel)&&t({level:le[i].toLowerCase(),message:a,args:o,type:s.name})}}}const UA=(t,e)=>e.some(n=>t instanceof n);let rm,sm;function $A(){return rm||(rm=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function qA(){return sm||(sm=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const d_=new WeakMap,_u=new WeakMap,f_=new WeakMap,Ol=new WeakMap,Ph=new WeakMap;function jA(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(rr(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&d_.set(n,t)}).catch(()=>{}),Ph.set(e,t),e}function zA(t){if(_u.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});_u.set(t,e)}let yu={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return _u.get(t);if(e==="objectStoreNames")return t.objectStoreNames||f_.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return rr(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function KA(t){yu=t(yu)}function GA(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Ml(this),e,...n);return f_.set(r,e.sort?e.sort():[e]),rr(r)}:qA().includes(t)?function(...e){return t.apply(Ml(this),e),rr(d_.get(this))}:function(...e){return rr(t.apply(Ml(this),e))}}function HA(t){return typeof t=="function"?GA(t):(t instanceof IDBTransaction&&zA(t),UA(t,$A())?new Proxy(t,yu):t)}function rr(t){if(t instanceof IDBRequest)return jA(t);if(Ol.has(t))return Ol.get(t);const e=HA(t);return e!==t&&(Ol.set(t,e),Ph.set(e,t)),e}const Ml=t=>Ph.get(t);function WA(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),a=rr(o);return r&&o.addEventListener("upgradeneeded",c=>{r(rr(o.result),c.oldVersion,c.newVersion,rr(o.transaction),c)}),n&&o.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),a.then(c=>{i&&c.addEventListener("close",()=>i()),s&&c.addEventListener("versionchange",l=>s(l.oldVersion,l.newVersion,l))}).catch(()=>{}),a}const QA=["get","getKey","getAll","getAllKeys","count"],YA=["put","add","delete","clear"],Fl=new Map;function im(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Fl.get(e))return Fl.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=YA.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||QA.includes(n)))return;const i=async function(o,...a){const c=this.transaction(o,s?"readwrite":"readonly");let l=c.store;return r&&(l=l.index(a.shift())),(await Promise.all([l[n](...a),s&&c.done]))[0]};return Fl.set(e,i),i}KA(t=>({...t,get:(e,n,r)=>im(e,n)||t.get(e,n,r),has:(e,n)=>!!im(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JA{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(XA(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function XA(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Xa="@firebase/app",wu="0.10.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zr=new Rh("@firebase/app"),ZA="@firebase/app-compat",e0="@firebase/analytics-compat",t0="@firebase/analytics",n0="@firebase/app-check-compat",r0="@firebase/app-check",s0="@firebase/auth",i0="@firebase/auth-compat",o0="@firebase/database",a0="@firebase/database-compat",c0="@firebase/functions",l0="@firebase/functions-compat",u0="@firebase/installations",h0="@firebase/installations-compat",d0="@firebase/messaging",f0="@firebase/messaging-compat",m0="@firebase/performance",p0="@firebase/performance-compat",g0="@firebase/remote-config",_0="@firebase/remote-config-compat",y0="@firebase/storage",w0="@firebase/storage-compat",E0="@firebase/firestore",I0="@firebase/firestore-compat",v0="firebase",T0="10.11.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const or="[DEFAULT]",b0={[Xa]:"fire-core",[ZA]:"fire-core-compat",[t0]:"fire-analytics",[e0]:"fire-analytics-compat",[r0]:"fire-app-check",[n0]:"fire-app-check-compat",[s0]:"fire-auth",[i0]:"fire-auth-compat",[o0]:"fire-rtdb",[a0]:"fire-rtdb-compat",[c0]:"fire-fn",[l0]:"fire-fn-compat",[u0]:"fire-iid",[h0]:"fire-iid-compat",[d0]:"fire-fcm",[f0]:"fire-fcm-compat",[m0]:"fire-perf",[p0]:"fire-perf-compat",[g0]:"fire-rc",[_0]:"fire-rc-compat",[y0]:"fire-gcs",[w0]:"fire-gcs-compat",[E0]:"fire-fst",[I0]:"fire-fst-compat","fire-js":"fire-js",[v0]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ar=new Map,Js=new Map,Xs=new Map;function mo(t,e){try{t.container.addComponent(e)}catch(n){Zr.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function m_(t,e){t.container.addOrOverwriteComponent(e)}function es(t){const e=t.name;if(Xs.has(e))return Zr.debug(`There were multiple attempts to register component ${e}.`),!1;Xs.set(e,t);for(const n of ar.values())mo(n,t);for(const n of Js.values())mo(n,t);return!0}function p_(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function A0(t,e,n=or){p_(t,e).clearInstance(n)}function g_(t){return t.options!==void 0}function R0(t){return t.settings!==void 0}function P0(){Xs.clear()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S0={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Gt=new Oc("app","Firebase",S0);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let __=class{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new On("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Gt.create("app-deleted",{appName:this._name})}};/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C0 extends __{constructor(e,n,r,s){const i=n.automaticDataCollectionEnabled!==void 0?n.automaticDataCollectionEnabled:!1,o={name:r,automaticDataCollectionEnabled:i};if(e.apiKey!==void 0)super(e,o,s);else{const a=e;super(a.options,o,s)}this._serverConfig=Object.assign({automaticDataCollectionEnabled:i},n),this._finalizationRegistry=new FinalizationRegistry(()=>{this.automaticCleanup()}),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,n.releaseOnDeref=void 0,nn(Xa,wu,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(e){this.isDeleted||(this._refCount++,e!==void 0&&this._finalizationRegistry.register(e,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){Ch(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw Gt.create("server-app-deleted")}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mc=T0;function Sh(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:or,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw Gt.create("bad-app-name",{appName:String(s)});if(n||(n=i_()),!n)throw Gt.create("no-options");const i=ar.get(s);if(i){if(fo(n,i.options)&&fo(r,i.config))return i;throw Gt.create("duplicate-app",{appName:s})}const o=new u_(s);for(const c of Xs.values())o.addComponent(c);const a=new __(n,r,o);return ar.set(s,a),a}function x0(t,e){if(a_())throw Gt.create("invalid-server-app-environment");e.automaticDataCollectionEnabled===void 0&&(e.automaticDataCollectionEnabled=!1);let n;g_(t)?n=t.options:n=t;const r=Object.assign(Object.assign({},e),n);r.releaseOnDeref!==void 0&&delete r.releaseOnDeref;const s=l=>[...l].reduce((u,h)=>Math.imul(31,u)+h.charCodeAt(0)|0,0);if(e.releaseOnDeref!==void 0&&typeof FinalizationRegistry>"u")throw Gt.create("finalization-registry-not-supported",{});const i=""+s(JSON.stringify(r)),o=Js.get(i);if(o)return o.incRefCount(e.releaseOnDeref),o;const a=new u_(i);for(const l of Xs.values())a.addComponent(l);const c=new C0(n,e,i,a);return Js.set(i,c),c}function D0(t=or){const e=ar.get(t);if(!e&&t===or&&i_())return Sh();if(!e)throw Gt.create("no-app",{appName:t});return e}function k0(){return Array.from(ar.values())}async function Ch(t){let e=!1;const n=t.name;ar.has(n)?(e=!0,ar.delete(n)):Js.has(n)&&t.decRefCount()<=0&&(Js.delete(n),e=!0),e&&(await Promise.all(t.container.getProviders().map(r=>r.delete())),t.isDeleted=!0)}function nn(t,e,n){var r;let s=(r=b0[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const a=[`Unable to register library "${s}" with version "${e}":`];i&&a.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Zr.warn(a.join(" "));return}es(new On(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}function y_(t,e){if(t!==null&&typeof t!="function")throw Gt.create("invalid-log-argument");BA(t,e)}function w_(t){LA(t)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V0="firebase-heartbeat-database",N0=1,po="firebase-heartbeat-store";let Ll=null;function E_(){return Ll||(Ll=WA(V0,N0,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(po)}catch(n){console.warn(n)}}}}).catch(t=>{throw Gt.create("idb-open",{originalErrorMessage:t.message})})),Ll}async function O0(t){try{const n=(await E_()).transaction(po),r=await n.objectStore(po).get(I_(t));return await n.done,r}catch(e){if(e instanceof yr)Zr.warn(e.message);else{const n=Gt.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Zr.warn(n.message)}}}async function om(t,e){try{const r=(await E_()).transaction(po,"readwrite");await r.objectStore(po).put(e,I_(t)),await r.done}catch(n){if(n instanceof yr)Zr.warn(n.message);else{const r=Gt.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Zr.warn(r.message)}}}function I_(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M0=1024,F0=30*24*60*60*1e3;class L0{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new U0(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=am();if(!(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null))&&!(this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i)))return this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const a=new Date(o.date).valueOf();return Date.now()-a<=F0}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){var e;if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=am(),{heartbeatsToSend:r,unsentEntries:s}=B0(this._heartbeatsCache.heartbeats),i=Qa(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}}function am(){return new Date().toISOString().substring(0,10)}function B0(t,e=M0){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),cm(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),cm(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class U0{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return l_()?AA().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await O0(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return om(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return om(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function cm(t){return Qa(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $0(t){es(new On("platform-logger",e=>new JA(e),"PRIVATE")),es(new On("heartbeat",e=>new L0(e),"PRIVATE")),nn(Xa,wu,t),nn(Xa,wu,"esm2017"),nn("fire-js","")}$0("");const q0=Object.freeze(Object.defineProperty({__proto__:null,FirebaseError:yr,SDK_VERSION:Mc,_DEFAULT_ENTRY_NAME:or,_addComponent:mo,_addOrOverwriteComponent:m_,_apps:ar,_clearComponents:P0,_components:Xs,_getProvider:p_,_isFirebaseApp:g_,_isFirebaseServerApp:R0,_registerComponent:es,_removeServiceInstance:A0,_serverApps:Js,deleteApp:Ch,getApp:D0,getApps:k0,initializeApp:Sh,initializeServerApp:x0,onLog:y_,registerVersion:nn,setLogLevel:w_},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j0{constructor(e,n){this._delegate=e,this.firebase=n,mo(e,new On("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),Ch(this._delegate)))}_getService(e,n=or){var r;this._delegate.checkDestroyed();const s=this._delegate.container.getProvider(e);return!s.isInitialized()&&((r=s.getComponent())===null||r===void 0?void 0:r.instantiationMode)==="EXPLICIT"&&s.initialize(),s.getImmediate({identifier:n})}_removeServiceInstance(e,n=or){this._delegate.container.getProvider(e).clearInstance(n)}_addComponent(e){mo(this._delegate,e)}_addOrOverwriteComponent(e){m_(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z0={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."},lm=new Oc("app-compat","Firebase",z0);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K0(t){const e={},n={__esModule:!0,initializeApp:i,app:s,registerVersion:nn,setLogLevel:w_,onLog:y_,apps:null,SDK_VERSION:Mc,INTERNAL:{registerComponent:a,removeApp:r,useAsService:c,modularAPIs:q0}};n.default=n,Object.defineProperty(n,"apps",{get:o});function r(l){delete e[l]}function s(l){if(l=l||or,!tm(e,l))throw lm.create("no-app",{appName:l});return e[l]}s.App=t;function i(l,u={}){const h=Sh(l,u);if(tm(e,h.name))return e[h.name];const d=new t(h,n);return e[h.name]=d,d}function o(){return Object.keys(e).map(l=>e[l])}function a(l){const u=l.name,h=u.replace("-compat","");if(es(l)&&l.type==="PUBLIC"){const d=(f=s())=>{if(typeof f[h]!="function")throw lm.create("invalid-app-argument",{appName:u});return f[h]()};l.serviceProps!==void 0&&Ya(d,l.serviceProps),n[h]=d,t.prototype[h]=function(...f){return this._getService.bind(this,u).apply(this,l.multipleInstances?f:[])}}return l.type==="PUBLIC"?n[h]:null}function c(l,u){return u==="serverAuth"?null:u}return n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v_(){const t=K0(j0);t.INTERNAL=Object.assign(Object.assign({},t.INTERNAL),{createFirebaseNamespace:v_,extendNamespace:e,createSubscribe:CA,ErrorFactory:Oc,deepExtend:Ya});function e(n){Ya(t,n)}return t}const G0=v_();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const um=new Rh("@firebase/app-compat"),H0="@firebase/app-compat",W0="0.2.32";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q0(t){nn(H0,W0,t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */if(a_()&&self.firebase!==void 0){um.warn(`
    Warning: Firebase is already defined in the global scope. Please make sure
    Firebase library is only loaded once.
  `);const t=self.firebase.SDK_VERSION;t&&t.indexOf("LITE")>=0&&um.warn(`
    Warning: You are trying to load Firebase while using Firebase Performance standalone script.
    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
    `)}const me=G0;Q0();var Y0="firebase",J0="10.11.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */me.registerVersion(Y0,J0,"app-compat");var X0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},F,xh=xh||{},J=X0||self;function Fc(t){var e=typeof t;return e=e!="object"?e:t?Array.isArray(t)?"array":e:"null",e=="array"||e=="object"&&typeof t.length=="number"}function Lo(t){var e=typeof t;return e=="object"&&t!=null||e=="function"}function Z0(t){return Object.prototype.hasOwnProperty.call(t,Bl)&&t[Bl]||(t[Bl]=++eR)}var Bl="closure_uid_"+(1e9*Math.random()>>>0),eR=0;function tR(t,e,n){return t.call.apply(t.bind,arguments)}function nR(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var s=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(s,r),t.apply(e,s)}}return function(){return t.apply(e,arguments)}}function ft(t,e,n){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?ft=tR:ft=nR,ft.apply(null,arguments)}function pa(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var r=n.slice();return r.push.apply(r,arguments),t.apply(this,r)}}function nt(t,e){function n(){}n.prototype=e.prototype,t.$=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.ac=function(r,s,i){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[s].apply(r,o)}}function wr(){this.s=this.s,this.o=this.o}var rR=0;wr.prototype.s=!1;wr.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),rR!=0)&&Z0(this)};wr.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const T_=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(typeof t=="string")return typeof e!="string"||e.length!=1?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function Dh(t){const e=t.length;if(0<e){const n=Array(e);for(let r=0;r<e;r++)n[r]=t[r];return n}return[]}function hm(t,e){for(let n=1;n<arguments.length;n++){const r=arguments[n];if(Fc(r)){const s=t.length||0,i=r.length||0;t.length=s+i;for(let o=0;o<i;o++)t[s+o]=r[o]}else t.push(r)}}function mt(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}mt.prototype.h=function(){this.defaultPrevented=!0};var sR=function(){if(!J.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{const n=()=>{};J.addEventListener("test",n,e),J.removeEventListener("test",n,e)}catch{}return t}();function go(t){return/^[\s\xa0]*$/.test(t)}function Lc(){var t=J.navigator;return t&&(t=t.userAgent)?t:""}function fn(t){return Lc().indexOf(t)!=-1}function kh(t){return kh[" "](t),t}kh[" "]=function(){};function iR(t,e){var n=JR;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}var oR=fn("Opera"),Zs=fn("Trident")||fn("MSIE"),b_=fn("Edge"),Eu=b_||Zs,A_=fn("Gecko")&&!(Lc().toLowerCase().indexOf("webkit")!=-1&&!fn("Edge"))&&!(fn("Trident")||fn("MSIE"))&&!fn("Edge"),aR=Lc().toLowerCase().indexOf("webkit")!=-1&&!fn("Edge");function R_(){var t=J.document;return t?t.documentMode:void 0}var Iu;e:{var Ul="",$l=function(){var t=Lc();if(A_)return/rv:([^\);]+)(\)|;)/.exec(t);if(b_)return/Edge\/([\d\.]+)/.exec(t);if(Zs)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t);if(aR)return/WebKit\/(\S+)/.exec(t);if(oR)return/(?:Version)[ \/]?(\S+)/.exec(t)}();if($l&&(Ul=$l?$l[1]:""),Zs){var ql=R_();if(ql!=null&&ql>parseFloat(Ul)){Iu=String(ql);break e}}Iu=Ul}var vu;if(J.document&&Zs){var dm=R_();vu=dm||parseInt(Iu,10)||void 0}else vu=void 0;var cR=vu;function _o(t,e){if(mt.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(A_){e:{try{kh(e.nodeName);var s=!0;break e}catch{}s=!1}s||(e=null)}}else n=="mouseover"?e=t.fromElement:n=="mouseout"&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=t.clientX!==void 0?t.clientX:t.pageX,this.clientY=t.clientY!==void 0?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=typeof t.pointerType=="string"?t.pointerType:lR[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&_o.$.h.call(this)}}nt(_o,mt);var lR={2:"touch",3:"pen",4:"mouse"};_o.prototype.h=function(){_o.$.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var Bo="closure_listenable_"+(1e6*Math.random()|0),uR=0;function hR(t,e,n,r,s){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.la=s,this.key=++uR,this.fa=this.ia=!1}function Bc(t){t.fa=!0,t.listener=null,t.proxy=null,t.src=null,t.la=null}function Vh(t,e,n){for(const r in t)e.call(n,t[r],r,t)}function dR(t,e){for(const n in t)e.call(void 0,t[n],n,t)}function P_(t){const e={};for(const n in t)e[n]=t[n];return e}const fm="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function S_(t,e){let n,r;for(let s=1;s<arguments.length;s++){r=arguments[s];for(n in r)t[n]=r[n];for(let i=0;i<fm.length;i++)n=fm[i],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function Uc(t){this.src=t,this.g={},this.h=0}Uc.prototype.add=function(t,e,n,r,s){var i=t.toString();t=this.g[i],t||(t=this.g[i]=[],this.h++);var o=bu(t,e,r,s);return-1<o?(e=t[o],n||(e.ia=!1)):(e=new hR(e,this.src,i,!!r,s),e.ia=n,t.push(e)),e};function Tu(t,e){var n=e.type;if(n in t.g){var r=t.g[n],s=T_(r,e),i;(i=0<=s)&&Array.prototype.splice.call(r,s,1),i&&(Bc(e),t.g[n].length==0&&(delete t.g[n],t.h--))}}function bu(t,e,n,r){for(var s=0;s<t.length;++s){var i=t[s];if(!i.fa&&i.listener==e&&i.capture==!!n&&i.la==r)return s}return-1}var Nh="closure_lm_"+(1e6*Math.random()|0),jl={};function C_(t,e,n,r,s){if(r&&r.once)return D_(t,e,n,r,s);if(Array.isArray(e)){for(var i=0;i<e.length;i++)C_(t,e[i],n,r,s);return null}return n=Fh(n),t&&t[Bo]?t.O(e,n,Lo(r)?!!r.capture:!!r,s):x_(t,e,n,!1,r,s)}function x_(t,e,n,r,s,i){if(!e)throw Error("Invalid event type");var o=Lo(s)?!!s.capture:!!s,a=Mh(t);if(a||(t[Nh]=a=new Uc(t)),n=a.add(e,n,r,o,i),n.proxy)return n;if(r=fR(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)sR||(s=o),s===void 0&&(s=!1),t.addEventListener(e.toString(),r,s);else if(t.attachEvent)t.attachEvent(V_(e.toString()),r);else if(t.addListener&&t.removeListener)t.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return n}function fR(){function t(n){return e.call(t.src,t.listener,n)}const e=mR;return t}function D_(t,e,n,r,s){if(Array.isArray(e)){for(var i=0;i<e.length;i++)D_(t,e[i],n,r,s);return null}return n=Fh(n),t&&t[Bo]?t.P(e,n,Lo(r)?!!r.capture:!!r,s):x_(t,e,n,!0,r,s)}function k_(t,e,n,r,s){if(Array.isArray(e))for(var i=0;i<e.length;i++)k_(t,e[i],n,r,s);else r=Lo(r)?!!r.capture:!!r,n=Fh(n),t&&t[Bo]?(t=t.i,e=String(e).toString(),e in t.g&&(i=t.g[e],n=bu(i,n,r,s),-1<n&&(Bc(i[n]),Array.prototype.splice.call(i,n,1),i.length==0&&(delete t.g[e],t.h--)))):t&&(t=Mh(t))&&(e=t.g[e.toString()],t=-1,e&&(t=bu(e,n,r,s)),(n=-1<t?e[t]:null)&&Oh(n))}function Oh(t){if(typeof t!="number"&&t&&!t.fa){var e=t.src;if(e&&e[Bo])Tu(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(V_(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Mh(e))?(Tu(n,t),n.h==0&&(n.src=null,e[Nh]=null)):Bc(t)}}}function V_(t){return t in jl?jl[t]:jl[t]="on"+t}function mR(t,e){if(t.fa)t=!0;else{e=new _o(e,this);var n=t.listener,r=t.la||t.src;t.ia&&Oh(t),t=n.call(r,e)}return t}function Mh(t){return t=t[Nh],t instanceof Uc?t:null}var zl="__closure_events_fn_"+(1e9*Math.random()>>>0);function Fh(t){return typeof t=="function"?t:(t[zl]||(t[zl]=function(e){return t.handleEvent(e)}),t[zl])}function tt(){wr.call(this),this.i=new Uc(this),this.S=this,this.J=null}nt(tt,wr);tt.prototype[Bo]=!0;tt.prototype.removeEventListener=function(t,e,n,r){k_(this,t,e,n,r)};function ct(t,e){var n,r=t.J;if(r)for(n=[];r;r=r.J)n.push(r);if(t=t.S,r=e.type||e,typeof e=="string")e=new mt(e,t);else if(e instanceof mt)e.target=e.target||t;else{var s=e;e=new mt(r,t),S_(e,s)}if(s=!0,n)for(var i=n.length-1;0<=i;i--){var o=e.g=n[i];s=ga(o,r,!0,e)&&s}if(o=e.g=t,s=ga(o,r,!0,e)&&s,s=ga(o,r,!1,e)&&s,n)for(i=0;i<n.length;i++)o=e.g=n[i],s=ga(o,r,!1,e)&&s}tt.prototype.N=function(){if(tt.$.N.call(this),this.i){var t=this.i,e;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)Bc(n[r]);delete t.g[e],t.h--}}this.J=null};tt.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)};tt.prototype.P=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};function ga(t,e,n,r){if(e=t.i.g[String(e)],!e)return!0;e=e.concat();for(var s=!0,i=0;i<e.length;++i){var o=e[i];if(o&&!o.fa&&o.capture==n){var a=o.listener,c=o.la||o.src;o.ia&&Tu(t.i,o),s=a.call(c,r)!==!1&&s}}return s&&!r.defaultPrevented}var Lh=J.JSON.stringify;class pR{constructor(e,n){this.i=e,this.j=n,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}function gR(){var t=Bh;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}class _R{constructor(){this.h=this.g=null}add(e,n){const r=N_.get();r.set(e,n),this.h?this.h.next=r:this.g=r,this.h=r}}var N_=new pR(()=>new yR,t=>t.reset());class yR{constructor(){this.next=this.g=this.h=null}set(e,n){this.h=e,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}}function wR(t){var e=1;t=t.split(":");const n=[];for(;0<e&&t.length;)n.push(t.shift()),e--;return t.length&&n.push(t.join(":")),n}function ER(t){J.setTimeout(()=>{throw t},0)}let yo,wo=!1,Bh=new _R,O_=()=>{const t=J.Promise.resolve(void 0);yo=()=>{t.then(IR)}};var IR=()=>{for(var t;t=gR();){try{t.h.call(t.g)}catch(n){ER(n)}var e=N_;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}wo=!1};function $c(t,e){tt.call(this),this.h=t||1,this.g=e||J,this.j=ft(this.qb,this),this.l=Date.now()}nt($c,tt);F=$c.prototype;F.ga=!1;F.T=null;F.qb=function(){if(this.ga){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-t):(this.T&&(this.g.clearTimeout(this.T),this.T=null),ct(this,"tick"),this.ga&&(Uh(this),this.start()))}};F.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function Uh(t){t.ga=!1,t.T&&(t.g.clearTimeout(t.T),t.T=null)}F.N=function(){$c.$.N.call(this),Uh(this),delete this.g};function $h(t,e,n){if(typeof t=="function")n&&(t=ft(t,n));else if(t&&typeof t.handleEvent=="function")t=ft(t.handleEvent,t);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:J.setTimeout(t,e||0)}function M_(t){t.g=$h(()=>{t.g=null,t.i&&(t.i=!1,M_(t))},t.j);const e=t.h;t.h=null,t.m.apply(null,e)}class vR extends wr{constructor(e,n){super(),this.m=e,this.j=n,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:M_(this)}N(){super.N(),this.g&&(J.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Eo(t){wr.call(this),this.h=t,this.g={}}nt(Eo,wr);var mm=[];function F_(t,e,n,r){Array.isArray(n)||(n&&(mm[0]=n.toString()),n=mm);for(var s=0;s<n.length;s++){var i=C_(e,n[s],r||t.handleEvent,!1,t.h||t);if(!i)break;t.g[i.key]=i}}function L_(t){Vh(t.g,function(e,n){this.g.hasOwnProperty(n)&&Oh(e)},t),t.g={}}Eo.prototype.N=function(){Eo.$.N.call(this),L_(this)};Eo.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function qc(){this.g=!0}qc.prototype.Ea=function(){this.g=!1};function TR(t,e,n,r,s,i){t.info(function(){if(t.g)if(i)for(var o="",a=i.split("&"),c=0;c<a.length;c++){var l=a[c].split("=");if(1<l.length){var u=l[0];l=l[1];var h=u.split("_");o=2<=h.length&&h[1]=="type"?o+(u+"="+l+"&"):o+(u+"=redacted&")}}else o=null;else o=i;return"XMLHTTP REQ ("+r+") [attempt "+s+"]: "+e+`
`+n+`
`+o})}function bR(t,e,n,r,s,i,o){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+s+"]: "+e+`
`+n+`
`+i+" "+o})}function Vs(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+RR(t,n)+(r?" "+r:"")})}function AR(t,e){t.info(function(){return"TIMEOUT: "+e})}qc.prototype.info=function(){};function RR(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n){for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var s=r[1];if(Array.isArray(s)&&!(1>s.length)){var i=s[0];if(i!="noop"&&i!="stop"&&i!="close")for(var o=1;o<s.length;o++)s[o]=""}}}}return Lh(n)}catch{return e}}var hs={},pm=null;function jc(){return pm=pm||new tt}hs.Ta="serverreachability";function B_(t){mt.call(this,hs.Ta,t)}nt(B_,mt);function Io(t){const e=jc();ct(e,new B_(e))}hs.STAT_EVENT="statevent";function U_(t,e){mt.call(this,hs.STAT_EVENT,t),this.stat=e}nt(U_,mt);function vt(t){const e=jc();ct(e,new U_(e,t))}hs.Ua="timingevent";function $_(t,e){mt.call(this,hs.Ua,t),this.size=e}nt($_,mt);function Uo(t,e){if(typeof t!="function")throw Error("Fn must not be null and must be a function");return J.setTimeout(function(){t()},e)}var zc={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},q_={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function qh(){}qh.prototype.h=null;function gm(t){return t.h||(t.h=t.i())}function j_(){}var $o={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function jh(){mt.call(this,"d")}nt(jh,mt);function zh(){mt.call(this,"c")}nt(zh,mt);var Au;function Kc(){}nt(Kc,qh);Kc.prototype.g=function(){return new XMLHttpRequest};Kc.prototype.i=function(){return{}};Au=new Kc;function qo(t,e,n,r){this.l=t,this.j=e,this.m=n,this.W=r||1,this.U=new Eo(this),this.P=PR,t=Eu?125:void 0,this.V=new $c(t),this.I=null,this.i=!1,this.u=this.B=this.A=this.L=this.G=this.Y=this.C=null,this.F=[],this.g=null,this.o=0,this.s=this.v=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new z_}function z_(){this.i=null,this.g="",this.h=!1}var PR=45e3,K_={},Ru={};F=qo.prototype;F.setTimeout=function(t){this.P=t};function Pu(t,e,n){t.L=1,t.A=Hc(Mn(e)),t.u=n,t.S=!0,G_(t,null)}function G_(t,e){t.G=Date.now(),jo(t),t.B=Mn(t.A);var n=t.B,r=t.W;Array.isArray(r)||(r=[String(r)]),ey(n.i,"t",r),t.o=0,n=t.l.J,t.h=new z_,t.g=Iy(t.l,n?e:null,!t.u),0<t.O&&(t.M=new vR(ft(t.Pa,t,t.g),t.O)),F_(t.U,t.g,"readystatechange",t.nb),e=t.I?P_(t.I):{},t.u?(t.v||(t.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ha(t.B,t.v,t.u,e)):(t.v="GET",t.g.ha(t.B,t.v,null,e)),Io(),TR(t.j,t.v,t.B,t.m,t.W,t.u)}F.nb=function(t){t=t.target;const e=this.M;e&&pn(t)==3?e.l():this.Pa(t)};F.Pa=function(t){try{if(t==this.g)e:{const u=pn(this.g);var e=this.g.Ia();const h=this.g.da();if(!(3>u)&&(u!=3||Eu||this.g&&(this.h.h||this.g.ja()||Em(this.g)))){this.J||u!=4||e==7||(e==8||0>=h?Io(3):Io(2)),Gc(this);var n=this.g.da();this.ca=n;t:if(H_(this)){var r=Em(this.g);t="";var s=r.length,i=pn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){zr(this),Yi(this);var o="";break t}this.h.i=new J.TextDecoder}for(e=0;e<s;e++)this.h.h=!0,t+=this.h.i.decode(r[e],{stream:i&&e==s-1});r.length=0,this.h.g+=t,this.o=0,o=this.h.g}else o=this.g.ja();if(this.i=n==200,bR(this.j,this.v,this.B,this.m,this.W,u,n),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!go(a)){var l=a;break t}}l=null}if(n=l)Vs(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Su(this,n);else{this.i=!1,this.s=3,vt(12),zr(this),Yi(this);break e}}this.S?(W_(this,u,o),Eu&&this.i&&u==3&&(F_(this.U,this.V,"tick",this.mb),this.V.start())):(Vs(this.j,this.m,o,null),Su(this,o)),u==4&&zr(this),this.i&&!this.J&&(u==4?_y(this.l,this):(this.i=!1,jo(this)))}else WR(this.g),n==400&&0<o.indexOf("Unknown SID")?(this.s=3,vt(12)):(this.s=0,vt(13)),zr(this),Yi(this)}}}catch{}finally{}};function H_(t){return t.g?t.v=="GET"&&t.L!=2&&t.l.Ha:!1}function W_(t,e,n){let r=!0,s;for(;!t.J&&t.o<n.length;)if(s=SR(t,n),s==Ru){e==4&&(t.s=4,vt(14),r=!1),Vs(t.j,t.m,null,"[Incomplete Response]");break}else if(s==K_){t.s=4,vt(15),Vs(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}else Vs(t.j,t.m,s,null),Su(t,s);H_(t)&&t.o!=0&&(t.h.g=t.h.g.slice(t.o),t.o=0),e!=4||n.length!=0||t.h.h||(t.s=1,vt(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.ba&&(t.ba=!0,e=t.l,e.g==t&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),Yh(e),e.M=!0,vt(11))):(Vs(t.j,t.m,n,"[Invalid Chunked Response]"),zr(t),Yi(t))}F.mb=function(){if(this.g){var t=pn(this.g),e=this.g.ja();this.o<e.length&&(Gc(this),W_(this,t,e),this.i&&t!=4&&jo(this))}};function SR(t,e){var n=t.o,r=e.indexOf(`
`,n);return r==-1?Ru:(n=Number(e.substring(n,r)),isNaN(n)?K_:(r+=1,r+n>e.length?Ru:(e=e.slice(r,r+n),t.o=r+n,e)))}F.cancel=function(){this.J=!0,zr(this)};function jo(t){t.Y=Date.now()+t.P,Q_(t,t.P)}function Q_(t,e){if(t.C!=null)throw Error("WatchDog timer not null");t.C=Uo(ft(t.lb,t),e)}function Gc(t){t.C&&(J.clearTimeout(t.C),t.C=null)}F.lb=function(){this.C=null;const t=Date.now();0<=t-this.Y?(AR(this.j,this.B),this.L!=2&&(Io(),vt(17)),zr(this),this.s=2,Yi(this)):Q_(this,this.Y-t)};function Yi(t){t.l.H==0||t.J||_y(t.l,t)}function zr(t){Gc(t);var e=t.M;e&&typeof e.sa=="function"&&e.sa(),t.M=null,Uh(t.V),L_(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.sa())}function Su(t,e){try{var n=t.l;if(n.H!=0&&(n.g==t||Cu(n.i,t))){if(!t.K&&Cu(n.i,t)&&n.H==3){try{var r=n.Ja.g.parse(e)}catch{r=null}if(Array.isArray(r)&&r.length==3){var s=r;if(s[0]==0){e:if(!n.u){if(n.g)if(n.g.G+3e3<t.G)tc(n),Yc(n);else break e;Qh(n),vt(18)}}else n.Fa=s[1],0<n.Fa-n.V&&37500>s[2]&&n.G&&n.A==0&&!n.v&&(n.v=Uo(ft(n.ib,n),6e3));if(1>=ry(n.i)&&n.oa){try{n.oa()}catch{}n.oa=void 0}}else Kr(n,11)}else if((t.K||n.g==t)&&tc(n),!go(e))for(s=n.Ja.g.parse(e),e=0;e<s.length;e++){let l=s[e];if(n.V=l[0],l=l[1],n.H==2)if(l[0]=="c"){n.K=l[1],n.pa=l[2];const u=l[3];u!=null&&(n.ra=u,n.l.info("VER="+n.ra));const h=l[4];h!=null&&(n.Ga=h,n.l.info("SVER="+n.Ga));const d=l[5];d!=null&&typeof d=="number"&&0<d&&(r=1.5*d,n.L=r,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;const f=t.g;if(f){const y=f.g?f.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(y){var i=r.i;i.g||y.indexOf("spdy")==-1&&y.indexOf("quic")==-1&&y.indexOf("h2")==-1||(i.j=i.l,i.g=new Set,i.h&&(Kh(i,i.h),i.h=null))}if(r.F){const w=f.g?f.g.getResponseHeader("X-HTTP-Session-Id"):null;w&&(r.Da=w,xe(r.I,r.F,w))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-t.G,n.l.info("Handshake RTT: "+n.S+"ms")),r=n;var o=t;if(r.wa=Ey(r,r.J?r.pa:null,r.Y),o.K){sy(r.i,o);var a=o,c=r.L;c&&a.setTimeout(c),a.C&&(Gc(a),jo(a)),r.g=o}else py(r);0<n.j.length&&Jc(n)}else l[0]!="stop"&&l[0]!="close"||Kr(n,7);else n.H==3&&(l[0]=="stop"||l[0]=="close"?l[0]=="stop"?Kr(n,7):Wh(n):l[0]!="noop"&&n.h&&n.h.Aa(l),n.A=0)}}Io(4)}catch{}}function CR(t){if(t.Z&&typeof t.Z=="function")return t.Z();if(typeof Map<"u"&&t instanceof Map||typeof Set<"u"&&t instanceof Set)return Array.from(t.values());if(typeof t=="string")return t.split("");if(Fc(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}e=[],n=0;for(r in t)e[n++]=t[r];return e}function xR(t){if(t.ta&&typeof t.ta=="function")return t.ta();if(!t.Z||typeof t.Z!="function"){if(typeof Map<"u"&&t instanceof Map)return Array.from(t.keys());if(!(typeof Set<"u"&&t instanceof Set)){if(Fc(t)||typeof t=="string"){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(const r in t)e[n++]=r;return e}}}function Y_(t,e){if(t.forEach&&typeof t.forEach=="function")t.forEach(e,void 0);else if(Fc(t)||typeof t=="string")Array.prototype.forEach.call(t,e,void 0);else for(var n=xR(t),r=CR(t),s=r.length,i=0;i<s;i++)e.call(void 0,r[i],n&&n[i],t)}var J_=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function DR(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),s=null;if(0<=r){var i=t[n].substring(0,r);s=t[n].substring(r+1)}else i=t[n];e(i,s?decodeURIComponent(s.replace(/\+/g," ")):"")}}}function Yr(t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof Yr){this.h=t.h,Za(this,t.j),this.s=t.s,this.g=t.g,ec(this,t.m),this.l=t.l;var e=t.i,n=new vo;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),_m(this,n),this.o=t.o}else t&&(e=String(t).match(J_))?(this.h=!1,Za(this,e[1]||"",!0),this.s=$i(e[2]||""),this.g=$i(e[3]||"",!0),ec(this,e[4]),this.l=$i(e[5]||"",!0),_m(this,e[6]||"",!0),this.o=$i(e[7]||"")):(this.h=!1,this.i=new vo(null,this.h))}Yr.prototype.toString=function(){var t=[],e=this.j;e&&t.push(qi(e,ym,!0),":");var n=this.g;return(n||e=="file")&&(t.push("//"),(e=this.s)&&t.push(qi(e,ym,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.m,n!=null&&t.push(":",String(n))),(n=this.l)&&(this.g&&n.charAt(0)!="/"&&t.push("/"),t.push(qi(n,n.charAt(0)=="/"?NR:VR,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",qi(n,MR)),t.join("")};function Mn(t){return new Yr(t)}function Za(t,e,n){t.j=n?$i(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function ec(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function _m(t,e,n){e instanceof vo?(t.i=e,FR(t.i,t.h)):(n||(e=qi(e,OR)),t.i=new vo(e,t.h))}function xe(t,e,n){t.i.set(e,n)}function Hc(t){return xe(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function $i(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function qi(t,e,n){return typeof t=="string"?(t=encodeURI(t).replace(e,kR),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function kR(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(t&15).toString(16)}var ym=/[#\/\?@]/g,VR=/[#\?:]/g,NR=/[#\?]/g,OR=/[#\?@]/g,MR=/#/g;function vo(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function Er(t){t.g||(t.g=new Map,t.h=0,t.i&&DR(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}F=vo.prototype;F.add=function(t,e){Er(this),this.i=null,t=_i(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this};function X_(t,e){Er(t),e=_i(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function Z_(t,e){return Er(t),e=_i(t,e),t.g.has(e)}F.forEach=function(t,e){Er(this),this.g.forEach(function(n,r){n.forEach(function(s){t.call(e,s,r,this)},this)},this)};F.ta=function(){Er(this);const t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let r=0;r<e.length;r++){const s=t[r];for(let i=0;i<s.length;i++)n.push(e[r])}return n};F.Z=function(t){Er(this);let e=[];if(typeof t=="string")Z_(this,t)&&(e=e.concat(this.g.get(_i(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e};F.set=function(t,e){return Er(this),this.i=null,t=_i(this,t),Z_(this,t)&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this};F.get=function(t,e){return t?(t=this.Z(t),0<t.length?String(t[0]):e):e};function ey(t,e,n){X_(t,e),0<n.length&&(t.i=null,t.g.set(_i(t,e),Dh(n)),t.h+=n.length)}F.toString=function(){if(this.i)return this.i;if(!this.g)return"";const t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var r=e[n];const i=encodeURIComponent(String(r)),o=this.Z(r);for(r=0;r<o.length;r++){var s=i;o[r]!==""&&(s+="="+encodeURIComponent(String(o[r]))),t.push(s)}}return this.i=t.join("&")};function _i(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function FR(t,e){e&&!t.j&&(Er(t),t.i=null,t.g.forEach(function(n,r){var s=r.toLowerCase();r!=s&&(X_(this,r),ey(this,s,n))},t)),t.j=e}var LR=class{constructor(t,e){this.g=t,this.map=e}};function ty(t){this.l=t||BR,J.PerformanceNavigationTiming?(t=J.performance.getEntriesByType("navigation"),t=0<t.length&&(t[0].nextHopProtocol=="hq"||t[0].nextHopProtocol=="h2")):t=!!(J.g&&J.g.Ka&&J.g.Ka()&&J.g.Ka().dc),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var BR=10;function ny(t){return t.h?!0:t.g?t.g.size>=t.j:!1}function ry(t){return t.h?1:t.g?t.g.size:0}function Cu(t,e){return t.h?t.h==e:t.g?t.g.has(e):!1}function Kh(t,e){t.g?t.g.add(e):t.h=e}function sy(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}ty.prototype.cancel=function(){if(this.i=iy(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const t of this.g.values())t.cancel();this.g.clear()}};function iy(t){if(t.h!=null)return t.i.concat(t.h.F);if(t.g!=null&&t.g.size!==0){let e=t.i;for(const n of t.g.values())e=e.concat(n.F);return e}return Dh(t.i)}var UR=class{stringify(t){return J.JSON.stringify(t,void 0)}parse(t){return J.JSON.parse(t,void 0)}};function $R(){this.g=new UR}function qR(t,e,n){const r=n||"";try{Y_(t,function(s,i){let o=s;Lo(s)&&(o=Lh(s)),e.push(r+i+"="+encodeURIComponent(o))})}catch(s){throw e.push(r+"type="+encodeURIComponent("_badmap")),s}}function jR(t,e){const n=new qc;if(J.Image){const r=new Image;r.onload=pa(_a,n,r,"TestLoadImage: loaded",!0,e),r.onerror=pa(_a,n,r,"TestLoadImage: error",!1,e),r.onabort=pa(_a,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=pa(_a,n,r,"TestLoadImage: timeout",!1,e),J.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}function _a(t,e,n,r,s){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,s(r)}catch{}}function zo(t){this.l=t.ec||null,this.j=t.ob||!1}nt(zo,qh);zo.prototype.g=function(){return new Wc(this.l,this.j)};zo.prototype.i=function(t){return function(){return t}}({});function Wc(t,e){tt.call(this),this.F=t,this.u=e,this.m=void 0,this.readyState=Gh,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}nt(Wc,tt);var Gh=0;F=Wc.prototype;F.open=function(t,e){if(this.readyState!=Gh)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,To(this)};F.send=function(t){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.F||J).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))};F.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ko(this)),this.readyState=Gh};F.$a=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,To(this)),this.g&&(this.readyState=3,To(this),this.g)))if(this.responseType==="arraybuffer")t.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof J.ReadableStream<"u"&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;oy(this)}else t.text().then(this.Za.bind(this),this.ka.bind(this))};function oy(t){t.j.read().then(t.Xa.bind(t)).catch(t.ka.bind(t))}F.Xa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?Ko(this):To(this),this.readyState==3&&oy(this)}};F.Za=function(t){this.g&&(this.response=this.responseText=t,Ko(this))};F.Ya=function(t){this.g&&(this.response=t,Ko(this))};F.ka=function(){this.g&&Ko(this)};function Ko(t){t.readyState=4,t.l=null,t.j=null,t.A=null,To(t)}F.setRequestHeader=function(t,e){this.v.append(t,e)};F.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""};F.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join(`\r
`)};function To(t){t.onreadystatechange&&t.onreadystatechange.call(t)}Object.defineProperty(Wc.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(t){this.m=t?"include":"same-origin"}});var zR=J.JSON.parse;function $e(t){tt.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=ay,this.L=this.M=!1}nt($e,tt);var ay="",KR=/^https?$/i,GR=["POST","PUT"];F=$e.prototype;F.Oa=function(t){this.M=t};F.ha=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+t);e=e?e.toUpperCase():"GET",this.I=t,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():Au.g(),this.C=this.u?gm(this.u):gm(Au),this.g.onreadystatechange=ft(this.La,this);try{this.G=!0,this.g.open(e,String(t),!0),this.G=!1}catch(i){wm(this,i);return}if(t=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var s in r)n.set(s,r[s]);else if(typeof r.keys=="function"&&typeof r.get=="function")for(const i of r.keys())n.set(i,r.get(i));else throw Error("Unknown input type for opt_headers: "+String(r));r=Array.from(n.keys()).find(i=>i.toLowerCase()=="content-type"),s=J.FormData&&t instanceof J.FormData,!(0<=T_(GR,e))||r||s||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[i,o]of n)this.g.setRequestHeader(i,o);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{uy(this),0<this.B&&((this.L=HR(this.g))?(this.g.timeout=this.B,this.g.ontimeout=ft(this.ua,this)):this.A=$h(this.ua,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(i){wm(this,i)}};function HR(t){return Zs&&typeof t.timeout=="number"&&t.ontimeout!==void 0}F.ua=function(){typeof xh<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,ct(this,"timeout"),this.abort(8))};function wm(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,cy(t),Qc(t)}function cy(t){t.F||(t.F=!0,ct(t,"complete"),ct(t,"error"))}F.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,ct(this,"complete"),ct(this,"abort"),Qc(this))};F.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Qc(this,!0)),$e.$.N.call(this)};F.La=function(){this.s||(this.G||this.v||this.l?ly(this):this.kb())};F.kb=function(){ly(this)};function ly(t){if(t.h&&typeof xh<"u"&&(!t.C[1]||pn(t)!=4||t.da()!=2)){if(t.v&&pn(t)==4)$h(t.La,0,t);else if(ct(t,"readystatechange"),pn(t)==4){t.h=!1;try{const o=t.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var n;if(!(n=e)){var r;if(r=o===0){var s=String(t.I).match(J_)[1]||null;!s&&J.self&&J.self.location&&(s=J.self.location.protocol.slice(0,-1)),r=!KR.test(s?s.toLowerCase():"")}n=r}if(n)ct(t,"complete"),ct(t,"success");else{t.m=6;try{var i=2<pn(t)?t.g.statusText:""}catch{i=""}t.j=i+" ["+t.da()+"]",cy(t)}}finally{Qc(t)}}}}function Qc(t,e){if(t.g){uy(t);const n=t.g,r=t.C[0]?()=>{}:null;t.g=null,t.C=null,e||ct(t,"ready");try{n.onreadystatechange=r}catch{}}}function uy(t){t.g&&t.L&&(t.g.ontimeout=null),t.A&&(J.clearTimeout(t.A),t.A=null)}F.isActive=function(){return!!this.g};function pn(t){return t.g?t.g.readyState:0}F.da=function(){try{return 2<pn(this)?this.g.status:-1}catch{return-1}};F.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}};F.Wa=function(t){if(this.g){var e=this.g.responseText;return t&&e.indexOf(t)==0&&(e=e.substring(t.length)),zR(e)}};function Em(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.K){case ay:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch{return null}}function WR(t){const e={};t=(t.g&&2<=pn(t)&&t.g.getAllResponseHeaders()||"").split(`\r
`);for(let r=0;r<t.length;r++){if(go(t[r]))continue;var n=wR(t[r]);const s=n[0];if(n=n[1],typeof n!="string")continue;n=n.trim();const i=e[s]||[];e[s]=i,i.push(n)}dR(e,function(r){return r.join(", ")})}F.Ia=function(){return this.m};F.Sa=function(){return typeof this.j=="string"?this.j:String(this.j)};function hy(t){let e="";return Vh(t,function(n,r){e+=r,e+=":",e+=n,e+=`\r
`}),e}function Hh(t,e,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=hy(n),typeof t=="string"?n!=null&&encodeURIComponent(String(n)):xe(t,e,n))}function ki(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function dy(t){this.Ga=0,this.j=[],this.l=new qc,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=ki("failFast",!1,t),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=ki("baseRetryDelayMs",5e3,t),this.hb=ki("retryDelaySeedMs",1e4,t),this.eb=ki("forwardChannelMaxRetries",2,t),this.xa=ki("forwardChannelRequestTimeoutMs",2e4,t),this.va=t&&t.xmlHttpFactory||void 0,this.Ha=t&&t.useFetchStreams||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.i=new ty(t&&t.concurrentRequestLimit),this.Ja=new $R,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=t&&t.bc||!1,t&&t.Ea&&this.l.Ea(),t&&t.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&t&&t.detectBufferingProxy||!1,this.qa=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.qa=t.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}F=dy.prototype;F.ra=8;F.H=1;function Wh(t){if(fy(t),t.H==3){var e=t.W++,n=Mn(t.I);if(xe(n,"SID",t.K),xe(n,"RID",e),xe(n,"TYPE","terminate"),Go(t,n),e=new qo(t,t.l,e),e.L=2,e.A=Hc(Mn(n)),n=!1,J.navigator&&J.navigator.sendBeacon)try{n=J.navigator.sendBeacon(e.A.toString(),"")}catch{}!n&&J.Image&&(new Image().src=e.A,n=!0),n||(e.g=Iy(e.l,null),e.g.ha(e.A)),e.G=Date.now(),jo(e)}wy(t)}function Yc(t){t.g&&(Yh(t),t.g.cancel(),t.g=null)}function fy(t){Yc(t),t.u&&(J.clearTimeout(t.u),t.u=null),tc(t),t.i.cancel(),t.m&&(typeof t.m=="number"&&J.clearTimeout(t.m),t.m=null)}function Jc(t){if(!ny(t.i)&&!t.m){t.m=!0;var e=t.Na;yo||O_(),wo||(yo(),wo=!0),Bh.add(e,t),t.C=0}}function QR(t,e){return ry(t.i)>=t.i.j-(t.m?1:0)?!1:t.m?(t.j=e.F.concat(t.j),!0):t.H==1||t.H==2||t.C>=(t.cb?0:t.eb)?!1:(t.m=Uo(ft(t.Na,t,e),yy(t,t.C)),t.C++,!0)}F.Na=function(t){if(this.m)if(this.m=null,this.H==1){if(!t){this.W=Math.floor(1e5*Math.random()),t=this.W++;const s=new qo(this,this.l,t);let i=this.s;if(this.U&&(i?(i=P_(i),S_(i,this.U)):i=this.U),this.o!==null||this.O||(s.I=i,i=null),this.P)e:{for(var e=0,n=0;n<this.j.length;n++){t:{var r=this.j[n];if("__data__"in r.map&&(r=r.map.__data__,typeof r=="string")){r=r.length;break t}r=void 0}if(r===void 0)break;if(e+=r,4096<e){e=n;break e}if(e===4096||n===this.j.length-1){e=n+1;break e}}e=1e3}else e=1e3;e=my(this,s,e),n=Mn(this.I),xe(n,"RID",t),xe(n,"CVER",22),this.F&&xe(n,"X-HTTP-Session-Id",this.F),Go(this,n),i&&(this.O?e="headers="+encodeURIComponent(String(hy(i)))+"&"+e:this.o&&Hh(n,this.o,i)),Kh(this.i,s),this.bb&&xe(n,"TYPE","init"),this.P?(xe(n,"$req",e),xe(n,"SID","null"),s.aa=!0,Pu(s,n,null)):Pu(s,n,e),this.H=2}}else this.H==3&&(t?Im(this,t):this.j.length==0||ny(this.i)||Im(this))};function Im(t,e){var n;e?n=e.m:n=t.W++;const r=Mn(t.I);xe(r,"SID",t.K),xe(r,"RID",n),xe(r,"AID",t.V),Go(t,r),t.o&&t.s&&Hh(r,t.o,t.s),n=new qo(t,t.l,n,t.C+1),t.o===null&&(n.I=t.s),e&&(t.j=e.F.concat(t.j)),e=my(t,n,1e3),n.setTimeout(Math.round(.5*t.xa)+Math.round(.5*t.xa*Math.random())),Kh(t.i,n),Pu(n,r,e)}function Go(t,e){t.na&&Vh(t.na,function(n,r){xe(e,r,n)}),t.h&&Y_({},function(n,r){xe(e,r,n)})}function my(t,e,n){n=Math.min(t.j.length,n);var r=t.h?ft(t.h.Va,t.h,t):null;e:{var s=t.j;let i=-1;for(;;){const o=["count="+n];i==-1?0<n?(i=s[0].g,o.push("ofs="+i)):i=0:o.push("ofs="+i);let a=!0;for(let c=0;c<n;c++){let l=s[c].g;const u=s[c].map;if(l-=i,0>l)i=Math.max(0,s[c].g-100),a=!1;else try{qR(u,o,"req"+l+"_")}catch{r&&r(u)}}if(a){r=o.join("&");break e}}}return t=t.j.splice(0,n),e.F=t,r}function py(t){if(!t.g&&!t.u){t.ba=1;var e=t.Ma;yo||O_(),wo||(yo(),wo=!0),Bh.add(e,t),t.A=0}}function Qh(t){return t.g||t.u||3<=t.A?!1:(t.ba++,t.u=Uo(ft(t.Ma,t),yy(t,t.A)),t.A++,!0)}F.Ma=function(){if(this.u=null,gy(this),this.ca&&!(this.M||this.g==null||0>=this.S)){var t=2*this.S;this.l.info("BP detection timer enabled: "+t),this.B=Uo(ft(this.jb,this),t)}};F.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,vt(10),Yc(this),gy(this))};function Yh(t){t.B!=null&&(J.clearTimeout(t.B),t.B=null)}function gy(t){t.g=new qo(t,t.l,"rpc",t.ba),t.o===null&&(t.g.I=t.s),t.g.O=0;var e=Mn(t.wa);xe(e,"RID","rpc"),xe(e,"SID",t.K),xe(e,"AID",t.V),xe(e,"CI",t.G?"0":"1"),!t.G&&t.qa&&xe(e,"TO",t.qa),xe(e,"TYPE","xmlhttp"),Go(t,e),t.o&&t.s&&Hh(e,t.o,t.s),t.L&&t.g.setTimeout(t.L);var n=t.g;t=t.pa,n.L=1,n.A=Hc(Mn(e)),n.u=null,n.S=!0,G_(n,t)}F.ib=function(){this.v!=null&&(this.v=null,Yc(this),Qh(this),vt(19))};function tc(t){t.v!=null&&(J.clearTimeout(t.v),t.v=null)}function _y(t,e){var n=null;if(t.g==e){tc(t),Yh(t),t.g=null;var r=2}else if(Cu(t.i,e))n=e.F,sy(t.i,e),r=1;else return;if(t.H!=0){if(e.i)if(r==1){n=e.u?e.u.length:0,e=Date.now()-e.G;var s=t.C;r=jc(),ct(r,new $_(r,n)),Jc(t)}else py(t);else if(s=e.s,s==3||s==0&&0<e.ca||!(r==1&&QR(t,e)||r==2&&Qh(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),s){case 1:Kr(t,5);break;case 4:Kr(t,10);break;case 3:Kr(t,6);break;default:Kr(t,2)}}}function yy(t,e){let n=t.ab+Math.floor(Math.random()*t.hb);return t.isActive()||(n*=2),n*e}function Kr(t,e){if(t.l.info("Error code "+e),e==2){var n=null;t.h&&(n=null);var r=ft(t.pb,t);n||(n=new Yr("//www.google.com/images/cleardot.gif"),J.location&&J.location.protocol=="http"||Za(n,"https"),Hc(n)),jR(n.toString(),r)}else vt(2);t.H=0,t.h&&t.h.za(e),wy(t),fy(t)}F.pb=function(t){t?(this.l.info("Successfully pinged google.com"),vt(2)):(this.l.info("Failed to ping google.com"),vt(1))};function wy(t){if(t.H=0,t.ma=[],t.h){const e=iy(t.i);(e.length!=0||t.j.length!=0)&&(hm(t.ma,e),hm(t.ma,t.j),t.i.i.length=0,Dh(t.j),t.j.length=0),t.h.ya()}}function Ey(t,e,n){var r=n instanceof Yr?Mn(n):new Yr(n);if(r.g!="")e&&(r.g=e+"."+r.g),ec(r,r.m);else{var s=J.location;r=s.protocol,e=e?e+"."+s.hostname:s.hostname,s=+s.port;var i=new Yr(null);r&&Za(i,r),e&&(i.g=e),s&&ec(i,s),n&&(i.l=n),r=i}return n=t.F,e=t.Da,n&&e&&xe(r,n,e),xe(r,"VER",t.ra),Go(t,r),r}function Iy(t,e,n){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return e=t.Ha&&!t.va?new $e(new zo({ob:n})):new $e(t.va),e.Oa(t.J),e}F.isActive=function(){return!!this.h&&this.h.isActive(this)};function vy(){}F=vy.prototype;F.Ba=function(){};F.Aa=function(){};F.za=function(){};F.ya=function(){};F.isActive=function(){return!0};F.Va=function(){};function nc(){if(Zs&&!(10<=Number(cR)))throw Error("Environmental error: no available transport.")}nc.prototype.g=function(t,e){return new Lt(t,e)};function Lt(t,e){tt.call(this),this.g=new dy(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(t?t["X-WebChannel-Client-Profile"]=e.Ca:t={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=t,(t=e&&e.cc)&&!go(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!go(e)&&(this.g.F=e,t=this.h,t!==null&&e in t&&(t=this.h,e in t&&delete t[e])),this.j=new yi(this)}nt(Lt,tt);Lt.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var t=this.g,e=this.l,n=this.h||void 0;vt(0),t.Y=e,t.na=n||{},t.G=t.aa,t.I=Ey(t,null,t.Y),Jc(t)};Lt.prototype.close=function(){Wh(this.g)};Lt.prototype.u=function(t){var e=this.g;if(typeof t=="string"){var n={};n.__data__=t,t=n}else this.v&&(n={},n.__data__=Lh(t),t=n);e.j.push(new LR(e.fb++,t)),e.H==3&&Jc(e)};Lt.prototype.N=function(){this.g.h=null,delete this.j,Wh(this.g),delete this.g,Lt.$.N.call(this)};function Ty(t){jh.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){e:{for(const n in e){t=n;break e}t=void 0}(this.i=t)&&(t=this.i,e=e!==null&&t in e?e[t]:void 0),this.data=e}else this.data=t}nt(Ty,jh);function by(){zh.call(this),this.status=1}nt(by,zh);function yi(t){this.g=t}nt(yi,vy);yi.prototype.Ba=function(){ct(this.g,"a")};yi.prototype.Aa=function(t){ct(this.g,new Ty(t))};yi.prototype.za=function(t){ct(this.g,new by)};yi.prototype.ya=function(){ct(this.g,"b")};function YR(){this.blockSize=-1}function sn(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}nt(sn,YR);sn.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0};function Kl(t,e,n){n||(n=0);var r=Array(16);if(typeof e=="string")for(var s=0;16>s;++s)r[s]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(s=0;16>s;++s)r[s]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;e=t.g[0],n=t.g[1],s=t.g[2];var i=t.g[3],o=e+(i^n&(s^i))+r[0]+3614090360&4294967295;e=n+(o<<7&4294967295|o>>>25),o=i+(s^e&(n^s))+r[1]+3905402710&4294967295,i=e+(o<<12&4294967295|o>>>20),o=s+(n^i&(e^n))+r[2]+606105819&4294967295,s=i+(o<<17&4294967295|o>>>15),o=n+(e^s&(i^e))+r[3]+3250441966&4294967295,n=s+(o<<22&4294967295|o>>>10),o=e+(i^n&(s^i))+r[4]+4118548399&4294967295,e=n+(o<<7&4294967295|o>>>25),o=i+(s^e&(n^s))+r[5]+1200080426&4294967295,i=e+(o<<12&4294967295|o>>>20),o=s+(n^i&(e^n))+r[6]+2821735955&4294967295,s=i+(o<<17&4294967295|o>>>15),o=n+(e^s&(i^e))+r[7]+4249261313&4294967295,n=s+(o<<22&4294967295|o>>>10),o=e+(i^n&(s^i))+r[8]+1770035416&4294967295,e=n+(o<<7&4294967295|o>>>25),o=i+(s^e&(n^s))+r[9]+2336552879&4294967295,i=e+(o<<12&4294967295|o>>>20),o=s+(n^i&(e^n))+r[10]+4294925233&4294967295,s=i+(o<<17&4294967295|o>>>15),o=n+(e^s&(i^e))+r[11]+2304563134&4294967295,n=s+(o<<22&4294967295|o>>>10),o=e+(i^n&(s^i))+r[12]+1804603682&4294967295,e=n+(o<<7&4294967295|o>>>25),o=i+(s^e&(n^s))+r[13]+4254626195&4294967295,i=e+(o<<12&4294967295|o>>>20),o=s+(n^i&(e^n))+r[14]+2792965006&4294967295,s=i+(o<<17&4294967295|o>>>15),o=n+(e^s&(i^e))+r[15]+1236535329&4294967295,n=s+(o<<22&4294967295|o>>>10),o=e+(s^i&(n^s))+r[1]+4129170786&4294967295,e=n+(o<<5&4294967295|o>>>27),o=i+(n^s&(e^n))+r[6]+3225465664&4294967295,i=e+(o<<9&4294967295|o>>>23),o=s+(e^n&(i^e))+r[11]+643717713&4294967295,s=i+(o<<14&4294967295|o>>>18),o=n+(i^e&(s^i))+r[0]+3921069994&4294967295,n=s+(o<<20&4294967295|o>>>12),o=e+(s^i&(n^s))+r[5]+3593408605&4294967295,e=n+(o<<5&4294967295|o>>>27),o=i+(n^s&(e^n))+r[10]+38016083&4294967295,i=e+(o<<9&4294967295|o>>>23),o=s+(e^n&(i^e))+r[15]+3634488961&4294967295,s=i+(o<<14&4294967295|o>>>18),o=n+(i^e&(s^i))+r[4]+3889429448&4294967295,n=s+(o<<20&4294967295|o>>>12),o=e+(s^i&(n^s))+r[9]+568446438&4294967295,e=n+(o<<5&4294967295|o>>>27),o=i+(n^s&(e^n))+r[14]+3275163606&4294967295,i=e+(o<<9&4294967295|o>>>23),o=s+(e^n&(i^e))+r[3]+4107603335&4294967295,s=i+(o<<14&4294967295|o>>>18),o=n+(i^e&(s^i))+r[8]+1163531501&4294967295,n=s+(o<<20&4294967295|o>>>12),o=e+(s^i&(n^s))+r[13]+2850285829&4294967295,e=n+(o<<5&4294967295|o>>>27),o=i+(n^s&(e^n))+r[2]+4243563512&4294967295,i=e+(o<<9&4294967295|o>>>23),o=s+(e^n&(i^e))+r[7]+1735328473&4294967295,s=i+(o<<14&4294967295|o>>>18),o=n+(i^e&(s^i))+r[12]+2368359562&4294967295,n=s+(o<<20&4294967295|o>>>12),o=e+(n^s^i)+r[5]+4294588738&4294967295,e=n+(o<<4&4294967295|o>>>28),o=i+(e^n^s)+r[8]+2272392833&4294967295,i=e+(o<<11&4294967295|o>>>21),o=s+(i^e^n)+r[11]+1839030562&4294967295,s=i+(o<<16&4294967295|o>>>16),o=n+(s^i^e)+r[14]+4259657740&4294967295,n=s+(o<<23&4294967295|o>>>9),o=e+(n^s^i)+r[1]+2763975236&4294967295,e=n+(o<<4&4294967295|o>>>28),o=i+(e^n^s)+r[4]+1272893353&4294967295,i=e+(o<<11&4294967295|o>>>21),o=s+(i^e^n)+r[7]+4139469664&4294967295,s=i+(o<<16&4294967295|o>>>16),o=n+(s^i^e)+r[10]+3200236656&4294967295,n=s+(o<<23&4294967295|o>>>9),o=e+(n^s^i)+r[13]+681279174&4294967295,e=n+(o<<4&4294967295|o>>>28),o=i+(e^n^s)+r[0]+3936430074&4294967295,i=e+(o<<11&4294967295|o>>>21),o=s+(i^e^n)+r[3]+3572445317&4294967295,s=i+(o<<16&4294967295|o>>>16),o=n+(s^i^e)+r[6]+76029189&4294967295,n=s+(o<<23&4294967295|o>>>9),o=e+(n^s^i)+r[9]+3654602809&4294967295,e=n+(o<<4&4294967295|o>>>28),o=i+(e^n^s)+r[12]+3873151461&4294967295,i=e+(o<<11&4294967295|o>>>21),o=s+(i^e^n)+r[15]+530742520&4294967295,s=i+(o<<16&4294967295|o>>>16),o=n+(s^i^e)+r[2]+3299628645&4294967295,n=s+(o<<23&4294967295|o>>>9),o=e+(s^(n|~i))+r[0]+4096336452&4294967295,e=n+(o<<6&4294967295|o>>>26),o=i+(n^(e|~s))+r[7]+1126891415&4294967295,i=e+(o<<10&4294967295|o>>>22),o=s+(e^(i|~n))+r[14]+2878612391&4294967295,s=i+(o<<15&4294967295|o>>>17),o=n+(i^(s|~e))+r[5]+4237533241&4294967295,n=s+(o<<21&4294967295|o>>>11),o=e+(s^(n|~i))+r[12]+1700485571&4294967295,e=n+(o<<6&4294967295|o>>>26),o=i+(n^(e|~s))+r[3]+2399980690&4294967295,i=e+(o<<10&4294967295|o>>>22),o=s+(e^(i|~n))+r[10]+4293915773&4294967295,s=i+(o<<15&4294967295|o>>>17),o=n+(i^(s|~e))+r[1]+2240044497&4294967295,n=s+(o<<21&4294967295|o>>>11),o=e+(s^(n|~i))+r[8]+1873313359&4294967295,e=n+(o<<6&4294967295|o>>>26),o=i+(n^(e|~s))+r[15]+4264355552&4294967295,i=e+(o<<10&4294967295|o>>>22),o=s+(e^(i|~n))+r[6]+2734768916&4294967295,s=i+(o<<15&4294967295|o>>>17),o=n+(i^(s|~e))+r[13]+1309151649&4294967295,n=s+(o<<21&4294967295|o>>>11),o=e+(s^(n|~i))+r[4]+4149444226&4294967295,e=n+(o<<6&4294967295|o>>>26),o=i+(n^(e|~s))+r[11]+3174756917&4294967295,i=e+(o<<10&4294967295|o>>>22),o=s+(e^(i|~n))+r[2]+718787259&4294967295,s=i+(o<<15&4294967295|o>>>17),o=n+(i^(s|~e))+r[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(s+(o<<21&4294967295|o>>>11))&4294967295,t.g[2]=t.g[2]+s&4294967295,t.g[3]=t.g[3]+i&4294967295}sn.prototype.j=function(t,e){e===void 0&&(e=t.length);for(var n=e-this.blockSize,r=this.m,s=this.h,i=0;i<e;){if(s==0)for(;i<=n;)Kl(this,t,i),i+=this.blockSize;if(typeof t=="string"){for(;i<e;)if(r[s++]=t.charCodeAt(i++),s==this.blockSize){Kl(this,r),s=0;break}}else for(;i<e;)if(r[s++]=t[i++],s==this.blockSize){Kl(this,r),s=0;break}}this.h=s,this.i+=e};sn.prototype.l=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var n=8*this.i;for(e=t.length-8;e<t.length;++e)t[e]=n&255,n/=256;for(this.j(t),t=Array(16),e=n=0;4>e;++e)for(var r=0;32>r;r+=8)t[n++]=this.g[e]>>>r&255;return t};function Ee(t,e){this.h=e;for(var n=[],r=!0,s=t.length-1;0<=s;s--){var i=t[s]|0;r&&i==e||(n[s]=i,r=!1)}this.g=n}var JR={};function Jh(t){return-128<=t&&128>t?iR(t,function(e){return new Ee([e|0],0>e?-1:0)}):new Ee([t|0],0>t?-1:0)}function gn(t){if(isNaN(t)||!isFinite(t))return Bs;if(0>t)return ot(gn(-t));for(var e=[],n=1,r=0;t>=n;r++)e[r]=t/n|0,n*=xu;return new Ee(e,0)}function Ay(t,e){if(t.length==0)throw Error("number format error: empty string");if(e=e||10,2>e||36<e)throw Error("radix out of range: "+e);if(t.charAt(0)=="-")return ot(Ay(t.substring(1),e));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var n=gn(Math.pow(e,8)),r=Bs,s=0;s<t.length;s+=8){var i=Math.min(8,t.length-s),o=parseInt(t.substring(s,s+i),e);8>i?(i=gn(Math.pow(e,i)),r=r.R(i).add(gn(o))):(r=r.R(n),r=r.add(gn(o)))}return r}var xu=4294967296,Bs=Jh(0),Du=Jh(1),vm=Jh(16777216);F=Ee.prototype;F.ea=function(){if(qt(this))return-ot(this).ea();for(var t=0,e=1,n=0;n<this.g.length;n++){var r=this.D(n);t+=(0<=r?r:xu+r)*e,e*=xu}return t};F.toString=function(t){if(t=t||10,2>t||36<t)throw Error("radix out of range: "+t);if(xn(this))return"0";if(qt(this))return"-"+ot(this).toString(t);for(var e=gn(Math.pow(t,6)),n=this,r="";;){var s=sc(n,e).g;n=rc(n,s.R(e));var i=((0<n.g.length?n.g[0]:n.h)>>>0).toString(t);if(n=s,xn(n))return i+r;for(;6>i.length;)i="0"+i;r=i+r}};F.D=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h};function xn(t){if(t.h!=0)return!1;for(var e=0;e<t.g.length;e++)if(t.g[e]!=0)return!1;return!0}function qt(t){return t.h==-1}F.X=function(t){return t=rc(this,t),qt(t)?-1:xn(t)?0:1};function ot(t){for(var e=t.g.length,n=[],r=0;r<e;r++)n[r]=~t.g[r];return new Ee(n,~t.h).add(Du)}F.abs=function(){return qt(this)?ot(this):this};F.add=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0,s=0;s<=e;s++){var i=r+(this.D(s)&65535)+(t.D(s)&65535),o=(i>>>16)+(this.D(s)>>>16)+(t.D(s)>>>16);r=o>>>16,i&=65535,o&=65535,n[s]=o<<16|i}return new Ee(n,n[n.length-1]&-2147483648?-1:0)};function rc(t,e){return t.add(ot(e))}F.R=function(t){if(xn(this)||xn(t))return Bs;if(qt(this))return qt(t)?ot(this).R(ot(t)):ot(ot(this).R(t));if(qt(t))return ot(this.R(ot(t)));if(0>this.X(vm)&&0>t.X(vm))return gn(this.ea()*t.ea());for(var e=this.g.length+t.g.length,n=[],r=0;r<2*e;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var s=0;s<t.g.length;s++){var i=this.D(r)>>>16,o=this.D(r)&65535,a=t.D(s)>>>16,c=t.D(s)&65535;n[2*r+2*s]+=o*c,ya(n,2*r+2*s),n[2*r+2*s+1]+=i*c,ya(n,2*r+2*s+1),n[2*r+2*s+1]+=o*a,ya(n,2*r+2*s+1),n[2*r+2*s+2]+=i*a,ya(n,2*r+2*s+2)}for(r=0;r<e;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=e;r<2*e;r++)n[r]=0;return new Ee(n,0)};function ya(t,e){for(;(t[e]&65535)!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function Vi(t,e){this.g=t,this.h=e}function sc(t,e){if(xn(e))throw Error("division by zero");if(xn(t))return new Vi(Bs,Bs);if(qt(t))return e=sc(ot(t),e),new Vi(ot(e.g),ot(e.h));if(qt(e))return e=sc(t,ot(e)),new Vi(ot(e.g),e.h);if(30<t.g.length){if(qt(t)||qt(e))throw Error("slowDivide_ only works with positive integers.");for(var n=Du,r=e;0>=r.X(t);)n=Tm(n),r=Tm(r);var s=Is(n,1),i=Is(r,1);for(r=Is(r,2),n=Is(n,2);!xn(r);){var o=i.add(r);0>=o.X(t)&&(s=s.add(n),i=o),r=Is(r,1),n=Is(n,1)}return e=rc(t,s.R(e)),new Vi(s,e)}for(s=Bs;0<=t.X(e);){for(n=Math.max(1,Math.floor(t.ea()/e.ea())),r=Math.ceil(Math.log(n)/Math.LN2),r=48>=r?1:Math.pow(2,r-48),i=gn(n),o=i.R(e);qt(o)||0<o.X(t);)n-=r,i=gn(n),o=i.R(e);xn(i)&&(i=Du),s=s.add(i),t=rc(t,o)}return new Vi(s,t)}F.gb=function(t){return sc(this,t).h};F.and=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)&t.D(r);return new Ee(n,this.h&t.h)};F.or=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)|t.D(r);return new Ee(n,this.h|t.h)};F.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)^t.D(r);return new Ee(n,this.h^t.h)};function Tm(t){for(var e=t.g.length+1,n=[],r=0;r<e;r++)n[r]=t.D(r)<<1|t.D(r-1)>>>31;return new Ee(n,t.h)}function Is(t,e){var n=e>>5;e%=32;for(var r=t.g.length-n,s=[],i=0;i<r;i++)s[i]=0<e?t.D(i+n)>>>e|t.D(i+n+1)<<32-e:t.D(i+n);return new Ee(s,t.h)}nc.prototype.createWebChannel=nc.prototype.g;Lt.prototype.send=Lt.prototype.u;Lt.prototype.open=Lt.prototype.m;Lt.prototype.close=Lt.prototype.close;zc.NO_ERROR=0;zc.TIMEOUT=8;zc.HTTP_ERROR=6;q_.COMPLETE="complete";j_.EventType=$o;$o.OPEN="a";$o.CLOSE="b";$o.ERROR="c";$o.MESSAGE="d";tt.prototype.listen=tt.prototype.O;$e.prototype.listenOnce=$e.prototype.P;$e.prototype.getLastError=$e.prototype.Sa;$e.prototype.getLastErrorCode=$e.prototype.Ia;$e.prototype.getStatus=$e.prototype.da;$e.prototype.getResponseJson=$e.prototype.Wa;$e.prototype.getResponseText=$e.prototype.ja;$e.prototype.send=$e.prototype.ha;$e.prototype.setWithCredentials=$e.prototype.Oa;sn.prototype.digest=sn.prototype.l;sn.prototype.reset=sn.prototype.reset;sn.prototype.update=sn.prototype.j;Ee.prototype.add=Ee.prototype.add;Ee.prototype.multiply=Ee.prototype.R;Ee.prototype.modulo=Ee.prototype.gb;Ee.prototype.compare=Ee.prototype.X;Ee.prototype.toNumber=Ee.prototype.ea;Ee.prototype.toString=Ee.prototype.toString;Ee.prototype.getBits=Ee.prototype.D;Ee.fromNumber=gn;Ee.fromString=Ay;var XR=function(){return new nc},ZR=function(){return jc()},Gl=zc,eP=q_,tP=hs,bm={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},nP=zo,wa=j_,rP=$e,sP=sn,Us=Ee;const Am="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ze{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Ze.UNAUTHENTICATED=new Ze(null),Ze.GOOGLE_CREDENTIALS=new Ze("google-credentials-uid"),Ze.FIRST_PARTY=new Ze("first-party-uid"),Ze.MOCK_USER=new Ze("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let wi="10.11.1";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cr=new Rh("@firebase/firestore");function Ss(){return cr.logLevel}function iP(t){cr.setLogLevel(t)}function S(t,...e){if(cr.logLevel<=le.DEBUG){const n=e.map(Xh);cr.debug(`Firestore (${wi}): ${t}`,...n)}}function je(t,...e){if(cr.logLevel<=le.ERROR){const n=e.map(Xh);cr.error(`Firestore (${wi}): ${t}`,...n)}}function on(t,...e){if(cr.logLevel<=le.WARN){const n=e.map(Xh);cr.warn(`Firestore (${wi}): ${t}`,...n)}}function Xh(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $(t="Unexpected state"){const e=`FIRESTORE (${wi}) INTERNAL ASSERTION FAILED: `+t;throw je(e),new Error(e)}function z(t,e){t||$()}function oP(t,e){t||$()}function M(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class P extends yr{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class et{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ry{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class aP{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Ze.UNAUTHENTICATED))}shutdown(){}}class cP{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class lP{constructor(e){this.t=e,this.currentUser=Ze.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){let r=this.i;const s=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve();let i=new et;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new et,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const c=i;e.enqueueRetryable(async()=>{await c.promise,await s(this.currentUser)})},a=c=>{S("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?a(c):(S("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new et)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(S("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(z(typeof r.accessToken=="string"),new Ry(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return z(e===null||typeof e=="string"),new Ze(e)}}class uP{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=Ze.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class hP{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new uP(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(Ze.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class dP{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class fP{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){const r=i=>{i.error!=null&&S("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.R;return this.R=i.token,S("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{S("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):S("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(z(typeof n.token=="string"),this.R=n.token,new dP(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mP(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Py{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=mP(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%e.length))}return r}}function ee(t,e){return t<e?-1:t>e?1:0}function ei(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}function Sy(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oe{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new P(E.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new P(E.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new P(E.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new P(E.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Oe.fromMillis(Date.now())}static fromDate(e){return Oe.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new Oe(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ee(this.nanoseconds,e.nanoseconds):ee(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K{constructor(e){this.timestamp=e}static fromTimestamp(e){return new K(e)}static min(){return new K(new Oe(0,0))}static max(){return new K(new Oe(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bo{constructor(e,n,r){n===void 0?n=0:n>e.length&&$(),r===void 0?r=e.length-n:r>e.length-n&&$(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return bo.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof bo?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=e.get(s),o=n.get(s);if(i<o)return-1;if(i>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class ae extends bo{construct(e,n,r){return new ae(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new P(E.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new ae(n)}static emptyPath(){return new ae([])}}const pP=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ve extends bo{construct(e,n,r){return new Ve(e,n,r)}static isValidIdentifier(e){return pP.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ve.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Ve(["__name__"])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new P(E.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const a=e[s];if(a==="\\"){if(s+1===e.length)throw new P(E.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[s+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new P(E.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(r+=a,s++):(i(),s++)}if(i(),o)throw new P(E.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ve(n)}static emptyPath(){return new Ve([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N{constructor(e){this.path=e}static fromPath(e){return new N(ae.fromString(e))}static fromName(e){return new N(ae.fromString(e).popFirst(5))}static empty(){return new N(ae.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ae.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return ae.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new N(new ae(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ic{constructor(e,n,r,s){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=s}}function ku(t){return t.fields.find(e=>e.kind===2)}function Nr(t){return t.fields.filter(e=>e.kind!==2)}ic.UNKNOWN_ID=-1;class Oa{constructor(e,n){this.fieldPath=e,this.kind=n}}class Ao{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new Ao(0,Bt.min())}}function Cy(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=K.fromTimestamp(r===1e9?new Oe(n+1,0):new Oe(n,r));return new Bt(s,N.empty(),e)}function xy(t){return new Bt(t.readTime,t.key,-1)}class Bt{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Bt(K.min(),N.empty(),-1)}static max(){return new Bt(K.max(),N.empty(),-1)}}function Zh(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=N.comparator(t.documentKey,e.documentKey),n!==0?n:ee(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dy="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class ky{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ir(t){if(t.code!==E.FAILED_PRECONDITION||t.message!==Dy)throw t;S("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&$(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new _((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof _?n:_.resolve(n)}catch(n){return _.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):_.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):_.reject(n)}static resolve(e){return new _((n,r)=>{n(e)})}static reject(e){return new _((n,r)=>{r(e)})}static waitFor(e){return new _((n,r)=>{let s=0,i=0,o=!1;e.forEach(a=>{++s,a.next(()=>{++i,o&&i===s&&n()},c=>r(c))}),o=!0,i===s&&n()})}static or(e){let n=_.resolve(!1);for(const r of e)n=n.next(s=>s?_.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new _((r,s)=>{const i=e.length,o=new Array(i);let a=0;for(let c=0;c<i;c++){const l=c;n(e[l]).next(u=>{o[l]=u,++a,a===i&&r(o)},u=>s(u))}})}static doWhile(e,n){return new _((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xc{constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.V=new et,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{n.error?this.V.reject(new Ji(e,n.error)):this.V.resolve()},this.transaction.onerror=r=>{const s=ed(r.target.error);this.V.reject(new Ji(e,s))}}static open(e,n,r,s){try{return new Xc(n,e.transaction(s,r))}catch(i){throw new Ji(n,i)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(S("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new _P(n)}}class En{constructor(e,n,r){this.name=e,this.version=n,this.p=r,En.S(Ja())===12.2&&je("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return S("SimpleDb","Removing database:",e),Lr(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!l_())return!1;if(En.C())return!0;const e=Ja(),n=En.S(e),r=0<n&&n<10,s=Vy(e),i=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||i)}static C(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.v)==="YES"}static F(e,n){return e.store(n)}static S(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}async M(e){return this.db||(S("SimpleDb","Opening database:",this.name),this.db=await new Promise((n,r)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=i=>{const o=i.target.result;n(o)},s.onblocked=()=>{r(new Ji(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=i=>{const o=i.target.error;o.name==="VersionError"?r(new P(E.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new P(E.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new Ji(e,o))},s.onupgradeneeded=i=>{S("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',i.oldVersion);const o=i.target.result;this.p.O(o,s.transaction,i.oldVersion,this.version).next(()=>{S("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=n=>this.N(n)),this.db}L(e){this.N=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,s){const i=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.M(e);const a=Xc.open(this.db,e,i?"readonly":"readwrite",r),c=s(a).next(l=>(a.g(),l)).catch(l=>(a.abort(l),_.reject(l))).toPromise();return c.catch(()=>{}),await a.m,c}catch(a){const c=a,l=c.name!=="FirebaseError"&&o<3;if(S("SimpleDb","Transaction failed with error:",c.message,"Retrying:",l),this.close(),!l)return Promise.reject(c)}}}close(){this.db&&this.db.close(),this.db=void 0}}function Vy(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class gP{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return Lr(this.B.delete())}}class Ji extends P{constructor(e,n){super(E.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function vr(t){return t.name==="IndexedDbTransactionError"}class _P{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(S("SimpleDb","PUT",this.store.name,e,n),r=this.store.put(n,e)):(S("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Lr(r)}add(e){return S("SimpleDb","ADD",this.store.name,e,e),Lr(this.store.add(e))}get(e){return Lr(this.store.get(e)).next(n=>(n===void 0&&(n=null),S("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return S("SimpleDb","DELETE",this.store.name,e),Lr(this.store.delete(e))}count(){return S("SimpleDb","COUNT",this.store.name),Lr(this.store.count())}U(e,n){const r=this.options(e,n),s=r.index?this.store.index(r.index):this.store;if(typeof s.getAll=="function"){const i=s.getAll(r.range);return new _((o,a)=>{i.onerror=c=>{a(c.target.error)},i.onsuccess=c=>{o(c.target.result)}})}{const i=this.cursor(r),o=[];return this.W(i,(a,c)=>{o.push(c)}).next(()=>o)}}G(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new _((s,i)=>{r.onerror=o=>{i(o.target.error)},r.onsuccess=o=>{s(o.target.result)}})}j(e,n){S("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,n);r.H=!1;const s=this.cursor(r);return this.W(s,(i,o,a)=>a.delete())}J(e,n){let r;n?r=e:(r={},n=e);const s=this.cursor(r);return this.W(s,n)}Y(e){const n=this.cursor({});return new _((r,s)=>{n.onerror=i=>{const o=ed(i.target.error);s(o)},n.onsuccess=i=>{const o=i.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}W(e,n){const r=[];return new _((s,i)=>{e.onerror=o=>{i(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void s();const c=new gP(a),l=n(a.primaryKey,a.value,c);if(l instanceof _){const u=l.catch(h=>(c.done(),_.reject(h)));r.push(u)}c.isDone?s():c.K===null?a.continue():a.continue(c.K)}}).next(()=>_.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function Lr(t){return new _((e,n)=>{t.onsuccess=r=>{const s=r.target.result;e(s)},t.onerror=r=>{const s=ed(r.target.error);n(s)}})}let Rm=!1;function ed(t){const e=En.S(Ja());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new P("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Rm||(Rm=!0,setTimeout(()=>{throw r},0)),r}}return t}class yP{constructor(e,n){this.asyncQueue=e,this.Z=n,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){S("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{S("IndexBackfiller",`Documents written: ${await this.Z.ee()}`)}catch(n){vr(n)?S("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",n):await Ir(n)}await this.X(6e4)})}}class wP{constructor(e,n){this.localStore=e,this.persistence=n}async ee(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.te(n,e))}te(e,n){const r=new Set;let s=n,i=!0;return _.doWhile(()=>i===!0&&s>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return S("IndexBackfiller",`Processing collection: ${o}`),this.ne(e,o,s).next(a=>{s-=a,r.add(o)});i=!1})).next(()=>n-s)}ne(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(s=>this.localStore.localDocuments.getNextDocuments(e,n,s,r).next(i=>{const o=i.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.re(s,i)).next(a=>(S("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}re(e,n){let r=e;return n.changes.forEach((s,i)=>{const o=xy(i);Zh(o,r)>0&&(r=o)}),new Bt(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kt{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}kt.oe=-1;function Ho(t){return t==null}function Ro(t){return t===0&&1/t==-1/0}function Ny(t){return typeof t=="number"&&Number.isInteger(t)&&!Ro(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bt(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=Pm(e)),e=EP(t.get(n),e);return Pm(e)}function EP(t,e){let n=e;const r=t.length;for(let s=0;s<r;s++){const i=t.charAt(s);switch(i){case"\0":n+="";break;case"":n+="";break;default:n+=i}}return n}function Pm(t){return t+""}function _n(t){const e=t.length;if(z(e>=2),e===2)return z(t.charAt(0)===""&&t.charAt(1)===""),ae.emptyPath();const n=e-2,r=[];let s="";for(let i=0;i<e;){const o=t.indexOf("",i);switch((o<0||o>n)&&$(),t.charAt(o+1)){case"":const a=t.substring(i,o);let c;s.length===0?c=a:(s+=a,c=s,s=""),r.push(c);break;case"":s+=t.substring(i,o),s+="\0";break;case"":s+=t.substring(i,o+1);break;default:$()}i=o+2}return new ae(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sm=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ma(t,e){return[t,bt(e)]}function Oy(t,e,n){return[t,bt(e),n]}const IP={},vP=["prefixPath","collectionGroup","readTime","documentId"],TP=["prefixPath","collectionGroup","documentId"],bP=["collectionGroup","readTime","prefixPath","documentId"],AP=["canonicalId","targetId"],RP=["targetId","path"],PP=["path","targetId"],SP=["collectionId","parent"],CP=["indexId","uid"],xP=["uid","sequenceNumber"],DP=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],kP=["indexId","uid","orderedDocumentKey"],VP=["userId","collectionPath","documentId"],NP=["userId","collectionPath","largestBatchId"],OP=["userId","collectionGroup","largestBatchId"],My=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],MP=[...My,"documentOverlays"],Fy=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],Ly=Fy,By=[...Ly,"indexConfiguration","indexState","indexEntries"],FP=By;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vu extends ky{constructor(e,n){super(),this._e=e,this.currentSequenceNumber=n}}function rt(t,e){const n=M(t);return En.F(n._e,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cm(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function ds(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Uy(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Se{constructor(e,n){this.comparator=e,this.root=n||it.EMPTY}insert(e,n){return new Se(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,it.BLACK,null,null))}remove(e){return new Se(this.comparator,this.root.remove(e,this.comparator).copy(null,null,it.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ea(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ea(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ea(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ea(this.root,e,this.comparator,!0)}}class Ea{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class it{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??it.RED,this.left=s??it.EMPTY,this.right=i??it.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new it(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return it.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return it.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,it.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,it.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw $();const e=this.left.check();if(e!==this.right.check())throw $();return e+(this.isRed()?0:1)}}it.EMPTY=null,it.RED=!0,it.BLACK=!1;it.EMPTY=new class{constructor(){this.size=0}get key(){throw $()}get value(){throw $()}get color(){throw $()}get left(){throw $()}get right(){throw $()}copy(e,n,r,s,i){return this}insert(e,n,r){return new it(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Te{constructor(e){this.comparator=e,this.data=new Se(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new xm(this.data.getIterator())}getIteratorFrom(e){return new xm(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Te)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Te(this.comparator);return n.data=e,n}}class xm{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function vs(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vt{constructor(e){this.fields=e,e.sort(Ve.comparator)}static empty(){return new Vt([])}unionWith(e){let n=new Te(Ve.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Vt(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return ei(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $y extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LP(){return typeof atob<"u"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Je{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new $y("Invalid base64 string: "+i):i}}(e);return new Je(n)}static fromUint8Array(e){const n=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new Je(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ee(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Je.EMPTY_BYTE_STRING=new Je("");const BP=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Fn(t){if(z(!!t),typeof t=="string"){let e=0;const n=BP.exec(t);if(z(!!n),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Ue(t.seconds),nanos:Ue(t.nanos)}}function Ue(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function lr(t){return typeof t=="string"?Je.fromBase64String(t):Je.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zc(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function td(t){const e=t.mapValue.fields.__previous_value__;return Zc(e)?td(e):e}function Po(t){const e=Fn(t.mapValue.fields.__local_write_time__.timestampValue);return new Oe(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UP{constructor(e,n,r,s,i,o,a,c,l){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=l}}class ur{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new ur("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof ur&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const er={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Fa={nullValue:"NULL_VALUE"};function ts(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Zc(t)?4:qy(t)?9007199254740991:10:$()}function bn(t,e){if(t===e)return!0;const n=ts(t);if(n!==ts(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Po(t).isEqual(Po(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=Fn(s.timestampValue),a=Fn(i.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return lr(s.bytesValue).isEqual(lr(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return Ue(s.geoPointValue.latitude)===Ue(i.geoPointValue.latitude)&&Ue(s.geoPointValue.longitude)===Ue(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return Ue(s.integerValue)===Ue(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=Ue(s.doubleValue),a=Ue(i.doubleValue);return o===a?Ro(o)===Ro(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return ei(t.arrayValue.values||[],e.arrayValue.values||[],bn);case 10:return function(s,i){const o=s.mapValue.fields||{},a=i.mapValue.fields||{};if(Cm(o)!==Cm(a))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(a[c]===void 0||!bn(o[c],a[c])))return!1;return!0}(t,e);default:return $()}}function So(t,e){return(t.values||[]).find(n=>bn(n,e))!==void 0}function hr(t,e){if(t===e)return 0;const n=ts(t),r=ts(e);if(n!==r)return ee(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return ee(t.booleanValue,e.booleanValue);case 2:return function(i,o){const a=Ue(i.integerValue||i.doubleValue),c=Ue(o.integerValue||o.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1}(t,e);case 3:return Dm(t.timestampValue,e.timestampValue);case 4:return Dm(Po(t),Po(e));case 5:return ee(t.stringValue,e.stringValue);case 6:return function(i,o){const a=lr(i),c=lr(o);return a.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const a=i.split("/"),c=o.split("/");for(let l=0;l<a.length&&l<c.length;l++){const u=ee(a[l],c[l]);if(u!==0)return u}return ee(a.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const a=ee(Ue(i.latitude),Ue(o.latitude));return a!==0?a:ee(Ue(i.longitude),Ue(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(i,o){const a=i.values||[],c=o.values||[];for(let l=0;l<a.length&&l<c.length;++l){const u=hr(a[l],c[l]);if(u)return u}return ee(a.length,c.length)}(t.arrayValue,e.arrayValue);case 10:return function(i,o){if(i===er.mapValue&&o===er.mapValue)return 0;if(i===er.mapValue)return 1;if(o===er.mapValue)return-1;const a=i.fields||{},c=Object.keys(a),l=o.fields||{},u=Object.keys(l);c.sort(),u.sort();for(let h=0;h<c.length&&h<u.length;++h){const d=ee(c[h],u[h]);if(d!==0)return d;const f=hr(a[c[h]],l[u[h]]);if(f!==0)return f}return ee(c.length,u.length)}(t.mapValue,e.mapValue);default:throw $()}}function Dm(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return ee(t,e);const n=Fn(t),r=Fn(e),s=ee(n.seconds,r.seconds);return s!==0?s:ee(n.nanos,r.nanos)}function ti(t){return Nu(t)}function Nu(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Fn(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return lr(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return N.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=Nu(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${Nu(n.fields[o])}`;return s+"}"}(t.mapValue):$()}function ns(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Ou(t){return!!t&&"integerValue"in t}function Co(t){return!!t&&"arrayValue"in t}function km(t){return!!t&&"nullValue"in t}function Vm(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function La(t){return!!t&&"mapValue"in t}function Xi(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return ds(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Xi(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Xi(t.arrayValue.values[n]);return e}return Object.assign({},t)}function qy(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}function $P(t){return"nullValue"in t?Fa:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?ns(ur.empty(),N.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?{mapValue:{}}:$()}function qP(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?ns(ur.empty(),N.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?{mapValue:{}}:"mapValue"in t?er:$()}function Nm(t,e){const n=hr(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function Om(t,e){const n=hr(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class at{constructor(e){this.value=e}static empty(){return new at({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!La(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Xi(n)}setAll(e){let n=Ve.emptyPath(),r={},s=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const c=this.getFieldsMap(n);this.applyChanges(c,r,s),r={},s=[],n=a.popLast()}o?r[a.lastSegment()]=Xi(o):s.push(a.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());La(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return bn(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];La(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){ds(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new at(Xi(this.value))}}function jy(t){const e=[];return ds(t.fields,(n,r)=>{const s=new Ve([n]);if(La(r)){const i=jy(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new Vt(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class De{constructor(e,n,r,s,i,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=a}static newInvalidDocument(e){return new De(e,0,K.min(),K.min(),K.min(),at.empty(),0)}static newFoundDocument(e,n,r,s){return new De(e,1,n,K.min(),r,s,0)}static newNoDocument(e,n){return new De(e,2,n,K.min(),K.min(),at.empty(),0)}static newUnknownDocument(e,n){return new De(e,3,n,K.min(),K.min(),at.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(K.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=at.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=at.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=K.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof De&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new De(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dr{constructor(e,n){this.position=e,this.inclusive=n}}function Mm(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=N.comparator(N.fromName(o.referenceValue),n.key):r=hr(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function Fm(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!bn(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xo{constructor(e,n="asc"){this.field=e,this.dir=n}}function jP(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zy{}class ce extends zy{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new zP(e,n,r):n==="array-contains"?new HP(e,r):n==="in"?new Yy(e,r):n==="not-in"?new WP(e,r):n==="array-contains-any"?new QP(e,r):new ce(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new KP(e,r):new GP(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(hr(n,this.value)):n!==null&&ts(this.value)===ts(n)&&this.matchesComparison(hr(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return $()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class we extends zy{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new we(e,n)}matches(e){return ni(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function ni(t){return t.op==="and"}function Mu(t){return t.op==="or"}function nd(t){return Ky(t)&&ni(t)}function Ky(t){for(const e of t.filters)if(e instanceof we)return!1;return!0}function Fu(t){if(t instanceof ce)return t.field.canonicalString()+t.op.toString()+ti(t.value);if(nd(t))return t.filters.map(e=>Fu(e)).join(",");{const e=t.filters.map(n=>Fu(n)).join(",");return`${t.op}(${e})`}}function Gy(t,e){return t instanceof ce?function(r,s){return s instanceof ce&&r.op===s.op&&r.field.isEqual(s.field)&&bn(r.value,s.value)}(t,e):t instanceof we?function(r,s){return s instanceof we&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,a)=>i&&Gy(o,s.filters[a]),!0):!1}(t,e):void $()}function Hy(t,e){const n=t.filters.concat(e);return we.create(n,t.op)}function Wy(t){return t instanceof ce?function(n){return`${n.field.canonicalString()} ${n.op} ${ti(n.value)}`}(t):t instanceof we?function(n){return n.op.toString()+" {"+n.getFilters().map(Wy).join(" ,")+"}"}(t):"Filter"}class zP extends ce{constructor(e,n,r){super(e,n,r),this.key=N.fromName(r.referenceValue)}matches(e){const n=N.comparator(e.key,this.key);return this.matchesComparison(n)}}class KP extends ce{constructor(e,n){super(e,"in",n),this.keys=Qy("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class GP extends ce{constructor(e,n){super(e,"not-in",n),this.keys=Qy("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function Qy(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>N.fromName(r.referenceValue))}class HP extends ce{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Co(n)&&So(n.arrayValue,this.value)}}class Yy extends ce{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&So(this.value.arrayValue,n)}}class WP extends ce{constructor(e,n){super(e,"not-in",n)}matches(e){if(So(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!So(this.value.arrayValue,n)}}class QP extends ce{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Co(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>So(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YP{constructor(e,n=null,r=[],s=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=a,this.ue=null}}function Lu(t,e=null,n=[],r=[],s=null,i=null,o=null){return new YP(t,e,n,r,s,i,o)}function rs(t){const e=M(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Fu(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),Ho(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>ti(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>ti(r)).join(",")),e.ue=n}return e.ue}function Wo(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!jP(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!Gy(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Fm(t.startAt,e.startAt)&&Fm(t.endAt,e.endAt)}function oc(t){return N.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function ac(t,e){return t.filters.filter(n=>n instanceof ce&&n.field.isEqual(e))}function Lm(t,e,n){let r=Fa,s=!0;for(const i of ac(t,e)){let o=Fa,a=!0;switch(i.op){case"<":case"<=":o=$P(i.value);break;case"==":case"in":case">=":o=i.value;break;case">":o=i.value,a=!1;break;case"!=":case"not-in":o=Fa}Nm({value:r,inclusive:s},{value:o,inclusive:a})<0&&(r=o,s=a)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];Nm({value:r,inclusive:s},{value:o,inclusive:n.inclusive})<0&&(r=o,s=n.inclusive);break}}return{value:r,inclusive:s}}function Bm(t,e,n){let r=er,s=!0;for(const i of ac(t,e)){let o=er,a=!0;switch(i.op){case">=":case">":o=qP(i.value),a=!1;break;case"==":case"in":case"<=":o=i.value;break;case"<":o=i.value,a=!1;break;case"!=":case"not-in":o=er}Om({value:r,inclusive:s},{value:o,inclusive:a})>0&&(r=o,s=a)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];Om({value:r,inclusive:s},{value:o,inclusive:n.inclusive})>0&&(r=o,s=n.inclusive);break}}return{value:r,inclusive:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Un{constructor(e,n=null,r=[],s=[],i=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function Jy(t,e,n,r,s,i,o,a){return new Un(t,e,n,r,s,i,o,a)}function Ei(t){return new Un(t)}function Um(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function rd(t){return t.collectionGroup!==null}function $s(t){const e=M(t);if(e.ce===null){e.ce=[];const n=new Set;for(const i of e.explicitOrderBy)e.ce.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Te(Ve.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(l=>{l.isInequality()&&(a=a.add(l.field))})}),a})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.ce.push(new xo(i,r))}),n.has(Ve.keyField().canonicalString())||e.ce.push(new xo(Ve.keyField(),r))}return e.ce}function At(t){const e=M(t);return e.le||(e.le=JP(e,$s(t))),e.le}function JP(t,e){if(t.limitType==="F")return Lu(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new xo(s.field,i)});const n=t.endAt?new dr(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new dr(t.startAt.position,t.startAt.inclusive):null;return Lu(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Bu(t,e){const n=t.filters.concat([e]);return new Un(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function cc(t,e,n){return new Un(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Qo(t,e){return Wo(At(t),At(e))&&t.limitType===e.limitType}function Xy(t){return`${rs(At(t))}|lt:${t.limitType}`}function Cs(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>Wy(s)).join(", ")}]`),Ho(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>ti(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>ti(s)).join(",")),`Target(${r})`}(At(t))}; limitType=${t.limitType})`}function Yo(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):N.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of $s(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(o,a,c){const l=Mm(o,a,c);return o.inclusive?l<=0:l<0}(r.startAt,$s(r),s)||r.endAt&&!function(o,a,c){const l=Mm(o,a,c);return o.inclusive?l>=0:l>0}(r.endAt,$s(r),s))}(t,e)}function Zy(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function ew(t){return(e,n)=>{let r=!1;for(const s of $s(t)){const i=XP(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function XP(t,e,n){const r=t.field.isKeyField()?N.comparator(e.key,n.key):function(i,o,a){const c=o.data.field(i),l=a.data.field(i);return c!==null&&l!==null?hr(c,l):$()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return $()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tr{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){ds(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return Uy(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZP=new Se(N.comparator);function Nt(){return ZP}const tw=new Se(N.comparator);function ji(...t){let e=tw;for(const n of t)e=e.insert(n.key,n);return e}function nw(t){let e=tw;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function yn(){return Zi()}function rw(){return Zi()}function Zi(){return new Tr(t=>t.toString(),(t,e)=>t.isEqual(e))}const eS=new Se(N.comparator),tS=new Te(N.comparator);function re(...t){let e=tS;for(const n of t)e=e.add(n);return e}const nS=new Te(ee);function sd(){return nS}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sw(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ro(e)?"-0":e}}function iw(t){return{integerValue:""+t}}function ow(t,e){return Ny(e)?iw(e):sw(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class el{constructor(){this._=void 0}}function rS(t,e,n){return t instanceof ri?function(s,i){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&Zc(i)&&(i=td(i)),i&&(o.fields.__previous_value__=i),{mapValue:o}}(n,e):t instanceof ss?cw(t,e):t instanceof is?lw(t,e):function(s,i){const o=aw(s,i),a=$m(o)+$m(s.Pe);return Ou(o)&&Ou(s.Pe)?iw(a):sw(s.serializer,a)}(t,e)}function sS(t,e,n){return t instanceof ss?cw(t,e):t instanceof is?lw(t,e):n}function aw(t,e){return t instanceof si?function(r){return Ou(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class ri extends el{}class ss extends el{constructor(e){super(),this.elements=e}}function cw(t,e){const n=uw(e);for(const r of t.elements)n.some(s=>bn(s,r))||n.push(r);return{arrayValue:{values:n}}}class is extends el{constructor(e){super(),this.elements=e}}function lw(t,e){let n=uw(e);for(const r of t.elements)n=n.filter(s=>!bn(s,r));return{arrayValue:{values:n}}}class si extends el{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function $m(t){return Ue(t.integerValue||t.doubleValue)}function uw(t){return Co(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jo{constructor(e,n){this.field=e,this.transform=n}}function iS(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof ss&&s instanceof ss||r instanceof is&&s instanceof is?ei(r.elements,s.elements,bn):r instanceof si&&s instanceof si?bn(r.Pe,s.Pe):r instanceof ri&&s instanceof ri}(t.transform,e.transform)}class oS{constructor(e,n){this.version=e,this.transformResults=n}}class Ne{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Ne}static exists(e){return new Ne(void 0,e)}static updateTime(e){return new Ne(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Ba(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class tl{}function hw(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new vi(t.key,Ne.none()):new Ii(t.key,t.data,Ne.none());{const n=t.data,r=at.empty();let s=new Te(Ve.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new $n(t.key,r,new Vt(s.toArray()),Ne.none())}}function aS(t,e,n){t instanceof Ii?function(s,i,o){const a=s.value.clone(),c=jm(s.fieldTransforms,i,o.transformResults);a.setAll(c),i.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof $n?function(s,i,o){if(!Ba(s.precondition,i))return void i.convertToUnknownDocument(o.version);const a=jm(s.fieldTransforms,i,o.transformResults),c=i.data;c.setAll(dw(s)),c.setAll(a),i.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,n):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function eo(t,e,n,r){return t instanceof Ii?function(i,o,a,c){if(!Ba(i.precondition,o))return a;const l=i.value.clone(),u=zm(i.fieldTransforms,c,o);return l.setAll(u),o.convertToFoundDocument(o.version,l).setHasLocalMutations(),null}(t,e,n,r):t instanceof $n?function(i,o,a,c){if(!Ba(i.precondition,o))return a;const l=zm(i.fieldTransforms,c,o),u=o.data;return u.setAll(dw(i)),u.setAll(l),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),a===null?null:a.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(h=>h.field))}(t,e,n,r):function(i,o,a){return Ba(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function cS(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=aw(r.transform,s||null);i!=null&&(n===null&&(n=at.empty()),n.set(r.field,i))}return n||null}function qm(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&ei(r,s,(i,o)=>iS(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Ii extends tl{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class $n extends tl{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function dw(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function jm(t,e,n){const r=new Map;z(t.length===n.length);for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,a=e.data.field(i.field);r.set(i.field,sS(o,a,n[s]))}return r}function zm(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,rS(i,o,e))}return r}class vi extends tl{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class id extends tl{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class od{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&aS(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=eo(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=eo(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=rw();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=n.has(s.key)?null:a;const c=hw(o,a);c!==null&&r.set(s.key,c),o.isValidDocument()||o.convertToNoDocument(K.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),re())}isEqual(e){return this.batchId===e.batchId&&ei(this.mutations,e.mutations,(n,r)=>qm(n,r))&&ei(this.baseMutations,e.baseMutations,(n,r)=>qm(n,r))}}class ad{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){z(e.mutations.length===r.length);let s=function(){return eS}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new ad(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cd{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lS{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var He,ue;function fw(t){switch(t){default:return $();case E.CANCELLED:case E.UNKNOWN:case E.DEADLINE_EXCEEDED:case E.RESOURCE_EXHAUSTED:case E.INTERNAL:case E.UNAVAILABLE:case E.UNAUTHENTICATED:return!1;case E.INVALID_ARGUMENT:case E.NOT_FOUND:case E.ALREADY_EXISTS:case E.PERMISSION_DENIED:case E.FAILED_PRECONDITION:case E.ABORTED:case E.OUT_OF_RANGE:case E.UNIMPLEMENTED:case E.DATA_LOSS:return!0}}function mw(t){if(t===void 0)return je("GRPC error has no .code"),E.UNKNOWN;switch(t){case He.OK:return E.OK;case He.CANCELLED:return E.CANCELLED;case He.UNKNOWN:return E.UNKNOWN;case He.DEADLINE_EXCEEDED:return E.DEADLINE_EXCEEDED;case He.RESOURCE_EXHAUSTED:return E.RESOURCE_EXHAUSTED;case He.INTERNAL:return E.INTERNAL;case He.UNAVAILABLE:return E.UNAVAILABLE;case He.UNAUTHENTICATED:return E.UNAUTHENTICATED;case He.INVALID_ARGUMENT:return E.INVALID_ARGUMENT;case He.NOT_FOUND:return E.NOT_FOUND;case He.ALREADY_EXISTS:return E.ALREADY_EXISTS;case He.PERMISSION_DENIED:return E.PERMISSION_DENIED;case He.FAILED_PRECONDITION:return E.FAILED_PRECONDITION;case He.ABORTED:return E.ABORTED;case He.OUT_OF_RANGE:return E.OUT_OF_RANGE;case He.UNIMPLEMENTED:return E.UNIMPLEMENTED;case He.DATA_LOSS:return E.DATA_LOSS;default:return $()}}(ue=He||(He={}))[ue.OK=0]="OK",ue[ue.CANCELLED=1]="CANCELLED",ue[ue.UNKNOWN=2]="UNKNOWN",ue[ue.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ue[ue.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ue[ue.NOT_FOUND=5]="NOT_FOUND",ue[ue.ALREADY_EXISTS=6]="ALREADY_EXISTS",ue[ue.PERMISSION_DENIED=7]="PERMISSION_DENIED",ue[ue.UNAUTHENTICATED=16]="UNAUTHENTICATED",ue[ue.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ue[ue.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ue[ue.ABORTED=10]="ABORTED",ue[ue.OUT_OF_RANGE=11]="OUT_OF_RANGE",ue[ue.UNIMPLEMENTED=12]="UNIMPLEMENTED",ue[ue.INTERNAL=13]="INTERNAL",ue[ue.UNAVAILABLE=14]="UNAVAILABLE",ue[ue.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pw(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uS=new Us([4294967295,4294967295],0);function Km(t){const e=pw().encode(t),n=new sP;return n.update(e),new Uint8Array(n.digest())}function Gm(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Us([n,r],0),new Us([s,i],0)]}class ld{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new zi(`Invalid padding: ${n}`);if(r<0)throw new zi(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new zi(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new zi(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=Us.fromNumber(this.Ie)}Ee(e,n,r){let s=e.add(n.multiply(Us.fromNumber(r)));return s.compare(uS)===1&&(s=new Us([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=Km(e),[r,s]=Gm(n);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);if(!this.de(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new ld(i,s,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Ie===0)return;const n=Km(e),[r,s]=Gm(n);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);this.Ae(o)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class zi extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xo{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,Zo.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Xo(K.min(),s,new Se(ee),Nt(),re())}}class Zo{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Zo(r,n,re(),re(),re())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ua{constructor(e,n,r,s){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=s}}class gw{constructor(e,n){this.targetId=e,this.me=n}}class _w{constructor(e,n,r=Je.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class Hm{constructor(){this.fe=0,this.ge=Qm(),this.pe=Je.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}Ce(){let e=re(),n=re(),r=re();return this.ge.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:$()}}),new Zo(this.pe,this.ye,e,n,r)}ve(){this.we=!1,this.ge=Qm()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,z(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class hS{constructor(e){this.Le=e,this.Be=new Map,this.ke=Nt(),this.qe=Wm(),this.Qe=new Se(ee)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.ve(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:$()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,s)=>{this.ze(s)&&n(s)})}He(e){const n=e.targetId,r=e.me.count,s=this.Je(n);if(s){const i=s.target;if(oc(i))if(r===0){const o=new N(i.path);this.Ue(n,o,De.newNoDocument(o,K.min()))}else z(r===1);else{const o=this.Ye(n);if(o!==r){const a=this.Ze(e),c=a?this.Xe(a,e,o):1;if(c!==0){this.je(n);const l=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,l)}}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let o,a;try{o=lr(r).toUint8Array()}catch(c){if(c instanceof $y)return on("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new ld(o,s,i)}catch(c){return on(c instanceof zi?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.Ie===0?null:a}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const o=this.Le.tt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(a)||(this.Ue(n,i,null),s++)}),s}rt(e){const n=new Map;this.Be.forEach((i,o)=>{const a=this.Je(o);if(a){if(i.current&&oc(a.target)){const c=new N(a.target.path);this.ke.get(c)!==null||this.it(o,c)||this.Ue(o,c,De.newNoDocument(c,e))}i.be&&(n.set(o,i.Ce()),i.ve())}});let r=re();this.qe.forEach((i,o)=>{let a=!0;o.forEachWhile(c=>{const l=this.Je(c);return!l||l.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(i))}),this.ke.forEach((i,o)=>o.setReadTime(e));const s=new Xo(e,n,this.Qe,this.ke,r);return this.ke=Nt(),this.qe=Wm(),this.Qe=new Se(ee),s}$e(e,n){if(!this.ze(e))return;const r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,n)?s.Fe(n,1):s.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).Ce();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new Hm,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new Te(ee),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||S("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Hm),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function Wm(){return new Se(N.comparator)}function Qm(){return new Se(N.comparator)}const dS=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),fS=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),mS=(()=>({and:"AND",or:"OR"}))();class pS{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Uu(t,e){return t.useProto3Json||Ho(e)?e:{value:e}}function ii(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function yw(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function gS(t,e){return ii(t,e.toTimestamp())}function ze(t){return z(!!t),K.fromTimestamp(function(n){const r=Fn(n);return new Oe(r.seconds,r.nanos)}(t))}function ud(t,e){return $u(t,e).canonicalString()}function $u(t,e){const n=function(s){return new ae(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function ww(t){const e=ae.fromString(t);return z(Cw(e)),e}function Do(t,e){return ud(t.databaseId,e.path)}function In(t,e){const n=ww(e);if(n.get(1)!==t.databaseId.projectId)throw new P(E.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new P(E.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new N(vw(n))}function Ew(t,e){return ud(t.databaseId,e)}function Iw(t){const e=ww(t);return e.length===4?ae.emptyPath():vw(e)}function qu(t){return new ae(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function vw(t){return z(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function Ym(t,e,n){return{name:Do(t,e),fields:n.value.mapValue.fields}}function Tw(t,e,n){const r=In(t,e.name),s=ze(e.updateTime),i=e.createTime?ze(e.createTime):K.min(),o=new at({mapValue:{fields:e.fields}}),a=De.newFoundDocument(r,s,i,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function _S(t,e){return"found"in e?function(r,s){z(!!s.found),s.found.name,s.found.updateTime;const i=In(r,s.found.name),o=ze(s.found.updateTime),a=s.found.createTime?ze(s.found.createTime):K.min(),c=new at({mapValue:{fields:s.found.fields}});return De.newFoundDocument(i,o,a,c)}(t,e):"missing"in e?function(r,s){z(!!s.missing),z(!!s.readTime);const i=In(r,s.missing),o=ze(s.readTime);return De.newNoDocument(i,o)}(t,e):$()}function yS(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:$()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(l,u){return l.useProto3Json?(z(u===void 0||typeof u=="string"),Je.fromBase64String(u||"")):(z(u===void 0||u instanceof Buffer||u instanceof Uint8Array),Je.fromUint8Array(u||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(l){const u=l.code===void 0?E.UNKNOWN:mw(l.code);return new P(u,l.message||"")}(o);n=new _w(r,s,i,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=In(t,r.document.name),i=ze(r.document.updateTime),o=r.document.createTime?ze(r.document.createTime):K.min(),a=new at({mapValue:{fields:r.document.fields}}),c=De.newFoundDocument(s,i,o,a),l=r.targetIds||[],u=r.removedTargetIds||[];n=new Ua(l,u,c.key,c)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=In(t,r.document),i=r.readTime?ze(r.readTime):K.min(),o=De.newNoDocument(s,i),a=r.removedTargetIds||[];n=new Ua([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=In(t,r.document),i=r.removedTargetIds||[];n=new Ua([],i,s,null)}else{if(!("filter"in e))return $();{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new lS(s,i),a=r.targetId;n=new gw(a,o)}}return n}function ko(t,e){let n;if(e instanceof Ii)n={update:Ym(t,e.key,e.value)};else if(e instanceof vi)n={delete:Do(t,e.key)};else if(e instanceof $n)n={update:Ym(t,e.key,e.data),updateMask:bS(e.fieldMask)};else{if(!(e instanceof id))return $();n={verify:Do(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const a=o.transform;if(a instanceof ri)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof ss)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof is)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof si)return{fieldPath:o.field.canonicalString(),increment:a.Pe};throw $()}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:gS(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:$()}(t,e.precondition)),n}function ju(t,e){const n=e.currentDocument?function(i){return i.updateTime!==void 0?Ne.updateTime(ze(i.updateTime)):i.exists!==void 0?Ne.exists(i.exists):Ne.none()}(e.currentDocument):Ne.none(),r=e.updateTransforms?e.updateTransforms.map(s=>function(o,a){let c=null;if("setToServerValue"in a)z(a.setToServerValue==="REQUEST_TIME"),c=new ri;else if("appendMissingElements"in a){const u=a.appendMissingElements.values||[];c=new ss(u)}else if("removeAllFromArray"in a){const u=a.removeAllFromArray.values||[];c=new is(u)}else"increment"in a?c=new si(o,a.increment):$();const l=Ve.fromServerFormat(a.fieldPath);return new Jo(l,c)}(t,s)):[];if(e.update){e.update.name;const s=In(t,e.update.name),i=new at({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(c){const l=c.fieldPaths||[];return new Vt(l.map(u=>Ve.fromServerFormat(u)))}(e.updateMask);return new $n(s,i,o,n,r)}return new Ii(s,i,n,r)}if(e.delete){const s=In(t,e.delete);return new vi(s,n)}if(e.verify){const s=In(t,e.verify);return new id(s,n)}return $()}function wS(t,e){return t&&t.length>0?(z(e!==void 0),t.map(n=>function(s,i){let o=s.updateTime?ze(s.updateTime):ze(i);return o.isEqual(K.min())&&(o=ze(i)),new oS(o,s.transformResults||[])}(n,e))):[]}function bw(t,e){return{documents:[Ew(t,e.path)]}}function Aw(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=Ew(t,s);const i=function(l){if(l.length!==0)return Sw(we.create(l,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(l){if(l.length!==0)return l.map(u=>function(d){return{field:xs(d.field),direction:IS(d.dir)}}(u))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const a=Uu(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(l){return{before:l.inclusive,values:l.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(e.endAt)),{_t:n,parent:s}}function Rw(t){let e=Iw(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){z(r===1);const u=n.from[0];u.allDescendants?s=u.collectionId:e=e.child(u.collectionId)}let i=[];n.where&&(i=function(h){const d=Pw(h);return d instanceof we&&nd(d)?d.getFilters():[d]}(n.where));let o=[];n.orderBy&&(o=function(h){return h.map(d=>function(y){return new xo(Ds(y.field),function(I){switch(I){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(y.direction))}(d))}(n.orderBy));let a=null;n.limit&&(a=function(h){let d;return d=typeof h=="object"?h.value:h,Ho(d)?null:d}(n.limit));let c=null;n.startAt&&(c=function(h){const d=!!h.before,f=h.values||[];return new dr(f,d)}(n.startAt));let l=null;return n.endAt&&(l=function(h){const d=!h.before,f=h.values||[];return new dr(f,d)}(n.endAt)),Jy(e,s,o,i,a,"F",c,l)}function ES(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return $()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function Pw(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Ds(n.unaryFilter.field);return ce.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Ds(n.unaryFilter.field);return ce.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Ds(n.unaryFilter.field);return ce.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Ds(n.unaryFilter.field);return ce.create(o,"!=",{nullValue:"NULL_VALUE"});default:return $()}}(t):t.fieldFilter!==void 0?function(n){return ce.create(Ds(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return $()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return we.create(n.compositeFilter.filters.map(r=>Pw(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return $()}}(n.compositeFilter.op))}(t):$()}function IS(t){return dS[t]}function vS(t){return fS[t]}function TS(t){return mS[t]}function xs(t){return{fieldPath:t.canonicalString()}}function Ds(t){return Ve.fromServerFormat(t.fieldPath)}function Sw(t){return t instanceof ce?function(n){if(n.op==="=="){if(Vm(n.value))return{unaryFilter:{field:xs(n.field),op:"IS_NAN"}};if(km(n.value))return{unaryFilter:{field:xs(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(Vm(n.value))return{unaryFilter:{field:xs(n.field),op:"IS_NOT_NAN"}};if(km(n.value))return{unaryFilter:{field:xs(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:xs(n.field),op:vS(n.op),value:n.value}}}(t):t instanceof we?function(n){const r=n.getFilters().map(s=>Sw(s));return r.length===1?r[0]:{compositeFilter:{op:TS(n.op),filters:r}}}(t):$()}function bS(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function Cw(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dn{constructor(e,n,r,s,i=K.min(),o=K.min(),a=Je.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new Dn(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Dn(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Dn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Dn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xw{constructor(e){this.ut=e}}function AS(t,e){let n;if(e.document)n=Tw(t.ut,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=N.fromSegments(e.noDocument.path),s=as(e.noDocument.readTime);n=De.newNoDocument(r,s),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return $();{const r=N.fromSegments(e.unknownDocument.path),s=as(e.unknownDocument.version);n=De.newUnknownDocument(r,s)}}return e.readTime&&n.setReadTime(function(s){const i=new Oe(s[0],s[1]);return K.fromTimestamp(i)}(e.readTime)),n}function Jm(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:lc(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(i,o){return{name:Do(i,o.key),fields:o.data.value.mapValue.fields,updateTime:ii(i,o.version.toTimestamp()),createTime:ii(i,o.createTime.toTimestamp())}}(t.ut,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:os(e.version)};else{if(!e.isUnknownDocument())return $();r.unknownDocument={path:n.path.toArray(),version:os(e.version)}}return r}function lc(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function os(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function as(t){const e=new Oe(t.seconds,t.nanoseconds);return K.fromTimestamp(e)}function Br(t,e){const n=(e.baseMutations||[]).map(i=>ju(t.ut,i));for(let i=0;i<e.mutations.length-1;++i){const o=e.mutations[i];if(i+1<e.mutations.length&&e.mutations[i+1].transform!==void 0){const a=e.mutations[i+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(i+1,1),++i}}const r=e.mutations.map(i=>ju(t.ut,i)),s=Oe.fromMillis(e.localWriteTimeMs);return new od(e.batchId,s,n,r)}function Ki(t){const e=as(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?as(t.lastLimboFreeSnapshotVersion):K.min();let r;return r=function(i){return i.documents!==void 0}(t.query)?function(i){return z(i.documents.length===1),At(Ei(Iw(i.documents[0])))}(t.query):function(i){return At(Rw(i))}(t.query),new Dn(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,Je.fromBase64String(t.resumeToken))}function Dw(t,e){const n=os(e.snapshotVersion),r=os(e.lastLimboFreeSnapshotVersion);let s;s=oc(e.target)?bw(t.ut,e.target):Aw(t.ut,e.target)._t;const i=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:rs(e.target),readTime:n,resumeToken:i,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:s}}function hd(t){const e=Rw({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?cc(e,e.limit,"L"):e}function Hl(t,e){return new cd(e.largestBatchId,ju(t.ut,e.overlayMutation))}function Xm(t,e){const n=e.path.lastSegment();return[t,bt(e.path.popLast()),n]}function Zm(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:os(r.readTime),documentKey:bt(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RS{getBundleMetadata(e,n){return ep(e).get(n).next(r=>{if(r)return function(i){return{id:i.bundleId,createTime:as(i.createTime),version:i.version}}(r)})}saveBundleMetadata(e,n){return ep(e).put(function(s){return{bundleId:s.id,createTime:os(ze(s.createTime)),version:s.version}}(n))}getNamedQuery(e,n){return tp(e).get(n).next(r=>{if(r)return function(i){return{name:i.name,query:hd(i.bundledQuery),readTime:as(i.readTime)}}(r)})}saveNamedQuery(e,n){return tp(e).put(function(s){return{name:s.name,readTime:os(ze(s.readTime)),bundledQuery:s.bundledQuery}}(n))}}function ep(t){return rt(t,"bundles")}function tp(t){return rt(t,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nl{constructor(e,n){this.serializer=e,this.userId=n}static ct(e,n){const r=n.uid||"";return new nl(e,r)}getOverlay(e,n){return Ni(e).get(Xm(this.userId,n)).next(r=>r?Hl(this.serializer,r):null)}getOverlays(e,n){const r=yn();return _.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){const s=[];return r.forEach((i,o)=>{const a=new cd(n,o);s.push(this.lt(e,a))}),_.waitFor(s)}removeOverlaysForBatchId(e,n,r){const s=new Set;n.forEach(o=>s.add(bt(o.getCollectionPath())));const i=[];return s.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);i.push(Ni(e).j("collectionPathOverlayIndex",a))}),_.waitFor(i)}getOverlaysForCollection(e,n,r){const s=yn(),i=bt(n),o=IDBKeyRange.bound([this.userId,i,r],[this.userId,i,Number.POSITIVE_INFINITY],!0);return Ni(e).U("collectionPathOverlayIndex",o).next(a=>{for(const c of a){const l=Hl(this.serializer,c);s.set(l.getKey(),l)}return s})}getOverlaysForCollectionGroup(e,n,r,s){const i=yn();let o;const a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return Ni(e).J({index:"collectionGroupOverlayIndex",range:a},(c,l,u)=>{const h=Hl(this.serializer,l);i.size()<s||h.largestBatchId===o?(i.set(h.getKey(),h),o=h.largestBatchId):u.done()}).next(()=>i)}lt(e,n){return Ni(e).put(function(s,i,o){const[a,c,l]=Xm(i,o.mutation.key);return{userId:i,collectionPath:c,documentId:l,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:ko(s.ut,o.mutation)}}(this.serializer,this.userId,n))}}function Ni(t){return rt(t,"documentOverlays")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ur{constructor(){}ht(e,n){this.Pt(e,n),n.It()}Pt(e,n){if("nullValue"in e)this.Tt(n,5);else if("booleanValue"in e)this.Tt(n,10),n.Et(e.booleanValue?1:0);else if("integerValue"in e)this.Tt(n,15),n.Et(Ue(e.integerValue));else if("doubleValue"in e){const r=Ue(e.doubleValue);isNaN(r)?this.Tt(n,13):(this.Tt(n,15),Ro(r)?n.Et(0):n.Et(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Tt(n,20),typeof r=="string"&&(r=Fn(r)),n.dt(`${r.seconds||""}`),n.Et(r.nanos||0)}else if("stringValue"in e)this.At(e.stringValue,n),this.Rt(n);else if("bytesValue"in e)this.Tt(n,30),n.Vt(lr(e.bytesValue)),this.Rt(n);else if("referenceValue"in e)this.ft(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.Tt(n,45),n.Et(r.latitude||0),n.Et(r.longitude||0)}else"mapValue"in e?qy(e)?this.Tt(n,Number.MAX_SAFE_INTEGER):(this.gt(e.mapValue,n),this.Rt(n)):"arrayValue"in e?(this.yt(e.arrayValue,n),this.Rt(n)):$()}At(e,n){this.Tt(n,25),this.wt(e,n)}wt(e,n){n.dt(e)}gt(e,n){const r=e.fields||{};this.Tt(n,55);for(const s of Object.keys(r))this.At(s,n),this.Pt(r[s],n)}yt(e,n){const r=e.values||[];this.Tt(n,50);for(const s of r)this.Pt(s,n)}ft(e,n){this.Tt(n,37),N.fromName(e).path.forEach(r=>{this.Tt(n,60),this.wt(r,n)})}Tt(e,n){e.Et(n)}Rt(e){e.Et(2)}}Ur.St=new Ur;function PS(t){if(t===0)return 8;let e=0;return!(t>>4)&&(e+=4,t<<=4),!(t>>6)&&(e+=2,t<<=2),!(t>>7)&&(e+=1),e}function np(t){const e=64-function(r){let s=0;for(let i=0;i<8;++i){const o=PS(255&r[i]);if(s+=o,o!==8)break}return s}(t);return Math.ceil(e/8)}class SS{constructor(){this.buffer=new Uint8Array(1024),this.position=0}bt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Dt(r.value),r=n.next();this.Ct()}vt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Ft(r.value),r=n.next();this.Mt()}xt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Dt(r);else if(r<2048)this.Dt(960|r>>>6),this.Dt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Dt(480|r>>>12),this.Dt(128|63&r>>>6),this.Dt(128|63&r);else{const s=n.codePointAt(0);this.Dt(240|s>>>18),this.Dt(128|63&s>>>12),this.Dt(128|63&s>>>6),this.Dt(128|63&s)}}this.Ct()}Ot(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{const s=n.codePointAt(0);this.Ft(240|s>>>18),this.Ft(128|63&s>>>12),this.Ft(128|63&s>>>6),this.Ft(128|63&s)}}this.Mt()}Nt(e){const n=this.Lt(e),r=np(n);this.Bt(1+r),this.buffer[this.position++]=255&r;for(let s=n.length-r;s<n.length;++s)this.buffer[this.position++]=255&n[s]}kt(e){const n=this.Lt(e),r=np(n);this.Bt(1+r),this.buffer[this.position++]=~(255&r);for(let s=n.length-r;s<n.length;++s)this.buffer[this.position++]=~(255&n[s])}qt(){this.Qt(255),this.Qt(255)}Kt(){this.$t(255),this.$t(255)}reset(){this.position=0}seed(e){this.Bt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Ut(){return this.buffer.slice(0,this.position)}Lt(e){const n=function(i){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,i,!1),new Uint8Array(o.buffer)}(e),r=(128&n[0])!=0;n[0]^=r?255:128;for(let s=1;s<n.length;++s)n[s]^=r?255:0;return n}Dt(e){const n=255&e;n===0?(this.Qt(0),this.Qt(255)):n===255?(this.Qt(255),this.Qt(0)):this.Qt(n)}Ft(e){const n=255&e;n===0?(this.$t(0),this.$t(255)):n===255?(this.$t(255),this.$t(0)):this.$t(e)}Ct(){this.Qt(0),this.Qt(1)}Mt(){this.$t(0),this.$t(1)}Qt(e){this.Bt(1),this.buffer[this.position++]=e}$t(e){this.Bt(1),this.buffer[this.position++]=~e}Bt(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const s=new Uint8Array(r);s.set(this.buffer),this.buffer=s}}class CS{constructor(e){this.Wt=e}Vt(e){this.Wt.bt(e)}dt(e){this.Wt.xt(e)}Et(e){this.Wt.Nt(e)}It(){this.Wt.qt()}}class xS{constructor(e){this.Wt=e}Vt(e){this.Wt.vt(e)}dt(e){this.Wt.Ot(e)}Et(e){this.Wt.kt(e)}It(){this.Wt.Kt()}}class Oi{constructor(){this.Wt=new SS,this.Gt=new CS(this.Wt),this.zt=new xS(this.Wt)}seed(e){this.Wt.seed(e)}jt(e){return e===0?this.Gt:this.zt}Ut(){return this.Wt.Ut()}reset(){this.Wt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $r{constructor(e,n,r,s){this.indexId=e,this.documentKey=n,this.arrayValue=r,this.directionalValue=s}Ht(){const e=this.directionalValue.length,n=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new $r(this.indexId,this.documentKey,this.arrayValue,r)}}function Hn(t,e){let n=t.indexId-e.indexId;return n!==0?n:(n=rp(t.arrayValue,e.arrayValue),n!==0?n:(n=rp(t.directionalValue,e.directionalValue),n!==0?n:N.comparator(t.documentKey,e.documentKey)))}function rp(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sp{constructor(e){this.Jt=new Te((n,r)=>Ve.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.Yt=e.orderBy,this.Zt=[];for(const n of e.filters){const r=n;r.isInequality()?this.Jt=this.Jt.add(r):this.Zt.push(r)}}get Xt(){return this.Jt.size>1}en(e){if(z(e.collectionGroup===this.collectionId),this.Xt)return!1;const n=ku(e);if(n!==void 0&&!this.tn(n))return!1;const r=Nr(e);let s=new Set,i=0,o=0;for(;i<r.length&&this.tn(r[i]);++i)s=s.add(r[i].fieldPath.canonicalString());if(i===r.length)return!0;if(this.Jt.size>0){const a=this.Jt.getIterator().getNext();if(!s.has(a.field.canonicalString())){const c=r[i];if(!this.nn(a,c)||!this.rn(this.Yt[o++],c))return!1}++i}for(;i<r.length;++i){const a=r[i];if(o>=this.Yt.length||!this.rn(this.Yt[o++],a))return!1}return!0}sn(){if(this.Xt)return null;let e=new Te(Ve.comparator);const n=[];for(const r of this.Zt)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new Oa(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new Oa(r.field,0))}for(const r of this.Yt)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new Oa(r.field,r.dir==="asc"?0:1)));return new ic(ic.UNKNOWN_ID,this.collectionId,n,Ao.empty())}tn(e){for(const n of this.Zt)if(this.nn(n,e))return!0;return!1}nn(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}rn(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kw(t){var e,n;if(z(t instanceof ce||t instanceof we),t instanceof ce){if(t instanceof Yy){const s=((n=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||n===void 0?void 0:n.map(i=>ce.create(t.field,"==",i)))||[];return we.create(s,"or")}return t}const r=t.filters.map(s=>kw(s));return we.create(r,t.op)}function DS(t){if(t.getFilters().length===0)return[];const e=Gu(kw(t));return z(Vw(e)),zu(e)||Ku(e)?[e]:e.getFilters()}function zu(t){return t instanceof ce}function Ku(t){return t instanceof we&&nd(t)}function Vw(t){return zu(t)||Ku(t)||function(n){if(n instanceof we&&Mu(n)){for(const r of n.getFilters())if(!zu(r)&&!Ku(r))return!1;return!0}return!1}(t)}function Gu(t){if(z(t instanceof ce||t instanceof we),t instanceof ce)return t;if(t.filters.length===1)return Gu(t.filters[0]);const e=t.filters.map(r=>Gu(r));let n=we.create(e,t.op);return n=uc(n),Vw(n)?n:(z(n instanceof we),z(ni(n)),z(n.filters.length>1),n.filters.reduce((r,s)=>dd(r,s)))}function dd(t,e){let n;return z(t instanceof ce||t instanceof we),z(e instanceof ce||e instanceof we),n=t instanceof ce?e instanceof ce?function(s,i){return we.create([s,i],"and")}(t,e):ip(t,e):e instanceof ce?ip(e,t):function(s,i){if(z(s.filters.length>0&&i.filters.length>0),ni(s)&&ni(i))return Hy(s,i.getFilters());const o=Mu(s)?s:i,a=Mu(s)?i:s,c=o.filters.map(l=>dd(l,a));return we.create(c,"or")}(t,e),uc(n)}function ip(t,e){if(ni(e))return Hy(e,t.getFilters());{const n=e.filters.map(r=>dd(t,r));return we.create(n,"or")}}function uc(t){if(z(t instanceof ce||t instanceof we),t instanceof ce)return t;const e=t.getFilters();if(e.length===1)return uc(e[0]);if(Ky(t))return t;const n=e.map(s=>uc(s)),r=[];return n.forEach(s=>{s instanceof ce?r.push(s):s instanceof we&&(s.op===t.op?r.push(...s.filters):r.push(s))}),r.length===1?r[0]:we.create(r,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kS{constructor(){this.on=new fd}addToCollectionParentIndex(e,n){return this.on.add(n),_.resolve()}getCollectionParents(e,n){return _.resolve(this.on.getEntries(n))}addFieldIndex(e,n){return _.resolve()}deleteFieldIndex(e,n){return _.resolve()}deleteAllFieldIndexes(e){return _.resolve()}createTargetIndexes(e,n){return _.resolve()}getDocumentsMatchingTarget(e,n){return _.resolve(null)}getIndexType(e,n){return _.resolve(0)}getFieldIndexes(e,n){return _.resolve([])}getNextCollectionGroupToUpdate(e){return _.resolve(null)}getMinOffset(e,n){return _.resolve(Bt.min())}getMinOffsetFromCollectionGroup(e,n){return _.resolve(Bt.min())}updateCollectionGroup(e,n,r){return _.resolve()}updateIndexEntries(e,n){return _.resolve()}}class fd{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new Te(ae.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new Te(ae.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ia=new Uint8Array(0);class VS{constructor(e,n){this.databaseId=n,this._n=new fd,this.an=new Tr(r=>rs(r),(r,s)=>Wo(r,s)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this._n.has(n)){const r=n.lastSegment(),s=n.popLast();e.addOnCommittedListener(()=>{this._n.add(n)});const i={collectionId:r,parent:bt(s)};return op(e).put(i)}return _.resolve()}getCollectionParents(e,n){const r=[],s=IDBKeyRange.bound([n,""],[Sy(n),""],!1,!0);return op(e).U(s).next(i=>{for(const o of i){if(o.collectionId!==n)break;r.push(_n(o.parent))}return r})}addFieldIndex(e,n){const r=Mi(e),s=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(n);delete s.indexId;const i=r.add(s);if(n.indexState){const o=bs(e);return i.next(a=>{o.put(Zm(a,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return i.next()}deleteFieldIndex(e,n){const r=Mi(e),s=bs(e),i=Ts(e);return r.delete(n.indexId).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const n=Mi(e),r=Ts(e),s=bs(e);return n.j().next(()=>r.j()).next(()=>s.j())}createTargetIndexes(e,n){return _.forEach(this.un(n),r=>this.getIndexType(e,r).next(s=>{if(s===0||s===1){const i=new sp(r).sn();if(i!=null)return this.addFieldIndex(e,i)}}))}getDocumentsMatchingTarget(e,n){const r=Ts(e);let s=!0;const i=new Map;return _.forEach(this.un(n),o=>this.cn(e,o).next(a=>{s&&(s=!!a),i.set(o,a)})).next(()=>{if(s){let o=re();const a=[];return _.forEach(i,(c,l)=>{S("IndexedDbIndexManager",`Using index ${function(R){return`id=${R.indexId}|cg=${R.collectionGroup}|f=${R.fields.map(B=>`${B.fieldPath}:${B.kind}`).join(",")}`}(c)} to execute ${rs(n)}`);const u=function(R,B){const Y=ku(B);if(Y===void 0)return null;for(const Z of ac(R,Y.fieldPath))switch(Z.op){case"array-contains-any":return Z.value.arrayValue.values||[];case"array-contains":return[Z.value]}return null}(l,c),h=function(R,B){const Y=new Map;for(const Z of Nr(B))for(const ge of ac(R,Z.fieldPath))switch(ge.op){case"==":case"in":Y.set(Z.fieldPath.canonicalString(),ge.value);break;case"not-in":case"!=":return Y.set(Z.fieldPath.canonicalString(),ge.value),Array.from(Y.values())}return null}(l,c),d=function(R,B){const Y=[];let Z=!0;for(const ge of Nr(B)){const Be=ge.kind===0?Lm(R,ge.fieldPath,R.startAt):Bm(R,ge.fieldPath,R.startAt);Y.push(Be.value),Z&&(Z=Be.inclusive)}return new dr(Y,Z)}(l,c),f=function(R,B){const Y=[];let Z=!0;for(const ge of Nr(B)){const Be=ge.kind===0?Bm(R,ge.fieldPath,R.endAt):Lm(R,ge.fieldPath,R.endAt);Y.push(Be.value),Z&&(Z=Be.inclusive)}return new dr(Y,Z)}(l,c),y=this.ln(c,l,d),w=this.ln(c,l,f),I=this.hn(c,l,h),b=this.Pn(c.indexId,u,y,d.inclusive,w,f.inclusive,I);return _.forEach(b,D=>r.G(D,n.limit).next(R=>{R.forEach(B=>{const Y=N.fromSegments(B.documentKey);o.has(Y)||(o=o.add(Y),a.push(Y))})}))}).next(()=>a)}return _.resolve(null)})}un(e){let n=this.an.get(e);return n||(e.filters.length===0?n=[e]:n=DS(we.create(e.filters,"and")).map(r=>Lu(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.an.set(e,n),n)}Pn(e,n,r,s,i,o,a){const c=(n!=null?n.length:1)*Math.max(r.length,i.length),l=c/(n!=null?n.length:1),u=[];for(let h=0;h<c;++h){const d=n?this.In(n[h/l]):Ia,f=this.Tn(e,d,r[h%l],s),y=this.En(e,d,i[h%l],o),w=a.map(I=>this.Tn(e,d,I,!0));u.push(...this.createRange(f,y,w))}return u}Tn(e,n,r,s){const i=new $r(e,N.empty(),n,r);return s?i:i.Ht()}En(e,n,r,s){const i=new $r(e,N.empty(),n,r);return s?i.Ht():i}cn(e,n){const r=new sp(n),s=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,s).next(i=>{let o=null;for(const a of i)r.en(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2;const s=this.un(n);return _.forEach(s,i=>this.cn(e,i).next(o=>{o?r!==0&&o.fields.length<function(c){let l=new Te(Ve.comparator),u=!1;for(const h of c.filters)for(const d of h.getFlattenedFilters())d.field.isKeyField()||(d.op==="array-contains"||d.op==="array-contains-any"?u=!0:l=l.add(d.field));for(const h of c.orderBy)h.field.isKeyField()||(l=l.add(h.field));return l.size+(u?1:0)}(i)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&s.length>1&&r===2?1:r)}dn(e,n){const r=new Oi;for(const s of Nr(e)){const i=n.data.field(s.fieldPath);if(i==null)return null;const o=r.jt(s.kind);Ur.St.ht(i,o)}return r.Ut()}In(e){const n=new Oi;return Ur.St.ht(e,n.jt(0)),n.Ut()}An(e,n){const r=new Oi;return Ur.St.ht(ns(this.databaseId,n),r.jt(function(i){const o=Nr(i);return o.length===0?0:o[o.length-1].kind}(e))),r.Ut()}hn(e,n,r){if(r===null)return[];let s=[];s.push(new Oi);let i=0;for(const o of Nr(e)){const a=r[i++];for(const c of s)if(this.Rn(n,o.fieldPath)&&Co(a))s=this.Vn(s,o,a);else{const l=c.jt(o.kind);Ur.St.ht(a,l)}}return this.mn(s)}ln(e,n,r){return this.hn(e,n,r.position)}mn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].Ut();return n}Vn(e,n,r){const s=[...e],i=[];for(const o of r.arrayValue.values||[])for(const a of s){const c=new Oi;c.seed(a.Ut()),Ur.St.ht(o,c.jt(n.kind)),i.push(c)}return i}Rn(e,n){return!!e.filters.find(r=>r instanceof ce&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){const r=Mi(e),s=bs(e);return(n?r.U("collectionGroupIndex",IDBKeyRange.bound(n,n)):r.U()).next(i=>{const o=[];return _.forEach(i,a=>s.get([a.indexId,this.uid]).next(c=>{o.push(function(u,h){const d=h?new Ao(h.sequenceNumber,new Bt(as(h.readTime),new N(_n(h.documentKey)),h.largestBatchId)):Ao.empty(),f=u.fields.map(([y,w])=>new Oa(Ve.fromServerFormat(y),w));return new ic(u.indexId,u.collectionGroup,f,d)}(a,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,s)=>{const i=r.indexState.sequenceNumber-s.indexState.sequenceNumber;return i!==0?i:ee(r.collectionGroup,s.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const s=Mi(e),i=bs(e);return this.fn(e).next(o=>s.U("collectionGroupIndex",IDBKeyRange.bound(n,n)).next(a=>_.forEach(a,c=>i.put(Zm(c.indexId,this.uid,o,r)))))}updateIndexEntries(e,n){const r=new Map;return _.forEach(n,(s,i)=>{const o=r.get(s.collectionGroup);return(o?_.resolve(o):this.getFieldIndexes(e,s.collectionGroup)).next(a=>(r.set(s.collectionGroup,a),_.forEach(a,c=>this.gn(e,s,c).next(l=>{const u=this.pn(i,c);return l.isEqual(u)?_.resolve():this.yn(e,i,c,l,u)}))))})}wn(e,n,r,s){return Ts(e).put({indexId:s.indexId,uid:this.uid,arrayValue:s.arrayValue,directionalValue:s.directionalValue,orderedDocumentKey:this.An(r,n.key),documentKey:n.key.path.toArray()})}Sn(e,n,r,s){return Ts(e).delete([s.indexId,this.uid,s.arrayValue,s.directionalValue,this.An(r,n.key),n.key.path.toArray()])}gn(e,n,r){const s=Ts(e);let i=new Te(Hn);return s.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.An(r,n)])},(o,a)=>{i=i.add(new $r(r.indexId,n,a.arrayValue,a.directionalValue))}).next(()=>i)}pn(e,n){let r=new Te(Hn);const s=this.dn(n,e);if(s==null)return r;const i=ku(n);if(i!=null){const o=e.data.field(i.fieldPath);if(Co(o))for(const a of o.arrayValue.values||[])r=r.add(new $r(n.indexId,e.key,this.In(a),s))}else r=r.add(new $r(n.indexId,e.key,Ia,s));return r}yn(e,n,r,s,i){S("IndexedDbIndexManager","Updating index entries for document '%s'",n.key);const o=[];return function(c,l,u,h,d){const f=c.getIterator(),y=l.getIterator();let w=vs(f),I=vs(y);for(;w||I;){let b=!1,D=!1;if(w&&I){const R=u(w,I);R<0?D=!0:R>0&&(b=!0)}else w!=null?D=!0:b=!0;b?(h(I),I=vs(y)):D?(d(w),w=vs(f)):(w=vs(f),I=vs(y))}}(s,i,Hn,a=>{o.push(this.wn(e,n,r,a))},a=>{o.push(this.Sn(e,n,r,a))}),_.waitFor(o)}fn(e){let n=1;return bs(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,s,i)=>{i.done(),n=s.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>Hn(o,a)).filter((o,a,c)=>!a||Hn(o,c[a-1])!==0);const s=[];s.push(e);for(const o of r){const a=Hn(o,e),c=Hn(o,n);if(a===0)s[0]=e.Ht();else if(a>0&&c<0)s.push(o),s.push(o.Ht());else if(c>0)break}s.push(n);const i=[];for(let o=0;o<s.length;o+=2){if(this.bn(s[o],s[o+1]))return[];const a=[s[o].indexId,this.uid,s[o].arrayValue,s[o].directionalValue,Ia,[]],c=[s[o+1].indexId,this.uid,s[o+1].arrayValue,s[o+1].directionalValue,Ia,[]];i.push(IDBKeyRange.bound(a,c))}return i}bn(e,n){return Hn(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(ap)}getMinOffset(e,n){return _.mapArray(this.un(n),r=>this.cn(e,r).next(s=>s||$())).next(ap)}}function op(t){return rt(t,"collectionParents")}function Ts(t){return rt(t,"indexEntries")}function Mi(t){return rt(t,"indexConfiguration")}function bs(t){return rt(t,"indexState")}function ap(t){z(t.length!==0);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const s=t[r].indexState.offset;Zh(s,e)<0&&(e=s),n<s.largestBatchId&&(n=s.largestBatchId)}return new Bt(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cp={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class xt{constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new xt(e,xt.DEFAULT_COLLECTION_PERCENTILE,xt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nw(t,e,n){const r=t.store("mutations"),s=t.store("documentMutations"),i=[],o=IDBKeyRange.only(n.batchId);let a=0;const c=r.J({range:o},(u,h,d)=>(a++,d.delete()));i.push(c.next(()=>{z(a===1)}));const l=[];for(const u of n.mutations){const h=Oy(e,u.key.path,n.batchId);i.push(s.delete(h)),l.push(u.key)}return _.waitFor(i).next(()=>l)}function hc(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw $();e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */xt.DEFAULT_COLLECTION_PERCENTILE=10,xt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,xt.DEFAULT=new xt(41943040,xt.DEFAULT_COLLECTION_PERCENTILE,xt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),xt.DISABLED=new xt(-1,0,0);class rl{constructor(e,n,r,s){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=s,this.Dn={}}static ct(e,n,r,s){z(e.uid!=="");const i=e.isAuthenticated()?e.uid:"";return new rl(i,n,r,s)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Wn(e).J({index:"userMutationsIndex",range:r},(s,i,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,s){const i=ks(e),o=Wn(e);return o.add({}).next(a=>{z(typeof a=="number");const c=new od(a,n,r,s),l=function(f,y,w){const I=w.baseMutations.map(D=>ko(f.ut,D)),b=w.mutations.map(D=>ko(f.ut,D));return{userId:y,batchId:w.batchId,localWriteTimeMs:w.localWriteTime.toMillis(),baseMutations:I,mutations:b}}(this.serializer,this.userId,c),u=[];let h=new Te((d,f)=>ee(d.canonicalString(),f.canonicalString()));for(const d of s){const f=Oy(this.userId,d.key.path,a);h=h.add(d.key.path.popLast()),u.push(o.put(l)),u.push(i.put(f,IP))}return h.forEach(d=>{u.push(this.indexManager.addToCollectionParentIndex(e,d))}),e.addOnCommittedListener(()=>{this.Dn[a]=c.keys()}),_.waitFor(u).next(()=>c)})}lookupMutationBatch(e,n){return Wn(e).get(n).next(r=>r?(z(r.userId===this.userId),Br(this.serializer,r)):null)}Cn(e,n){return this.Dn[n]?_.resolve(this.Dn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const s=r.keys();return this.Dn[n]=s,s}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=IDBKeyRange.lowerBound([this.userId,r]);let i=null;return Wn(e).J({index:"userMutationsIndex",range:s},(o,a,c)=>{a.userId===this.userId&&(z(a.batchId>=r),i=Br(this.serializer,a)),c.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return Wn(e).J({index:"userMutationsIndex",range:n,reverse:!0},(s,i,o)=>{r=i.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Wn(e).U("userMutationsIndex",n).next(r=>r.map(s=>Br(this.serializer,s)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=Ma(this.userId,n.path),s=IDBKeyRange.lowerBound(r),i=[];return ks(e).J({range:s},(o,a,c)=>{const[l,u,h]=o,d=_n(u);if(l===this.userId&&n.path.isEqual(d))return Wn(e).get(h).next(f=>{if(!f)throw $();z(f.userId===this.userId),i.push(Br(this.serializer,f))});c.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Te(ee);const s=[];return n.forEach(i=>{const o=Ma(this.userId,i.path),a=IDBKeyRange.lowerBound(o),c=ks(e).J({range:a},(l,u,h)=>{const[d,f,y]=l,w=_n(f);d===this.userId&&i.path.isEqual(w)?r=r.add(y):h.done()});s.push(c)}),_.waitFor(s).next(()=>this.vn(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1,i=Ma(this.userId,r),o=IDBKeyRange.lowerBound(i);let a=new Te(ee);return ks(e).J({range:o},(c,l,u)=>{const[h,d,f]=c,y=_n(d);h===this.userId&&r.isPrefixOf(y)?y.length===s&&(a=a.add(f)):u.done()}).next(()=>this.vn(e,a))}vn(e,n){const r=[],s=[];return n.forEach(i=>{s.push(Wn(e).get(i).next(o=>{if(o===null)throw $();z(o.userId===this.userId),r.push(Br(this.serializer,o))}))}),_.waitFor(s).next(()=>r)}removeMutationBatch(e,n){return Nw(e._e,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.Fn(n.batchId)}),_.forEach(r,s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))}Fn(e){delete this.Dn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return _.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),s=[];return ks(e).J({range:r},(i,o,a)=>{if(i[0]===this.userId){const c=_n(i[1]);s.push(c)}else a.done()}).next(()=>{z(s.length===0)})})}containsKey(e,n){return Ow(e,this.userId,n)}Mn(e){return Mw(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function Ow(t,e,n){const r=Ma(e,n.path),s=r[1],i=IDBKeyRange.lowerBound(r);let o=!1;return ks(t).J({range:i,H:!0},(a,c,l)=>{const[u,h,d]=a;u===e&&h===s&&(o=!0),l.done()}).next(()=>o)}function Wn(t){return rt(t,"mutations")}function ks(t){return rt(t,"documentMutations")}function Mw(t){return rt(t,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cs{constructor(e){this.xn=e}next(){return this.xn+=2,this.xn}static On(){return new cs(0)}static Nn(){return new cs(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NS{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.Ln(e).next(n=>{const r=new cs(n.highestTargetId);return n.highestTargetId=r.next(),this.Bn(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Ln(e).next(n=>K.fromTimestamp(new Oe(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Ln(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.Ln(e).next(s=>(s.highestListenSequenceNumber=n,r&&(s.lastRemoteSnapshotVersion=r.toTimestamp()),n>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=n),this.Bn(e,s)))}addTargetData(e,n){return this.kn(e,n).next(()=>this.Ln(e).next(r=>(r.targetCount+=1,this.qn(n,r),this.Bn(e,r))))}updateTargetData(e,n){return this.kn(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>As(e).delete(n.targetId)).next(()=>this.Ln(e)).next(r=>(z(r.targetCount>0),r.targetCount-=1,this.Bn(e,r)))}removeTargets(e,n,r){let s=0;const i=[];return As(e).J((o,a)=>{const c=Ki(a);c.sequenceNumber<=n&&r.get(c.targetId)===null&&(s++,i.push(this.removeTargetData(e,c)))}).next(()=>_.waitFor(i)).next(()=>s)}forEachTarget(e,n){return As(e).J((r,s)=>{const i=Ki(s);n(i)})}Ln(e){return lp(e).get("targetGlobalKey").next(n=>(z(n!==null),n))}Bn(e,n){return lp(e).put("targetGlobalKey",n)}kn(e,n){return As(e).put(Dw(this.serializer,n))}qn(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.Ln(e).next(n=>n.targetCount)}getTargetData(e,n){const r=rs(n),s=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let i=null;return As(e).J({range:s,index:"queryTargetsIndex"},(o,a,c)=>{const l=Ki(a);Wo(n,l.target)&&(i=l,c.done())}).next(()=>i)}addMatchingKeys(e,n,r){const s=[],i=Xn(e);return n.forEach(o=>{const a=bt(o.path);s.push(i.put({targetId:r,path:a})),s.push(this.referenceDelegate.addReference(e,r,o))}),_.waitFor(s)}removeMatchingKeys(e,n,r){const s=Xn(e);return _.forEach(n,i=>{const o=bt(i.path);return _.waitFor([s.delete([r,o]),this.referenceDelegate.removeReference(e,r,i)])})}removeMatchingKeysForTargetId(e,n){const r=Xn(e),s=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(s)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),s=Xn(e);let i=re();return s.J({range:r,H:!0},(o,a,c)=>{const l=_n(o[1]),u=new N(l);i=i.add(u)}).next(()=>i)}containsKey(e,n){const r=bt(n.path),s=IDBKeyRange.bound([r],[Sy(r)],!1,!0);let i=0;return Xn(e).J({index:"documentTargetsIndex",H:!0,range:s},([o,a],c,l)=>{o!==0&&(i++,l.done())}).next(()=>i>0)}ot(e,n){return As(e).get(n).next(r=>r?Ki(r):null)}}function As(t){return rt(t,"targets")}function lp(t){return rt(t,"targetGlobal")}function Xn(t){return rt(t,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function up([t,e],[n,r]){const s=ee(t,n);return s===0?ee(e,r):s}class OS{constructor(e){this.Qn=e,this.buffer=new Te(up),this.Kn=0}$n(){return++this.Kn}Un(e){const n=[e,this.$n()];if(this.buffer.size<this.Qn)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();up(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class MS{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Wn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Gn(6e4)}stop(){this.Wn&&(this.Wn.cancel(),this.Wn=null)}get started(){return this.Wn!==null}Gn(e){S("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Wn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Wn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){vr(n)?S("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n):await Ir(n)}await this.Gn(3e5)})}}class FS{constructor(e,n){this.zn=e,this.params=n}calculateTargetCount(e,n){return this.zn.jn(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return _.resolve(kt.oe);const r=new OS(n);return this.zn.forEachTarget(e,s=>r.Un(s.sequenceNumber)).next(()=>this.zn.Hn(e,s=>r.Un(s))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.zn.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.zn.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(S("LruGarbageCollector","Garbage collection skipped; disabled"),_.resolve(cp)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(S("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),cp):this.Jn(e,n))}getCacheSize(e){return this.zn.getCacheSize(e)}Jn(e,n){let r,s,i,o,a,c,l;const u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(S("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),s=this.params.maximumSequenceNumbersToCollect):s=h,o=Date.now(),this.nthSequenceNumber(e,s))).next(h=>(r=h,a=Date.now(),this.removeTargets(e,r,n))).next(h=>(i=h,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(h=>(l=Date.now(),Ss()<=le.DEBUG&&S("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-u}ms
	Determined least recently used ${s} in `+(a-o)+`ms
	Removed ${i} targets in `+(c-a)+`ms
	Removed ${h} documents in `+(l-c)+`ms
Total Duration: ${l-u}ms`),_.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:h})))}}function LS(t,e){return new FS(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BS{constructor(e,n){this.db=e,this.garbageCollector=LS(this,n)}jn(e){const n=this.Yn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}Yn(e){let n=0;return this.Hn(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}Hn(e,n){return this.Zn(e,(r,s)=>n(s))}addReference(e,n,r){return va(e,r)}removeReference(e,n,r){return va(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return va(e,n)}Xn(e,n){return function(s,i){let o=!1;return Mw(s).Y(a=>Ow(s,a,i).next(c=>(c&&(o=!0),_.resolve(!c)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let i=0;return this.Zn(e,(o,a)=>{if(a<=n){const c=this.Xn(e,o).next(l=>{if(!l)return i++,r.getEntry(e,o).next(()=>(r.removeEntry(o,K.min()),Xn(e).delete(function(h){return[0,bt(h.path)]}(o))))});s.push(c)}}).next(()=>_.waitFor(s)).next(()=>r.apply(e)).next(()=>i)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return va(e,n)}Zn(e,n){const r=Xn(e);let s,i=kt.oe;return r.J({index:"documentTargetsIndex"},([o,a],{path:c,sequenceNumber:l})=>{o===0?(i!==kt.oe&&n(new N(_n(s)),i),i=l,s=c):i=kt.oe}).next(()=>{i!==kt.oe&&n(new N(_n(s)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function va(t,e){return Xn(t).put(function(r,s){return{targetId:0,path:bt(r.path),sequenceNumber:s}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fw{constructor(){this.changes=new Tr(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,De.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?_.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class US{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return Dr(e).put(r)}removeEntry(e,n,r){return Dr(e).delete(function(i,o){const a=i.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],lc(o),a[a.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.er(e,r)))}getEntry(e,n){let r=De.newInvalidDocument(n);return Dr(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Fi(n))},(s,i)=>{r=this.tr(n,i)}).next(()=>r)}nr(e,n){let r={size:0,document:De.newInvalidDocument(n)};return Dr(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Fi(n))},(s,i)=>{r={document:this.tr(n,i),size:hc(i)}}).next(()=>r)}getEntries(e,n){let r=Nt();return this.rr(e,n,(s,i)=>{const o=this.tr(s,i);r=r.insert(s,o)}).next(()=>r)}ir(e,n){let r=Nt(),s=new Se(N.comparator);return this.rr(e,n,(i,o)=>{const a=this.tr(i,o);r=r.insert(i,a),s=s.insert(i,hc(o))}).next(()=>({documents:r,sr:s}))}rr(e,n,r){if(n.isEmpty())return _.resolve();let s=new Te(fp);n.forEach(c=>s=s.add(c));const i=IDBKeyRange.bound(Fi(s.first()),Fi(s.last())),o=s.getIterator();let a=o.getNext();return Dr(e).J({index:"documentKeyIndex",range:i},(c,l,u)=>{const h=N.fromSegments([...l.prefixPath,l.collectionGroup,l.documentId]);for(;a&&fp(a,h)<0;)r(a,null),a=o.getNext();a&&a.isEqual(h)&&(r(a,l),a=o.hasNext()?o.getNext():null),a?u.$(Fi(a)):u.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,s,i){const o=n.path,a=[o.popLast().toArray(),o.lastSegment(),lc(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],c=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Dr(e).U(IDBKeyRange.bound(a,c,!0)).next(l=>{i==null||i.incrementDocumentReadCount(l.length);let u=Nt();for(const h of l){const d=this.tr(N.fromSegments(h.prefixPath.concat(h.collectionGroup,h.documentId)),h);d.isFoundDocument()&&(Yo(n,d)||s.has(d.key))&&(u=u.insert(d.key,d))}return u})}getAllFromCollectionGroup(e,n,r,s){let i=Nt();const o=dp(n,r),a=dp(n,Bt.max());return Dr(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(c,l,u)=>{const h=this.tr(N.fromSegments(l.prefixPath.concat(l.collectionGroup,l.documentId)),l);i=i.insert(h.key,h),i.size===s&&u.done()}).next(()=>i)}newChangeBuffer(e){return new $S(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return hp(e).get("remoteDocumentGlobalKey").next(n=>(z(!!n),n))}er(e,n){return hp(e).put("remoteDocumentGlobalKey",n)}tr(e,n){if(n){const r=AS(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(K.min())))return r}return De.newInvalidDocument(e)}}function Lw(t){return new US(t)}class $S extends Fw{constructor(e,n){super(),this._r=e,this.trackRemovals=n,this.ar=new Tr(r=>r.toString(),(r,s)=>r.isEqual(s))}applyChanges(e){const n=[];let r=0,s=new Te((i,o)=>ee(i.canonicalString(),o.canonicalString()));return this.changes.forEach((i,o)=>{const a=this.ar.get(i);if(n.push(this._r.removeEntry(e,i,a.readTime)),o.isValidDocument()){const c=Jm(this._r.serializer,o);s=s.add(i.path.popLast());const l=hc(c);r+=l-a.size,n.push(this._r.addEntry(e,i,c))}else if(r-=a.size,this.trackRemovals){const c=Jm(this._r.serializer,o.convertToNoDocument(K.min()));n.push(this._r.addEntry(e,i,c))}}),s.forEach(i=>{n.push(this._r.indexManager.addToCollectionParentIndex(e,i))}),n.push(this._r.updateMetadata(e,r)),_.waitFor(n)}getFromCache(e,n){return this._r.nr(e,n).next(r=>(this.ar.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this._r.ir(e,n).next(({documents:r,sr:s})=>(s.forEach((i,o)=>{this.ar.set(i,{size:o,readTime:r.get(i).readTime})}),r))}}function hp(t){return rt(t,"remoteDocumentGlobal")}function Dr(t){return rt(t,"remoteDocumentsV14")}function Fi(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function dp(t,e){const n=e.documentKey.path.toArray();return[t,lc(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function fp(t,e){const n=t.path.toArray(),r=e.path.toArray();let s=0;for(let i=0;i<n.length-2&&i<r.length-2;++i)if(s=ee(n[i],r[i]),s)return s;return s=ee(n.length,r.length),s||(s=ee(n[n.length-2],r[r.length-2]),s||ee(n[n.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qS{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bw{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&eo(r.mutation,s,Vt.empty(),Oe.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,re()).next(()=>r))}getLocalViewOfDocuments(e,n,r=re()){const s=yn();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=ji();return i.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=yn();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,re()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,s){let i=Nt();const o=Zi(),a=function(){return Zi()}();return n.forEach((c,l)=>{const u=r.get(l.key);s.has(l.key)&&(u===void 0||u.mutation instanceof $n)?i=i.insert(l.key,l):u!==void 0?(o.set(l.key,u.mutation.getFieldMask()),eo(u.mutation,l,u.mutation.getFieldMask(),Oe.now())):o.set(l.key,Vt.empty())}),this.recalculateAndSaveOverlays(e,i).next(c=>(c.forEach((l,u)=>o.set(l,u)),n.forEach((l,u)=>{var h;return a.set(l,new qS(u,(h=o.get(l))!==null&&h!==void 0?h:null))}),a))}recalculateAndSaveOverlays(e,n){const r=Zi();let s=new Se((o,a)=>o-a),i=re();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(c=>{const l=n.get(c);if(l===null)return;let u=r.get(c)||Vt.empty();u=a.applyToLocalView(l,u),r.set(c,u);const h=(s.get(a.batchId)||re()).add(c);s=s.insert(a.batchId,h)})}).next(()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const c=a.getNext(),l=c.key,u=c.value,h=rw();u.forEach(d=>{if(!i.has(d)){const f=hw(n.get(d),r.get(d));f!==null&&h.set(d,f),i=i.add(d)}}),o.push(this.documentOverlayCache.saveOverlays(e,l,h))}return _.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(o){return N.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):rd(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):_.resolve(yn());let a=-1,c=i;return o.next(l=>_.forEach(l,(u,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),i.get(u)?_.resolve():this.remoteDocumentCache.getEntry(e,u).next(d=>{c=c.insert(u,d)}))).next(()=>this.populateOverlays(e,l,i)).next(()=>this.computeViews(e,c,l,re())).next(u=>({batchId:a,changes:nw(u)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new N(n)).next(r=>{let s=ji();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let o=ji();return this.indexManager.getCollectionParents(e,i).next(a=>_.forEach(a,c=>{const l=function(h,d){return new Un(d,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(n,c.child(i));return this.getDocumentsMatchingCollectionQuery(e,l,r,s).next(u=>{u.forEach((h,d)=>{o=o.insert(h,d)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(o=>{i.forEach((c,l)=>{const u=l.getKey();o.get(u)===null&&(o=o.insert(u,De.newInvalidDocument(u)))});let a=ji();return o.forEach((c,l)=>{const u=i.get(c);u!==void 0&&eo(u.mutation,l,Vt.empty(),Oe.now()),Yo(n,l)&&(a=a.insert(c,l))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jS{constructor(e){this.serializer=e,this.ur=new Map,this.cr=new Map}getBundleMetadata(e,n){return _.resolve(this.ur.get(n))}saveBundleMetadata(e,n){return this.ur.set(n.id,function(s){return{id:s.id,version:s.version,createTime:ze(s.createTime)}}(n)),_.resolve()}getNamedQuery(e,n){return _.resolve(this.cr.get(n))}saveNamedQuery(e,n){return this.cr.set(n.name,function(s){return{name:s.name,query:hd(s.bundledQuery),readTime:ze(s.readTime)}}(n)),_.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zS{constructor(){this.overlays=new Se(N.comparator),this.lr=new Map}getOverlay(e,n){return _.resolve(this.overlays.get(n))}getOverlays(e,n){const r=yn();return _.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.lt(e,n,i)}),_.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.lr.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.lr.delete(r)),_.resolve()}getOverlaysForCollection(e,n,r){const s=yn(),i=n.length+1,o=new N(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const c=a.getNext().value,l=c.getKey();if(!n.isPrefixOf(l.path))break;l.path.length===i&&c.largestBatchId>r&&s.set(c.getKey(),c)}return _.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new Se((l,u)=>l-u);const o=this.overlays.getIterator();for(;o.hasNext();){const l=o.getNext().value;if(l.getKey().getCollectionGroup()===n&&l.largestBatchId>r){let u=i.get(l.largestBatchId);u===null&&(u=yn(),i=i.insert(l.largestBatchId,u)),u.set(l.getKey(),l)}}const a=yn(),c=i.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((l,u)=>a.set(l,u)),!(a.size()>=s)););return _.resolve(a)}lt(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.lr.get(s.largestBatchId).delete(r.key);this.lr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new cd(n,r));let i=this.lr.get(n);i===void 0&&(i=re(),this.lr.set(n,i)),this.lr.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class md{constructor(){this.hr=new Te(Xe.Pr),this.Ir=new Te(Xe.Tr)}isEmpty(){return this.hr.isEmpty()}addReference(e,n){const r=new Xe(e,n);this.hr=this.hr.add(r),this.Ir=this.Ir.add(r)}Er(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.dr(new Xe(e,n))}Ar(e,n){e.forEach(r=>this.removeReference(r,n))}Rr(e){const n=new N(new ae([])),r=new Xe(n,e),s=new Xe(n,e+1),i=[];return this.Ir.forEachInRange([r,s],o=>{this.dr(o),i.push(o.key)}),i}Vr(){this.hr.forEach(e=>this.dr(e))}dr(e){this.hr=this.hr.delete(e),this.Ir=this.Ir.delete(e)}mr(e){const n=new N(new ae([])),r=new Xe(n,e),s=new Xe(n,e+1);let i=re();return this.Ir.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new Xe(e,0),r=this.hr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Xe{constructor(e,n){this.key=e,this.gr=n}static Pr(e,n){return N.comparator(e.key,n.key)||ee(e.gr,n.gr)}static Tr(e,n){return ee(e.gr,n.gr)||N.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KS{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.pr=1,this.yr=new Te(Xe.Pr)}checkEmpty(e){return _.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.pr;this.pr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new od(i,n,r,s);this.mutationQueue.push(o);for(const a of s)this.yr=this.yr.add(new Xe(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return _.resolve(o)}lookupMutationBatch(e,n){return _.resolve(this.wr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.Sr(r),i=s<0?0:s;return _.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return _.resolve(this.mutationQueue.length===0?-1:this.pr-1)}getAllMutationBatches(e){return _.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Xe(n,0),s=new Xe(n,Number.POSITIVE_INFINITY),i=[];return this.yr.forEachInRange([r,s],o=>{const a=this.wr(o.gr);i.push(a)}),_.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Te(ee);return n.forEach(s=>{const i=new Xe(s,0),o=new Xe(s,Number.POSITIVE_INFINITY);this.yr.forEachInRange([i,o],a=>{r=r.add(a.gr)})}),_.resolve(this.br(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;N.isDocumentKey(i)||(i=i.child(""));const o=new Xe(new N(i),0);let a=new Te(ee);return this.yr.forEachWhile(c=>{const l=c.key.path;return!!r.isPrefixOf(l)&&(l.length===s&&(a=a.add(c.gr)),!0)},o),_.resolve(this.br(a))}br(e){const n=[];return e.forEach(r=>{const s=this.wr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){z(this.Dr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.yr;return _.forEach(n.mutations,s=>{const i=new Xe(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.yr=r})}Fn(e){}containsKey(e,n){const r=new Xe(n,0),s=this.yr.firstAfterOrEqual(r);return _.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,_.resolve()}Dr(e,n){return this.Sr(e)}Sr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}wr(e){const n=this.Sr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GS{constructor(e){this.Cr=e,this.docs=function(){return new Se(N.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.Cr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return _.resolve(r?r.document.mutableCopy():De.newInvalidDocument(n))}getEntries(e,n){let r=Nt();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():De.newInvalidDocument(s))}),_.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=Nt();const o=n.path,a=new N(o.child("")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){const{key:l,value:{document:u}}=c.getNext();if(!o.isPrefixOf(l.path))break;l.path.length>o.length+1||Zh(xy(u),r)<=0||(s.has(u.key)||Yo(n,u))&&(i=i.insert(u.key,u.mutableCopy()))}return _.resolve(i)}getAllFromCollectionGroup(e,n,r,s){$()}vr(e,n){return _.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new HS(this)}getSize(e){return _.resolve(this.size)}}class HS extends Fw{constructor(e){super(),this._r=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this._r.addEntry(e,s)):this._r.removeEntry(r)}),_.waitFor(n)}getFromCache(e,n){return this._r.getEntry(e,n)}getAllFromCache(e,n){return this._r.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WS{constructor(e){this.persistence=e,this.Fr=new Tr(n=>rs(n),Wo),this.lastRemoteSnapshotVersion=K.min(),this.highestTargetId=0,this.Mr=0,this.Or=new md,this.targetCount=0,this.Nr=cs.On()}forEachTarget(e,n){return this.Fr.forEach((r,s)=>n(s)),_.resolve()}getLastRemoteSnapshotVersion(e){return _.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return _.resolve(this.Mr)}allocateTargetId(e){return this.highestTargetId=this.Nr.next(),_.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Mr&&(this.Mr=n),_.resolve()}kn(e){this.Fr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.Nr=new cs(n),this.highestTargetId=n),e.sequenceNumber>this.Mr&&(this.Mr=e.sequenceNumber)}addTargetData(e,n){return this.kn(n),this.targetCount+=1,_.resolve()}updateTargetData(e,n){return this.kn(n),_.resolve()}removeTargetData(e,n){return this.Fr.delete(n.target),this.Or.Rr(n.targetId),this.targetCount-=1,_.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.Fr.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.Fr.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),s++)}),_.waitFor(i).next(()=>s)}getTargetCount(e){return _.resolve(this.targetCount)}getTargetData(e,n){const r=this.Fr.get(n)||null;return _.resolve(r)}addMatchingKeys(e,n,r){return this.Or.Er(n,r),_.resolve()}removeMatchingKeys(e,n,r){this.Or.Ar(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),_.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.Or.Rr(n),_.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Or.mr(n);return _.resolve(r)}containsKey(e,n){return _.resolve(this.Or.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uw{constructor(e,n){this.Lr={},this.overlays={},this.Br=new kt(0),this.kr=!1,this.kr=!0,this.referenceDelegate=e(this),this.qr=new WS(this),this.indexManager=new kS,this.remoteDocumentCache=function(s){return new GS(s)}(r=>this.referenceDelegate.Qr(r)),this.serializer=new xw(n),this.Kr=new jS(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.kr=!1,Promise.resolve()}get started(){return this.kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new zS,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.Lr[e.toKey()];return r||(r=new KS(n,this.referenceDelegate),this.Lr[e.toKey()]=r),r}getTargetCache(){return this.qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Kr}runTransaction(e,n,r){S("MemoryPersistence","Starting transaction:",e);const s=new QS(this.Br.next());return this.referenceDelegate.$r(),r(s).next(i=>this.referenceDelegate.Ur(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Wr(e,n){return _.or(Object.values(this.Lr).map(r=>()=>r.containsKey(e,n)))}}class QS extends ky{constructor(e){super(),this.currentSequenceNumber=e}}class sl{constructor(e){this.persistence=e,this.Gr=new md,this.zr=null}static jr(e){return new sl(e)}get Hr(){if(this.zr)return this.zr;throw $()}addReference(e,n,r){return this.Gr.addReference(r,n),this.Hr.delete(r.toString()),_.resolve()}removeReference(e,n,r){return this.Gr.removeReference(r,n),this.Hr.add(r.toString()),_.resolve()}markPotentiallyOrphaned(e,n){return this.Hr.add(n.toString()),_.resolve()}removeTarget(e,n){this.Gr.Rr(n.targetId).forEach(s=>this.Hr.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.Hr.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}$r(){this.zr=new Set}Ur(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return _.forEach(this.Hr,r=>{const s=N.fromPath(r);return this.Jr(e,s).next(i=>{i||n.removeEntry(s,K.min())})}).next(()=>(this.zr=null,n.apply(e)))}updateLimboDocument(e,n){return this.Jr(e,n).next(r=>{r?this.Hr.delete(n.toString()):this.Hr.add(n.toString())})}Qr(e){return 0}Jr(e,n){return _.or([()=>_.resolve(this.Gr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Wr(e,n)])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YS{constructor(e){this.serializer=e}O(e,n,r,s){const i=new Xc("createOrUpgrade",n);r<1&&s>=1&&(function(c){c.createObjectStore("owner")}(e),function(c){c.createObjectStore("mutationQueues",{keyPath:"userId"}),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Sm,{unique:!0}),c.createObjectStore("documentMutations")}(e),mp(e),function(c){c.createObjectStore("remoteDocuments")}(e));let o=_.resolve();return r<3&&s>=3&&(r!==0&&(function(c){c.deleteObjectStore("targetDocuments"),c.deleteObjectStore("targets"),c.deleteObjectStore("targetGlobal")}(e),mp(e)),o=o.next(()=>function(c){const l=c.store("targetGlobal"),u={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:K.min().toTimestamp(),targetCount:0};return l.put("targetGlobalKey",u)}(i))),r<4&&s>=4&&(r!==0&&(o=o.next(()=>function(c,l){return l.store("mutations").U().next(u=>{c.deleteObjectStore("mutations"),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Sm,{unique:!0});const h=l.store("mutations"),d=u.map(f=>h.put(f));return _.waitFor(d)})}(e,i))),o=o.next(()=>{(function(c){c.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&s>=5&&(o=o.next(()=>this.Zr(i))),r<6&&s>=6&&(o=o.next(()=>(function(c){c.createObjectStore("remoteDocumentGlobal")}(e),this.Xr(i)))),r<7&&s>=7&&(o=o.next(()=>this.ei(i))),r<8&&s>=8&&(o=o.next(()=>this.ti(e,i))),r<9&&s>=9&&(o=o.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&s>=10&&(o=o.next(()=>this.ni(i))),r<11&&s>=11&&(o=o.next(()=>{(function(c){c.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(c){c.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&s>=12&&(o=o.next(()=>{(function(c){const l=c.createObjectStore("documentOverlays",{keyPath:VP});l.createIndex("collectionPathOverlayIndex",NP,{unique:!1}),l.createIndex("collectionGroupOverlayIndex",OP,{unique:!1})})(e)})),r<13&&s>=13&&(o=o.next(()=>function(c){const l=c.createObjectStore("remoteDocumentsV14",{keyPath:vP});l.createIndex("documentKeyIndex",TP),l.createIndex("collectionGroupIndex",bP)}(e)).next(()=>this.ri(e,i)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&s>=14&&(o=o.next(()=>this.ii(e,i))),r<15&&s>=15&&(o=o.next(()=>function(c){c.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),c.createObjectStore("indexState",{keyPath:CP}).createIndex("sequenceNumberIndex",xP,{unique:!1}),c.createObjectStore("indexEntries",{keyPath:DP}).createIndex("documentKeyIndex",kP,{unique:!1})}(e))),r<16&&s>=16&&(o=o.next(()=>{n.objectStore("indexState").clear()}).next(()=>{n.objectStore("indexEntries").clear()})),o}Xr(e){let n=0;return e.store("remoteDocuments").J((r,s)=>{n+=hc(s)}).next(()=>{const r={byteSize:n};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}Zr(e){const n=e.store("mutationQueues"),r=e.store("mutations");return n.U().next(s=>_.forEach(s,i=>{const o=IDBKeyRange.bound([i.userId,-1],[i.userId,i.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",o).next(a=>_.forEach(a,c=>{z(c.userId===i.userId);const l=Br(this.serializer,c);return Nw(e,i.userId,l).next(()=>{})}))}))}ei(e){const n=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(s=>{const i=[];return r.J((o,a)=>{const c=new ae(o),l=function(h){return[0,bt(h)]}(c);i.push(n.get(l).next(u=>u?_.resolve():(h=>n.put({targetId:0,path:bt(h),sequenceNumber:s.highestListenSequenceNumber}))(c)))}).next(()=>_.waitFor(i))})}ti(e,n){e.createObjectStore("collectionParents",{keyPath:SP});const r=n.store("collectionParents"),s=new fd,i=o=>{if(s.add(o)){const a=o.lastSegment(),c=o.popLast();return r.put({collectionId:a,parent:bt(c)})}};return n.store("remoteDocuments").J({H:!0},(o,a)=>{const c=new ae(o);return i(c.popLast())}).next(()=>n.store("documentMutations").J({H:!0},([o,a,c],l)=>{const u=_n(a);return i(u.popLast())}))}ni(e){const n=e.store("targets");return n.J((r,s)=>{const i=Ki(s),o=Dw(this.serializer,i);return n.put(o)})}ri(e,n){const r=n.store("remoteDocuments"),s=[];return r.J((i,o)=>{const a=n.store("remoteDocumentsV14"),c=function(h){return h.document?new N(ae.fromString(h.document.name).popFirst(5)):h.noDocument?N.fromSegments(h.noDocument.path):h.unknownDocument?N.fromSegments(h.unknownDocument.path):$()}(o).path.toArray(),l={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};s.push(a.put(l))}).next(()=>_.waitFor(s))}ii(e,n){const r=n.store("mutations"),s=Lw(this.serializer),i=new Uw(sl.jr,this.serializer.ut);return r.U().next(o=>{const a=new Map;return o.forEach(c=>{var l;let u=(l=a.get(c.userId))!==null&&l!==void 0?l:re();Br(this.serializer,c).keys().forEach(h=>u=u.add(h)),a.set(c.userId,u)}),_.forEach(a,(c,l)=>{const u=new Ze(l),h=nl.ct(this.serializer,u),d=i.getIndexManager(u),f=rl.ct(u,this.serializer,d,i.referenceDelegate);return new Bw(s,f,h,d).recalculateAndSaveOverlaysForDocumentKeys(new Vu(n,kt.oe),c).next()})})}}function mp(t){t.createObjectStore("targetDocuments",{keyPath:RP}).createIndex("documentTargetsIndex",PP,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",AP,{unique:!0}),t.createObjectStore("targetGlobal")}const Wl="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class pd{constructor(e,n,r,s,i,o,a,c,l,u,h=16){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.si=i,this.window=o,this.document=a,this.oi=l,this._i=u,this.ai=h,this.Br=null,this.kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ui=null,this.inForeground=!1,this.ci=null,this.li=null,this.hi=Number.NEGATIVE_INFINITY,this.Pi=d=>Promise.resolve(),!pd.D())throw new P(E.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new BS(this,s),this.Ii=n+"main",this.serializer=new xw(c),this.Ti=new En(this.Ii,this.ai,new YS(this.serializer)),this.qr=new NS(this.referenceDelegate,this.serializer),this.remoteDocumentCache=Lw(this.serializer),this.Kr=new RS,this.window&&this.window.localStorage?this.Ei=this.window.localStorage:(this.Ei=null,u===!1&&je("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.di().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new P(E.FAILED_PRECONDITION,Wl);return this.Ai(),this.Ri(),this.Vi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.qr.getHighestSequenceNumber(e))}).then(e=>{this.Br=new kt(e,this.oi)}).then(()=>{this.kr=!0}).catch(e=>(this.Ti&&this.Ti.close(),Promise.reject(e)))}mi(e){return this.Pi=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ti.L(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.si.enqueueAndForget(async()=>{this.started&&await this.di()}))}di(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Ta(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.fi(e).next(n=>{n||(this.isPrimary=!1,this.si.enqueueRetryable(()=>this.Pi(!1)))})}).next(()=>this.gi(e)).next(n=>this.isPrimary&&!n?this.pi(e).next(()=>!1):!!n&&this.yi(e).next(()=>!0))).catch(e=>{if(vr(e))return S("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return S("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.si.enqueueRetryable(()=>this.Pi(e)),this.isPrimary=e})}fi(e){return Li(e).get("owner").next(n=>_.resolve(this.wi(n)))}Si(e){return Ta(e).delete(this.clientId)}async bi(){if(this.isPrimary&&!this.Di(this.hi,18e5)){this.hi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=rt(n,"clientMetadata");return r.U().next(s=>{const i=this.Ci(s,18e5),o=s.filter(a=>i.indexOf(a)===-1);return _.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Ei)for(const n of e)this.Ei.removeItem(this.vi(n.clientId))}}Vi(){this.li=this.si.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.di().then(()=>this.bi()).then(()=>this.Vi()))}wi(e){return!!e&&e.ownerId===this.clientId}gi(e){return this._i?_.resolve(!0):Li(e).get("owner").next(n=>{if(n!==null&&this.Di(n.leaseTimestampMs,5e3)&&!this.Fi(n.ownerId)){if(this.wi(n)&&this.networkEnabled)return!0;if(!this.wi(n)){if(!n.allowTabSynchronization)throw new P(E.FAILED_PRECONDITION,Wl);return!1}}return!(!this.networkEnabled||!this.inForeground)||Ta(e).U().next(r=>this.Ci(r,5e3).find(s=>{if(this.clientId!==s.clientId){const i=!this.networkEnabled&&s.networkEnabled,o=!this.inForeground&&s.inForeground,a=this.networkEnabled===s.networkEnabled;if(i||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&S("IndexedDbPersistence",`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.kr=!1,this.Mi(),this.li&&(this.li.cancel(),this.li=null),this.xi(),this.Oi(),await this.Ti.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const n=new Vu(e,kt.oe);return this.pi(n).next(()=>this.Si(n))}),this.Ti.close(),this.Ni()}Ci(e,n){return e.filter(r=>this.Di(r.updateTimeMs,n)&&!this.Fi(r.clientId))}Li(){return this.runTransaction("getActiveClients","readonly",e=>Ta(e).U().next(n=>this.Ci(n,18e5).map(r=>r.clientId)))}get started(){return this.kr}getMutationQueue(e,n){return rl.ct(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new VS(e,this.serializer.ut.databaseId)}getDocumentOverlayCache(e){return nl.ct(this.serializer,e)}getBundleCache(){return this.Kr}runTransaction(e,n,r){S("IndexedDbPersistence","Starting transaction:",e);const s=n==="readonly"?"readonly":"readwrite",i=function(c){return c===16?FP:c===15?By:c===14?Ly:c===13?Fy:c===12?MP:c===11?My:void $()}(this.ai);let o;return this.Ti.runTransaction(e,s,i,a=>(o=new Vu(a,this.Br?this.Br.next():kt.oe),n==="readwrite-primary"?this.fi(o).next(c=>!!c||this.gi(o)).next(c=>{if(!c)throw je(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.si.enqueueRetryable(()=>this.Pi(!1)),new P(E.FAILED_PRECONDITION,Dy);return r(o)}).next(c=>this.yi(o).next(()=>c)):this.Bi(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Bi(e){return Li(e).get("owner").next(n=>{if(n!==null&&this.Di(n.leaseTimestampMs,5e3)&&!this.Fi(n.ownerId)&&!this.wi(n)&&!(this._i||this.allowTabSynchronization&&n.allowTabSynchronization))throw new P(E.FAILED_PRECONDITION,Wl)})}yi(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Li(e).put("owner",n)}static D(){return En.D()}pi(e){const n=Li(e);return n.get("owner").next(r=>this.wi(r)?(S("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):_.resolve())}Di(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(je(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Ai(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.ci=()=>{this.si.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.di()))},this.document.addEventListener("visibilitychange",this.ci),this.inForeground=this.document.visibilityState==="visible")}xi(){this.ci&&(this.document.removeEventListener("visibilitychange",this.ci),this.ci=null)}Ri(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.ui=()=>{this.Mi();const n=/(?:Version|Mobile)\/1[456]/;c_()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.si.enterRestrictedMode(!0),this.si.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ui))}Oi(){this.ui&&(this.window.removeEventListener("pagehide",this.ui),this.ui=null)}Fi(e){var n;try{const r=((n=this.Ei)===null||n===void 0?void 0:n.getItem(this.vi(e)))!==null;return S("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return je("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Mi(){if(this.Ei)try{this.Ei.setItem(this.vi(this.clientId),String(Date.now()))}catch(e){je("Failed to set zombie client id.",e)}}Ni(){if(this.Ei)try{this.Ei.removeItem(this.vi(this.clientId))}catch{}}vi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Li(t){return rt(t,"owner")}function Ta(t){return rt(t,"clientMetadata")}function gd(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _d{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.ki=r,this.qi=s}static Qi(e,n){let r=re(),s=re();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new _d(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JS{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $w{constructor(){this.Ki=!1,this.$i=!1,this.Ui=100,this.Wi=function(){return c_()?8:Vy(Ja())>0?6:4}()}initialize(e,n){this.Gi=e,this.indexManager=n,this.Ki=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.zi(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.ji(e,n,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new JS;return this.Hi(e,n,o).next(a=>{if(i.result=a,this.$i)return this.Ji(e,n,o,a.size)})}).next(()=>i.result)}Ji(e,n,r,s){return r.documentReadCount<this.Ui?(Ss()<=le.DEBUG&&S("QueryEngine","SDK will not create cache indexes for query:",Cs(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Ui,"documents"),_.resolve()):(Ss()<=le.DEBUG&&S("QueryEngine","Query:",Cs(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.Wi*s?(Ss()<=le.DEBUG&&S("QueryEngine","The SDK decides to create cache indexes for query:",Cs(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,At(n))):_.resolve())}zi(e,n){if(Um(n))return _.resolve(null);let r=At(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=cc(n,null,"F"),r=At(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=re(...i);return this.Gi.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(c=>{const l=this.Yi(n,a);return this.Zi(n,l,o,c.readTime)?this.zi(e,cc(n,null,"F")):this.Xi(e,l,n,c)}))})))}ji(e,n,r,s){return Um(n)||s.isEqual(K.min())?_.resolve(null):this.Gi.getDocuments(e,r).next(i=>{const o=this.Yi(n,i);return this.Zi(n,o,r,s)?_.resolve(null):(Ss()<=le.DEBUG&&S("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Cs(n)),this.Xi(e,o,n,Cy(s,-1)).next(a=>a))})}Yi(e,n){let r=new Te(ew(e));return n.forEach((s,i)=>{Yo(e,i)&&(r=r.add(i))}),r}Zi(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Hi(e,n,r){return Ss()<=le.DEBUG&&S("QueryEngine","Using full collection scan to execute query:",Cs(n)),this.Gi.getDocumentsMatchingQuery(e,n,Bt.min(),r)}Xi(e,n,r,s){return this.Gi.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XS{constructor(e,n,r,s){this.persistence=e,this.es=n,this.serializer=s,this.ts=new Se(ee),this.ns=new Tr(i=>rs(i),Wo),this.rs=new Map,this.ss=e.getRemoteDocumentCache(),this.qr=e.getTargetCache(),this.Kr=e.getBundleCache(),this.os(r)}os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Bw(this.ss,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ss.setIndexManager(this.indexManager),this.es.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.ts))}}function qw(t,e,n,r){return new XS(t,e,n,r)}async function jw(t,e){const n=M(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.os(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],a=[];let c=re();for(const l of s){o.push(l.batchId);for(const u of l.mutations)c=c.add(u.key)}for(const l of i){a.push(l.batchId);for(const u of l.mutations)c=c.add(u.key)}return n.localDocuments.getDocuments(r,c).next(l=>({_s:l,removedBatchIds:o,addedBatchIds:a}))})})}function ZS(t,e){const n=M(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.ss.newChangeBuffer({trackRemovals:!0});return function(a,c,l,u){const h=l.batch,d=h.keys();let f=_.resolve();return d.forEach(y=>{f=f.next(()=>u.getEntry(c,y)).next(w=>{const I=l.docVersions.get(y);z(I!==null),w.version.compareTo(I)<0&&(h.applyToRemoteDocument(w,l),w.isValidDocument()&&(w.setReadTime(l.commitVersion),u.addEntry(w)))})}),f.next(()=>a.mutationQueue.removeMutationBatch(c,h))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let c=re();for(let l=0;l<a.mutationResults.length;++l)a.mutationResults[l].transformResults.length>0&&(c=c.add(a.batch.mutations[l].key));return c}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function zw(t){const e=M(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.qr.getLastRemoteSnapshotVersion(n))}function e1(t,e){const n=M(t),r=e.snapshotVersion;let s=n.ts;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.ss.newChangeBuffer({trackRemovals:!0});s=n.ts;const a=[];e.targetChanges.forEach((u,h)=>{const d=s.get(h);if(!d)return;a.push(n.qr.removeMatchingKeys(i,u.removedDocuments,h).next(()=>n.qr.addMatchingKeys(i,u.addedDocuments,h)));let f=d.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(h)!==null?f=f.withResumeToken(Je.EMPTY_BYTE_STRING,K.min()).withLastLimboFreeSnapshotVersion(K.min()):u.resumeToken.approximateByteSize()>0&&(f=f.withResumeToken(u.resumeToken,r)),s=s.insert(h,f),function(w,I,b){return w.resumeToken.approximateByteSize()===0||I.snapshotVersion.toMicroseconds()-w.snapshotVersion.toMicroseconds()>=3e8?!0:b.addedDocuments.size+b.modifiedDocuments.size+b.removedDocuments.size>0}(d,f,u)&&a.push(n.qr.updateTargetData(i,f))});let c=Nt(),l=re();if(e.documentUpdates.forEach(u=>{e.resolvedLimboDocuments.has(u)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(i,u))}),a.push(Kw(i,o,e.documentUpdates).next(u=>{c=u.us,l=u.cs})),!r.isEqual(K.min())){const u=n.qr.getLastRemoteSnapshotVersion(i).next(h=>n.qr.setTargetsMetadata(i,i.currentSequenceNumber,r));a.push(u)}return _.waitFor(a).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,c,l)).next(()=>c)}).then(i=>(n.ts=s,i))}function Kw(t,e,n){let r=re(),s=re();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=Nt();return n.forEach((a,c)=>{const l=i.get(a);c.isFoundDocument()!==l.isFoundDocument()&&(s=s.add(a)),c.isNoDocument()&&c.version.isEqual(K.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!l.isValidDocument()||c.version.compareTo(l.version)>0||c.version.compareTo(l.version)===0&&l.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):S("LocalStore","Ignoring outdated watch update for ",a,". Current version:",l.version," Watch version:",c.version)}),{us:o,cs:s}})}function t1(t,e){const n=M(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function oi(t,e){const n=M(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.qr.getTargetData(r,e).next(i=>i?(s=i,_.resolve(s)):n.qr.allocateTargetId(r).next(o=>(s=new Dn(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.qr.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.ts.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.ts=n.ts.insert(r.targetId,r),n.ns.set(e,r.targetId)),r})}async function ai(t,e,n){const r=M(t),s=r.ts.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!vr(o))throw o;S("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.ts=r.ts.remove(e),r.ns.delete(s.target)}function dc(t,e,n){const r=M(t);let s=K.min(),i=re();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,l,u){const h=M(c),d=h.ns.get(u);return d!==void 0?_.resolve(h.ts.get(d)):h.qr.getTargetData(l,u)}(r,o,At(e)).next(a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,r.qr.getMatchingKeysForTargetId(o,a.targetId).next(c=>{i=c})}).next(()=>r.es.getDocumentsMatchingQuery(o,e,n?s:K.min(),n?i:re())).next(a=>(Ww(r,Zy(e),a),{documents:a,ls:i})))}function Gw(t,e){const n=M(t),r=M(n.qr),s=n.ts.get(e);return s?Promise.resolve(s.target):n.persistence.runTransaction("Get target data","readonly",i=>r.ot(i,e).next(o=>o?o.target:null))}function Hw(t,e){const n=M(t),r=n.rs.get(e)||K.min();return n.persistence.runTransaction("Get new document changes","readonly",s=>n.ss.getAllFromCollectionGroup(s,e,Cy(r,-1),Number.MAX_SAFE_INTEGER)).then(s=>(Ww(n,e,s),s))}function Ww(t,e,n){let r=t.rs.get(e)||K.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.rs.set(e,r)}async function n1(t,e,n,r){const s=M(t);let i=re(),o=Nt();for(const l of n){const u=e.hs(l.metadata.name);l.document&&(i=i.add(u));const h=e.Ps(l);h.setReadTime(e.Is(l.metadata.readTime)),o=o.insert(u,h)}const a=s.ss.newChangeBuffer({trackRemovals:!0}),c=await oi(s,function(u){return At(Ei(ae.fromString(`__bundle__/docs/${u}`)))}(r));return s.persistence.runTransaction("Apply bundle documents","readwrite",l=>Kw(l,a,o).next(u=>(a.apply(l),u)).next(u=>s.qr.removeMatchingKeysForTargetId(l,c.targetId).next(()=>s.qr.addMatchingKeys(l,i,c.targetId)).next(()=>s.localDocuments.getLocalViewOfDocuments(l,u.us,u.cs)).next(()=>u.us)))}async function r1(t,e,n=re()){const r=await oi(t,At(hd(e.bundledQuery))),s=M(t);return s.persistence.runTransaction("Save named query","readwrite",i=>{const o=ze(e.readTime);if(r.snapshotVersion.compareTo(o)>=0)return s.Kr.saveNamedQuery(i,e);const a=r.withResumeToken(Je.EMPTY_BYTE_STRING,o);return s.ts=s.ts.insert(a.targetId,a),s.qr.updateTargetData(i,a).next(()=>s.qr.removeMatchingKeysForTargetId(i,r.targetId)).next(()=>s.qr.addMatchingKeys(i,n,r.targetId)).next(()=>s.Kr.saveNamedQuery(i,e))})}function pp(t,e){return`firestore_clients_${t}_${e}`}function gp(t,e,n){let r=`firestore_mutations_${t}_${n}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function Ql(t,e){return`firestore_targets_${t}_${e}`}class fc{constructor(e,n,r,s){this.user=e,this.batchId=n,this.state=r,this.error=s}static Ts(e,n,r){const s=JSON.parse(r);let i,o=typeof s=="object"&&["pending","acknowledged","rejected"].indexOf(s.state)!==-1&&(s.error===void 0||typeof s.error=="object");return o&&s.error&&(o=typeof s.error.message=="string"&&typeof s.error.code=="string",o&&(i=new P(s.error.code,s.error.message))),o?new fc(e,n,s.state,i):(je("SharedClientState",`Failed to parse mutation state for ID '${n}': ${r}`),null)}Es(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class to{constructor(e,n,r){this.targetId=e,this.state=n,this.error=r}static Ts(e,n){const r=JSON.parse(n);let s,i=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return i&&r.error&&(i=typeof r.error.message=="string"&&typeof r.error.code=="string",i&&(s=new P(r.error.code,r.error.message))),i?new to(e,r.state,s):(je("SharedClientState",`Failed to parse target state for ID '${e}': ${n}`),null)}Es(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class mc{constructor(e,n){this.clientId=e,this.activeTargetIds=n}static Ts(e,n){const r=JSON.parse(n);let s=typeof r=="object"&&r.activeTargetIds instanceof Array,i=sd();for(let o=0;s&&o<r.activeTargetIds.length;++o)s=Ny(r.activeTargetIds[o]),i=i.add(r.activeTargetIds[o]);return s?new mc(e,i):(je("SharedClientState",`Failed to parse client data for instance '${e}': ${n}`),null)}}class yd{constructor(e,n){this.clientId=e,this.onlineState=n}static Ts(e){const n=JSON.parse(e);return typeof n=="object"&&["Unknown","Online","Offline"].indexOf(n.onlineState)!==-1&&typeof n.clientId=="string"?new yd(n.clientId,n.onlineState):(je("SharedClientState",`Failed to parse online state: ${e}`),null)}}class Hu{constructor(){this.activeTargetIds=sd()}ds(e){this.activeTargetIds=this.activeTargetIds.add(e)}As(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Es(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Yl{constructor(e,n,r,s,i){this.window=e,this.si=n,this.persistenceKey=r,this.Rs=s,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Vs=this.fs.bind(this),this.gs=new Se(ee),this.started=!1,this.ps=[];const o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.ys=pp(this.persistenceKey,this.Rs),this.ws=function(c){return`firestore_sequence_number_${c}`}(this.persistenceKey),this.gs=this.gs.insert(this.Rs,new Hu),this.Ss=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.bs=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Ds=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.Cs=function(c){return`firestore_online_state_${c}`}(this.persistenceKey),this.vs=function(c){return`firestore_bundle_loaded_v2_${c}`}(this.persistenceKey),this.window.addEventListener("storage",this.Vs)}static D(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Li();for(const r of e){if(r===this.Rs)continue;const s=this.getItem(pp(this.persistenceKey,r));if(s){const i=mc.Ts(r,s);i&&(this.gs=this.gs.insert(i.clientId,i))}}this.Fs();const n=this.storage.getItem(this.Cs);if(n){const r=this.Ms(n);r&&this.xs(r)}for(const r of this.ps)this.fs(r);this.ps=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.ws,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Os(this.gs)}isActiveQueryTarget(e){let n=!1;return this.gs.forEach((r,s)=>{s.activeTargetIds.has(e)&&(n=!0)}),n}addPendingMutation(e){this.Ns(e,"pending")}updateMutationState(e,n,r){this.Ns(e,n,r),this.Ls(e)}addLocalQueryTarget(e){let n="not-current";if(this.isActiveQueryTarget(e)){const r=this.storage.getItem(Ql(this.persistenceKey,e));if(r){const s=to.Ts(e,r);s&&(n=s.state)}}return this.Bs.ds(e),this.Fs(),n}removeLocalQueryTarget(e){this.Bs.As(e),this.Fs()}isLocalQueryTarget(e){return this.Bs.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Ql(this.persistenceKey,e))}updateQueryState(e,n,r){this.ks(e,n,r)}handleUserChange(e,n,r){n.forEach(s=>{this.Ls(s)}),this.currentUser=e,r.forEach(s=>{this.addPendingMutation(s)})}setOnlineState(e){this.qs(e)}notifyBundleLoaded(e){this.Qs(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Vs),this.removeItem(this.ys),this.started=!1)}getItem(e){const n=this.storage.getItem(e);return S("SharedClientState","READ",e,n),n}setItem(e,n){S("SharedClientState","SET",e,n),this.storage.setItem(e,n)}removeItem(e){S("SharedClientState","REMOVE",e),this.storage.removeItem(e)}fs(e){const n=e;if(n.storageArea===this.storage){if(S("SharedClientState","EVENT",n.key,n.newValue),n.key===this.ys)return void je("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.si.enqueueRetryable(async()=>{if(this.started){if(n.key!==null){if(this.Ss.test(n.key)){if(n.newValue==null){const r=this.Ks(n.key);return this.$s(r,null)}{const r=this.Us(n.key,n.newValue);if(r)return this.$s(r.clientId,r)}}else if(this.bs.test(n.key)){if(n.newValue!==null){const r=this.Ws(n.key,n.newValue);if(r)return this.Gs(r)}}else if(this.Ds.test(n.key)){if(n.newValue!==null){const r=this.zs(n.key,n.newValue);if(r)return this.js(r)}}else if(n.key===this.Cs){if(n.newValue!==null){const r=this.Ms(n.newValue);if(r)return this.xs(r)}}else if(n.key===this.ws){const r=function(i){let o=kt.oe;if(i!=null)try{const a=JSON.parse(i);z(typeof a=="number"),o=a}catch(a){je("SharedClientState","Failed to read sequence number from WebStorage",a)}return o}(n.newValue);r!==kt.oe&&this.sequenceNumberHandler(r)}else if(n.key===this.vs){const r=this.Hs(n.newValue);await Promise.all(r.map(s=>this.syncEngine.Js(s)))}}}else this.ps.push(n)})}}get Bs(){return this.gs.get(this.Rs)}Fs(){this.setItem(this.ys,this.Bs.Es())}Ns(e,n,r){const s=new fc(this.currentUser,e,n,r),i=gp(this.persistenceKey,this.currentUser,e);this.setItem(i,s.Es())}Ls(e){const n=gp(this.persistenceKey,this.currentUser,e);this.removeItem(n)}qs(e){const n={clientId:this.Rs,onlineState:e};this.storage.setItem(this.Cs,JSON.stringify(n))}ks(e,n,r){const s=Ql(this.persistenceKey,e),i=new to(e,n,r);this.setItem(s,i.Es())}Qs(e){const n=JSON.stringify(Array.from(e));this.setItem(this.vs,n)}Ks(e){const n=this.Ss.exec(e);return n?n[1]:null}Us(e,n){const r=this.Ks(e);return mc.Ts(r,n)}Ws(e,n){const r=this.bs.exec(e),s=Number(r[1]),i=r[2]!==void 0?r[2]:null;return fc.Ts(new Ze(i),s,n)}zs(e,n){const r=this.Ds.exec(e),s=Number(r[1]);return to.Ts(s,n)}Ms(e){return yd.Ts(e)}Hs(e){return JSON.parse(e)}async Gs(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Ys(e.batchId,e.state,e.error);S("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}js(e){return this.syncEngine.Zs(e.targetId,e.state,e.error)}$s(e,n){const r=n?this.gs.insert(e,n):this.gs.remove(e),s=this.Os(this.gs),i=this.Os(r),o=[],a=[];return i.forEach(c=>{s.has(c)||o.push(c)}),s.forEach(c=>{i.has(c)||a.push(c)}),this.syncEngine.Xs(o,a).then(()=>{this.gs=r})}xs(e){this.gs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Os(e){let n=sd();return e.forEach((r,s)=>{n=n.unionWith(s.activeTargetIds)}),n}}class Qw{constructor(){this.eo=new Hu,this.no={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e){return this.eo.ds(e),this.no[e]||"not-current"}updateQueryState(e,n,r){this.no[e]=n}removeLocalQueryTarget(e){this.eo.As(e)}isLocalQueryTarget(e){return this.eo.activeTargetIds.has(e)}clearQueryState(e){delete this.no[e]}getAllActiveQueryTargets(){return this.eo.activeTargetIds}isActiveQueryTarget(e){return this.eo.activeTargetIds.has(e)}start(){return this.eo=new Hu,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s1{ro(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _p{constructor(){this.io=()=>this.so(),this.oo=()=>this._o(),this.ao=[],this.uo()}ro(e){this.ao.push(e)}shutdown(){window.removeEventListener("online",this.io),window.removeEventListener("offline",this.oo)}uo(){window.addEventListener("online",this.io),window.addEventListener("offline",this.oo)}so(){S("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ao)e(0)}_o(){S("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ao)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ba=null;function Jl(){return ba===null?ba=function(){return 268435456+Math.round(2147483648*Math.random())}():ba++,"0x"+ba.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i1={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o1{constructor(e){this.co=e.co,this.lo=e.lo}ho(e){this.Po=e}Io(e){this.To=e}Eo(e){this.Ao=e}onMessage(e){this.Ro=e}close(){this.lo()}send(e){this.co(e)}Vo(){this.Po()}mo(){this.To()}fo(e){this.Ao(e)}po(e){this.Ro(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lt="WebChannelConnection";class a1 extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.yo=r+"://"+n.host,this.wo=`projects/${s}/databases/${i}`,this.So=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}get bo(){return!1}Do(n,r,s,i,o){const a=Jl(),c=this.Co(n,r.toUriEncodedString());S("RestConnection",`Sending RPC '${n}' ${a}:`,c,s);const l={"google-cloud-resource-prefix":this.wo,"x-goog-request-params":this.So};return this.vo(l,i,o),this.Fo(n,c,l,s).then(u=>(S("RestConnection",`Received RPC '${n}' ${a}: `,u),u),u=>{throw on("RestConnection",`RPC '${n}' ${a} failed with error: `,u,"url: ",c,"request:",s),u})}Mo(n,r,s,i,o,a){return this.Do(n,r,s,i,o)}vo(n,r,s){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+wi}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,o)=>n[o]=i),s&&s.headers.forEach((i,o)=>n[o]=i)}Co(n,r){const s=i1[n];return`${this.yo}/v1/${r}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Fo(e,n,r,s){const i=Jl();return new Promise((o,a)=>{const c=new rP;c.setWithCredentials(!0),c.listenOnce(eP.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case Gl.NO_ERROR:const u=c.getResponseJson();S(lt,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(u)),o(u);break;case Gl.TIMEOUT:S(lt,`RPC '${e}' ${i} timed out`),a(new P(E.DEADLINE_EXCEEDED,"Request time out"));break;case Gl.HTTP_ERROR:const h=c.getStatus();if(S(lt,`RPC '${e}' ${i} failed with status:`,h,"response text:",c.getResponseText()),h>0){let d=c.getResponseJson();Array.isArray(d)&&(d=d[0]);const f=d==null?void 0:d.error;if(f&&f.status&&f.message){const y=function(I){const b=I.toLowerCase().replace(/_/g,"-");return Object.values(E).indexOf(b)>=0?b:E.UNKNOWN}(f.status);a(new P(y,f.message))}else a(new P(E.UNKNOWN,"Server responded with status "+c.getStatus()))}else a(new P(E.UNAVAILABLE,"Connection failed."));break;default:$()}}finally{S(lt,`RPC '${e}' ${i} completed.`)}});const l=JSON.stringify(s);S(lt,`RPC '${e}' ${i} sending request:`,s),c.send(n,"POST",l,r,15)})}xo(e,n,r){const s=Jl(),i=[this.yo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=XR(),a=ZR(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(c.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(c.xmlHttpFactory=new nP({})),this.vo(c.initMessageHeaders,n,r),c.encodeInitMessageHeaders=!0;const u=i.join("");S(lt,`Creating RPC '${e}' stream ${s}: ${u}`,c);const h=o.createWebChannel(u,c);let d=!1,f=!1;const y=new o1({co:I=>{f?S(lt,`Not sending because RPC '${e}' stream ${s} is closed:`,I):(d||(S(lt,`Opening RPC '${e}' stream ${s} transport.`),h.open(),d=!0),S(lt,`RPC '${e}' stream ${s} sending:`,I),h.send(I))},lo:()=>h.close()}),w=(I,b,D)=>{I.listen(b,R=>{try{D(R)}catch(B){setTimeout(()=>{throw B},0)}})};return w(h,wa.EventType.OPEN,()=>{f||(S(lt,`RPC '${e}' stream ${s} transport opened.`),y.Vo())}),w(h,wa.EventType.CLOSE,()=>{f||(f=!0,S(lt,`RPC '${e}' stream ${s} transport closed`),y.fo())}),w(h,wa.EventType.ERROR,I=>{f||(f=!0,on(lt,`RPC '${e}' stream ${s} transport errored:`,I),y.fo(new P(E.UNAVAILABLE,"The operation could not be completed")))}),w(h,wa.EventType.MESSAGE,I=>{var b;if(!f){const D=I.data[0];z(!!D);const R=D,B=R.error||((b=R[0])===null||b===void 0?void 0:b.error);if(B){S(lt,`RPC '${e}' stream ${s} received error:`,B);const Y=B.status;let Z=function(Ut){const Mt=He[Ut];if(Mt!==void 0)return mw(Mt)}(Y),ge=B.message;Z===void 0&&(Z=E.INTERNAL,ge="Unknown error status: "+Y+" with message "+B.message),f=!0,y.fo(new P(Z,ge)),h.close()}else S(lt,`RPC '${e}' stream ${s} received:`,D),y.po(D)}}),w(a,tP.STAT_EVENT,I=>{I.stat===bm.PROXY?S(lt,`RPC '${e}' stream ${s} detected buffering proxy`):I.stat===bm.NOPROXY&&S(lt,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{y.mo()},0),y}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yw(){return typeof window<"u"?window:null}function $a(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ea(t){return new pS(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wd{constructor(e,n,r=1e3,s=1.5,i=6e4){this.si=e,this.timerId=n,this.Oo=r,this.No=s,this.Lo=i,this.Bo=0,this.ko=null,this.qo=Date.now(),this.reset()}reset(){this.Bo=0}Qo(){this.Bo=this.Lo}Ko(e){this.cancel();const n=Math.floor(this.Bo+this.$o()),r=Math.max(0,Date.now()-this.qo),s=Math.max(0,n-r);s>0&&S("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Bo} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.ko=this.si.enqueueAfterDelay(this.timerId,s,()=>(this.qo=Date.now(),e())),this.Bo*=this.No,this.Bo<this.Oo&&(this.Bo=this.Oo),this.Bo>this.Lo&&(this.Bo=this.Lo)}Uo(){this.ko!==null&&(this.ko.skipDelay(),this.ko=null)}cancel(){this.ko!==null&&(this.ko.cancel(),this.ko=null)}$o(){return(Math.random()-.5)*this.Bo}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jw{constructor(e,n,r,s,i,o,a,c){this.si=e,this.Wo=r,this.Go=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.zo=0,this.jo=null,this.Ho=null,this.stream=null,this.Jo=new wd(e,n)}Yo(){return this.state===1||this.state===5||this.Zo()}Zo(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.Xo()}async stop(){this.Yo()&&await this.close(0)}e_(){this.state=0,this.Jo.reset()}t_(){this.Zo()&&this.jo===null&&(this.jo=this.si.enqueueAfterDelay(this.Wo,6e4,()=>this.n_()))}r_(e){this.i_(),this.stream.send(e)}async n_(){if(this.Zo())return this.close(0)}i_(){this.jo&&(this.jo.cancel(),this.jo=null)}s_(){this.Ho&&(this.Ho.cancel(),this.Ho=null)}async close(e,n){this.i_(),this.s_(),this.Jo.cancel(),this.zo++,e!==4?this.Jo.reset():n&&n.code===E.RESOURCE_EXHAUSTED?(je(n.toString()),je("Using maximum backoff delay to prevent overloading the backend."),this.Jo.Qo()):n&&n.code===E.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.o_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Eo(n)}o_(){}auth(){this.state=1;const e=this.__(this.zo),n=this.zo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.zo===n&&this.a_(r,s)},r=>{e(()=>{const s=new P(E.UNKNOWN,"Fetching auth token failed: "+r.message);return this.u_(s)})})}a_(e,n){const r=this.__(this.zo);this.stream=this.c_(e,n),this.stream.ho(()=>{r(()=>this.listener.ho())}),this.stream.Io(()=>{r(()=>(this.state=2,this.Ho=this.si.enqueueAfterDelay(this.Go,1e4,()=>(this.Zo()&&(this.state=3),Promise.resolve())),this.listener.Io()))}),this.stream.Eo(s=>{r(()=>this.u_(s))}),this.stream.onMessage(s=>{r(()=>this.onMessage(s))})}Xo(){this.state=5,this.Jo.Ko(async()=>{this.state=0,this.start()})}u_(e){return S("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}__(e){return n=>{this.si.enqueueAndForget(()=>this.zo===e?n():(S("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class c1 extends Jw{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}c_(e,n){return this.connection.xo("Listen",e,n)}onMessage(e){this.Jo.reset();const n=yS(this.serializer,e),r=function(i){if(!("targetChange"in i))return K.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?K.min():o.readTime?ze(o.readTime):K.min()}(e);return this.listener.l_(n,r)}h_(e){const n={};n.database=qu(this.serializer),n.addTarget=function(i,o){let a;const c=o.target;if(a=oc(c)?{documents:bw(i,c)}:{query:Aw(i,c)._t},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=yw(i,o.resumeToken);const l=Uu(i,o.expectedCount);l!==null&&(a.expectedCount=l)}else if(o.snapshotVersion.compareTo(K.min())>0){a.readTime=ii(i,o.snapshotVersion.toTimestamp());const l=Uu(i,o.expectedCount);l!==null&&(a.expectedCount=l)}return a}(this.serializer,e);const r=ES(this.serializer,e);r&&(n.labels=r),this.r_(n)}P_(e){const n={};n.database=qu(this.serializer),n.removeTarget=e,this.r_(n)}}class l1 extends Jw{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i,this.I_=!1}get T_(){return this.I_}start(){this.I_=!1,this.lastStreamToken=void 0,super.start()}o_(){this.I_&&this.E_([])}c_(e,n){return this.connection.xo("Write",e,n)}onMessage(e){if(z(!!e.streamToken),this.lastStreamToken=e.streamToken,this.I_){this.Jo.reset();const n=wS(e.writeResults,e.commitTime),r=ze(e.commitTime);return this.listener.d_(r,n)}return z(!e.writeResults||e.writeResults.length===0),this.I_=!0,this.listener.A_()}R_(){const e={};e.database=qu(this.serializer),this.r_(e)}E_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>ko(this.serializer,r))};this.r_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u1 extends class{}{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.V_=!1}m_(){if(this.V_)throw new P(E.FAILED_PRECONDITION,"The client has already been terminated.")}Do(e,n,r,s){return this.m_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Do(e,$u(n,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===E.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new P(E.UNKNOWN,i.toString())})}Mo(e,n,r,s,i){return this.m_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Mo(e,$u(n,r),s,o,a,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===E.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new P(E.UNKNOWN,o.toString())})}terminate(){this.V_=!0,this.connection.terminate()}}class h1{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.g_=0,this.p_=null,this.y_=!0}w_(){this.g_===0&&(this.S_("Unknown"),this.p_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.p_=null,this.b_("Backend didn't respond within 10 seconds."),this.S_("Offline"),Promise.resolve())))}D_(e){this.state==="Online"?this.S_("Unknown"):(this.g_++,this.g_>=1&&(this.C_(),this.b_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.S_("Offline")))}set(e){this.C_(),this.g_=0,e==="Online"&&(this.y_=!1),this.S_(e)}S_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}b_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.y_?(je(n),this.y_=!1):S("OnlineStateTracker",n)}C_(){this.p_!==null&&(this.p_.cancel(),this.p_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d1{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.v_=[],this.F_=new Map,this.M_=new Set,this.x_=[],this.O_=i,this.O_.ro(o=>{r.enqueueAndForget(async()=>{br(this)&&(S("RemoteStore","Restarting streams for network reachability change."),await async function(c){const l=M(c);l.M_.add(4),await Ti(l),l.N_.set("Unknown"),l.M_.delete(4),await ta(l)}(this))})}),this.N_=new h1(r,s)}}async function ta(t){if(br(t))for(const e of t.x_)await e(!0)}async function Ti(t){for(const e of t.x_)await e(!1)}function il(t,e){const n=M(t);n.F_.has(e.targetId)||(n.F_.set(e.targetId,e),vd(n)?Id(n):Ai(n).Zo()&&Ed(n,e))}function ci(t,e){const n=M(t),r=Ai(n);n.F_.delete(e),r.Zo()&&Xw(n,e),n.F_.size===0&&(r.Zo()?r.t_():br(n)&&n.N_.set("Unknown"))}function Ed(t,e){if(t.L_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(K.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Ai(t).h_(e)}function Xw(t,e){t.L_.xe(e),Ai(t).P_(e)}function Id(t){t.L_=new hS({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.F_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),Ai(t).start(),t.N_.w_()}function vd(t){return br(t)&&!Ai(t).Yo()&&t.F_.size>0}function br(t){return M(t).M_.size===0}function Zw(t){t.L_=void 0}async function f1(t){t.N_.set("Online")}async function m1(t){t.F_.forEach((e,n)=>{Ed(t,e)})}async function p1(t,e){Zw(t),vd(t)?(t.N_.D_(e),Id(t)):t.N_.set("Unknown")}async function g1(t,e,n){if(t.N_.set("Online"),e instanceof _w&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const a of i.targetIds)s.F_.has(a)&&(await s.remoteSyncer.rejectListen(a,o),s.F_.delete(a),s.L_.removeTarget(a))}(t,e)}catch(r){S("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await pc(t,r)}else if(e instanceof Ua?t.L_.Ke(e):e instanceof gw?t.L_.He(e):t.L_.We(e),!n.isEqual(K.min()))try{const r=await zw(t.localStore);n.compareTo(r)>=0&&await function(i,o){const a=i.L_.rt(o);return a.targetChanges.forEach((c,l)=>{if(c.resumeToken.approximateByteSize()>0){const u=i.F_.get(l);u&&i.F_.set(l,u.withResumeToken(c.resumeToken,o))}}),a.targetMismatches.forEach((c,l)=>{const u=i.F_.get(c);if(!u)return;i.F_.set(c,u.withResumeToken(Je.EMPTY_BYTE_STRING,u.snapshotVersion)),Xw(i,c);const h=new Dn(u.target,c,l,u.sequenceNumber);Ed(i,h)}),i.remoteSyncer.applyRemoteEvent(a)}(t,n)}catch(r){S("RemoteStore","Failed to raise snapshot:",r),await pc(t,r)}}async function pc(t,e,n){if(!vr(e))throw e;t.M_.add(1),await Ti(t),t.N_.set("Offline"),n||(n=()=>zw(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{S("RemoteStore","Retrying IndexedDB access"),await n(),t.M_.delete(1),await ta(t)})}function eE(t,e){return e().catch(n=>pc(t,n,e))}async function bi(t){const e=M(t),n=fr(e);let r=e.v_.length>0?e.v_[e.v_.length-1].batchId:-1;for(;_1(e);)try{const s=await t1(e.localStore,r);if(s===null){e.v_.length===0&&n.t_();break}r=s.batchId,y1(e,s)}catch(s){await pc(e,s)}tE(e)&&nE(e)}function _1(t){return br(t)&&t.v_.length<10}function y1(t,e){t.v_.push(e);const n=fr(t);n.Zo()&&n.T_&&n.E_(e.mutations)}function tE(t){return br(t)&&!fr(t).Yo()&&t.v_.length>0}function nE(t){fr(t).start()}async function w1(t){fr(t).R_()}async function E1(t){const e=fr(t);for(const n of t.v_)e.E_(n.mutations)}async function I1(t,e,n){const r=t.v_.shift(),s=ad.from(r,e,n);await eE(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await bi(t)}async function v1(t,e){e&&fr(t).T_&&await async function(r,s){if(function(o){return fw(o)&&o!==E.ABORTED}(s.code)){const i=r.v_.shift();fr(r).e_(),await eE(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await bi(r)}}(t,e),tE(t)&&nE(t)}async function yp(t,e){const n=M(t);n.asyncQueue.verifyOperationInProgress(),S("RemoteStore","RemoteStore received new credentials");const r=br(n);n.M_.add(3),await Ti(n),r&&n.N_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.M_.delete(3),await ta(n)}async function Wu(t,e){const n=M(t);e?(n.M_.delete(2),await ta(n)):e||(n.M_.add(2),await Ti(n),n.N_.set("Unknown"))}function Ai(t){return t.B_||(t.B_=function(n,r,s){const i=M(n);return i.m_(),new c1(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{ho:f1.bind(null,t),Io:m1.bind(null,t),Eo:p1.bind(null,t),l_:g1.bind(null,t)}),t.x_.push(async e=>{e?(t.B_.e_(),vd(t)?Id(t):t.N_.set("Unknown")):(await t.B_.stop(),Zw(t))})),t.B_}function fr(t){return t.k_||(t.k_=function(n,r,s){const i=M(n);return i.m_(),new l1(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{ho:()=>Promise.resolve(),Io:w1.bind(null,t),Eo:v1.bind(null,t),A_:E1.bind(null,t),d_:I1.bind(null,t)}),t.x_.push(async e=>{e?(t.k_.e_(),await bi(t)):(await t.k_.stop(),t.v_.length>0&&(S("RemoteStore",`Stopping write stream with ${t.v_.length} pending writes`),t.v_=[]))})),t.k_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Td{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new et,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,a=new Td(e,n,o,s,i);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new P(E.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Ri(t,e){if(je("AsyncQueue",`${e}: ${t}`),vr(t))return new P(E.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qs{constructor(e){this.comparator=e?(n,r)=>e(n,r)||N.comparator(n.key,r.key):(n,r)=>N.comparator(n.key,r.key),this.keyedMap=ji(),this.sortedSet=new Se(this.comparator)}static emptySet(e){return new qs(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof qs)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new qs;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wp{constructor(){this.q_=new Se(N.comparator)}track(e){const n=e.doc.key,r=this.q_.get(n);r?e.type!==0&&r.type===3?this.q_=this.q_.insert(n,e):e.type===3&&r.type!==1?this.q_=this.q_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.q_=this.q_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.q_=this.q_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.q_=this.q_.remove(n):e.type===1&&r.type===2?this.q_=this.q_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.q_=this.q_.insert(n,{type:2,doc:e.doc}):$():this.q_=this.q_.insert(n,e)}Q_(){const e=[];return this.q_.inorderTraversal((n,r)=>{e.push(r)}),e}}class li{constructor(e,n,r,s,i,o,a,c,l){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=l}static fromInitialDocuments(e,n,r,s,i){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new li(e,n,qs.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Qo(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T1{constructor(){this.K_=void 0,this.U_=[]}W_(){return this.U_.some(e=>e.G_())}}class b1{constructor(){this.queries=new Tr(e=>Xy(e),Qo),this.onlineState="Unknown",this.z_=new Set}}async function bd(t,e){const n=M(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.W_()&&e.G_()&&(r=2):(i=new T1,r=e.G_()?0:1);try{switch(r){case 0:i.K_=await n.onListen(s,!0);break;case 1:i.K_=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const a=Ri(o,`Initialization of query '${Cs(e.query)}' failed`);return void e.onError(a)}n.queries.set(s,i),i.U_.push(e),e.j_(n.onlineState),i.K_&&e.H_(i.K_)&&Rd(n)}async function Ad(t,e){const n=M(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const o=i.U_.indexOf(e);o>=0&&(i.U_.splice(o,1),i.U_.length===0?s=e.G_()?0:1:!i.W_()&&e.G_()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function A1(t,e){const n=M(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const a of o.U_)a.H_(s)&&(r=!0);o.K_=s}}r&&Rd(n)}function R1(t,e,n){const r=M(t),s=r.queries.get(e);if(s)for(const i of s.U_)i.onError(n);r.queries.delete(e)}function Rd(t){t.z_.forEach(e=>{e.next()})}var Qu,Ep;(Ep=Qu||(Qu={})).J_="default",Ep.Cache="cache";class Pd{constructor(e,n,r){this.query=e,this.Y_=n,this.Z_=!1,this.X_=null,this.onlineState="Unknown",this.options=r||{}}H_(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new li(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Z_?this.ea(e)&&(this.Y_.next(e),n=!0):this.ta(e,this.onlineState)&&(this.na(e),n=!0),this.X_=e,n}onError(e){this.Y_.error(e)}j_(e){this.onlineState=e;let n=!1;return this.X_&&!this.Z_&&this.ta(this.X_,e)&&(this.na(this.X_),n=!0),n}ta(e,n){if(!e.fromCache||!this.G_())return!0;const r=n!=="Offline";return(!this.options.ra||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ea(e){if(e.docChanges.length>0)return!0;const n=this.X_&&this.X_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}na(e){e=li.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Z_=!0,this.Y_.next(e)}G_(){return this.options.source!==Qu.Cache}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P1{constructor(e,n){this.ia=e,this.byteLength=n}sa(){return"metadata"in this.ia}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ip{constructor(e){this.serializer=e}hs(e){return In(this.serializer,e)}Ps(e){return e.metadata.exists?Tw(this.serializer,e.document,!1):De.newNoDocument(this.hs(e.metadata.name),this.Is(e.metadata.readTime))}Is(e){return ze(e)}}class S1{constructor(e,n,r){this.oa=e,this.localStore=n,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=rE(e)}_a(e){this.progress.bytesLoaded+=e.byteLength;let n=this.progress.documentsLoaded;if(e.ia.namedQuery)this.queries.push(e.ia.namedQuery);else if(e.ia.documentMetadata){this.documents.push({metadata:e.ia.documentMetadata}),e.ia.documentMetadata.exists||++n;const r=ae.fromString(e.ia.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.ia.document&&(this.documents[this.documents.length-1].document=e.ia.document,++n);return n!==this.progress.documentsLoaded?(this.progress.documentsLoaded=n,Object.assign({},this.progress)):null}aa(e){const n=new Map,r=new Ip(this.serializer);for(const s of e)if(s.metadata.queries){const i=r.hs(s.metadata.name);for(const o of s.metadata.queries){const a=(n.get(o)||re()).add(i);n.set(o,a)}}return n}async complete(){const e=await n1(this.localStore,new Ip(this.serializer),this.documents,this.oa.id),n=this.aa(this.documents);for(const r of this.queries)await r1(this.localStore,r,n.get(r.name));return this.progress.taskState="Success",{progress:this.progress,ua:this.collectionGroups,ca:e}}}function rE(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sE{constructor(e){this.key=e}}class iE{constructor(e){this.key=e}}class oE{constructor(e,n){this.query=e,this.la=n,this.ha=null,this.hasCachedResults=!1,this.current=!1,this.Pa=re(),this.mutatedKeys=re(),this.Ia=ew(e),this.Ta=new qs(this.Ia)}get Ea(){return this.la}da(e,n){const r=n?n.Aa:new wp,s=n?n.Ta:this.Ta;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,a=!1;const c=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,l=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((u,h)=>{const d=s.get(u),f=Yo(this.query,h)?h:null,y=!!d&&this.mutatedKeys.has(d.key),w=!!f&&(f.hasLocalMutations||this.mutatedKeys.has(f.key)&&f.hasCommittedMutations);let I=!1;d&&f?d.data.isEqual(f.data)?y!==w&&(r.track({type:3,doc:f}),I=!0):this.Ra(d,f)||(r.track({type:2,doc:f}),I=!0,(c&&this.Ia(f,c)>0||l&&this.Ia(f,l)<0)&&(a=!0)):!d&&f?(r.track({type:0,doc:f}),I=!0):d&&!f&&(r.track({type:1,doc:d}),I=!0,(c||l)&&(a=!0)),I&&(f?(o=o.add(f),i=w?i.add(u):i.delete(u)):(o=o.delete(u),i=i.delete(u)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const u=this.query.limitType==="F"?o.last():o.first();o=o.delete(u.key),i=i.delete(u.key),r.track({type:1,doc:u})}return{Ta:o,Aa:r,Zi:a,mutatedKeys:i}}Ra(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.Ta;this.Ta=e.Ta,this.mutatedKeys=e.mutatedKeys;const o=e.Aa.Q_();o.sort((u,h)=>function(f,y){const w=I=>{switch(I){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return $()}};return w(f)-w(y)}(u.type,h.type)||this.Ia(u.doc,h.doc)),this.Va(r),s=s!=null&&s;const a=n&&!s?this.ma():[],c=this.Pa.size===0&&this.current&&!s?1:0,l=c!==this.ha;return this.ha=c,o.length!==0||l?{snapshot:new li(this.query,e.Ta,i,o,e.mutatedKeys,c===0,l,!1,!!r&&r.resumeToken.approximateByteSize()>0),fa:a}:{fa:a}}j_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ta:this.Ta,Aa:new wp,mutatedKeys:this.mutatedKeys,Zi:!1},!1)):{fa:[]}}ga(e){return!this.la.has(e)&&!!this.Ta.has(e)&&!this.Ta.get(e).hasLocalMutations}Va(e){e&&(e.addedDocuments.forEach(n=>this.la=this.la.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.la=this.la.delete(n)),this.current=e.current)}ma(){if(!this.current)return[];const e=this.Pa;this.Pa=re(),this.Ta.forEach(r=>{this.ga(r.key)&&(this.Pa=this.Pa.add(r.key))});const n=[];return e.forEach(r=>{this.Pa.has(r)||n.push(new iE(r))}),this.Pa.forEach(r=>{e.has(r)||n.push(new sE(r))}),n}pa(e){this.la=e.ls,this.Pa=re();const n=this.da(e.documents);return this.applyChanges(n,!0)}ya(){return li.fromInitialDocuments(this.query,this.Ta,this.mutatedKeys,this.ha===0,this.hasCachedResults)}}class C1{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class x1{constructor(e){this.key=e,this.wa=!1}}class D1{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Sa={},this.ba=new Tr(a=>Xy(a),Qo),this.Da=new Map,this.Ca=new Set,this.va=new Se(N.comparator),this.Fa=new Map,this.Ma=new md,this.xa={},this.Oa=new Map,this.Na=cs.Nn(),this.onlineState="Unknown",this.La=void 0}get isPrimaryClient(){return this.La===!0}}async function k1(t,e,n=!0){const r=ol(t);let s;const i=r.ba.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.ya()):s=await aE(r,e,n,!0),s}async function V1(t,e){const n=ol(t);await aE(n,e,!0,!1)}async function aE(t,e,n,r){const s=await oi(t.localStore,At(e)),i=s.targetId,o=n?t.sharedClientState.addLocalQueryTarget(i):"not-current";let a;return r&&(a=await Sd(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&n&&il(t.remoteStore,s),a}async function Sd(t,e,n,r,s){t.Ba=(h,d,f)=>async function(w,I,b,D){let R=I.view.da(b);R.Zi&&(R=await dc(w.localStore,I.query,!1).then(({documents:ge})=>I.view.da(ge,R)));const B=D&&D.targetChanges.get(I.targetId),Y=D&&D.targetMismatches.get(I.targetId)!=null,Z=I.view.applyChanges(R,w.isPrimaryClient,B,Y);return Yu(w,I.targetId,Z.fa),Z.snapshot}(t,h,d,f);const i=await dc(t.localStore,e,!0),o=new oE(e,i.ls),a=o.da(i.documents),c=Zo.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),l=o.applyChanges(a,t.isPrimaryClient,c);Yu(t,n,l.fa);const u=new C1(e,n,o);return t.ba.set(e,u),t.Da.has(n)?t.Da.get(n).push(e):t.Da.set(n,[e]),l.snapshot}async function N1(t,e,n){const r=M(t),s=r.ba.get(e),i=r.Da.get(s.targetId);if(i.length>1)return r.Da.set(s.targetId,i.filter(o=>!Qo(o,e))),void r.ba.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await ai(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&ci(r.remoteStore,s.targetId),ui(r,s.targetId)}).catch(Ir)):(ui(r,s.targetId),await ai(r.localStore,s.targetId,!0))}async function O1(t,e){const n=M(t),r=n.ba.get(e),s=n.Da.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),ci(n.remoteStore,r.targetId))}async function M1(t,e,n){const r=kd(t);try{const s=await function(o,a){const c=M(o),l=Oe.now(),u=a.reduce((f,y)=>f.add(y.key),re());let h,d;return c.persistence.runTransaction("Locally write mutations","readwrite",f=>{let y=Nt(),w=re();return c.ss.getEntries(f,u).next(I=>{y=I,y.forEach((b,D)=>{D.isValidDocument()||(w=w.add(b))})}).next(()=>c.localDocuments.getOverlayedDocuments(f,y)).next(I=>{h=I;const b=[];for(const D of a){const R=cS(D,h.get(D.key).overlayedDocument);R!=null&&b.push(new $n(D.key,R,jy(R.value.mapValue),Ne.exists(!0)))}return c.mutationQueue.addMutationBatch(f,l,b,a)}).next(I=>{d=I;const b=I.applyToLocalDocumentSet(h,w);return c.documentOverlayCache.saveOverlays(f,I.batchId,b)})}).then(()=>({batchId:d.batchId,changes:nw(h)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,a,c){let l=o.xa[o.currentUser.toKey()];l||(l=new Se(ee)),l=l.insert(a,c),o.xa[o.currentUser.toKey()]=l}(r,s.batchId,n),await qn(r,s.changes),await bi(r.remoteStore)}catch(s){const i=Ri(s,"Failed to persist write");n.reject(i)}}async function cE(t,e){const n=M(t);try{const r=await e1(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.Fa.get(i);o&&(z(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.wa=!0:s.modifiedDocuments.size>0?z(o.wa):s.removedDocuments.size>0&&(z(o.wa),o.wa=!1))}),await qn(n,r,e)}catch(r){await Ir(r)}}function vp(t,e,n){const r=M(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.ba.forEach((i,o)=>{const a=o.view.j_(e);a.snapshot&&s.push(a.snapshot)}),function(o,a){const c=M(o);c.onlineState=a;let l=!1;c.queries.forEach((u,h)=>{for(const d of h.U_)d.j_(a)&&(l=!0)}),l&&Rd(c)}(r.eventManager,e),s.length&&r.Sa.l_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function F1(t,e,n){const r=M(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Fa.get(e),i=s&&s.key;if(i){let o=new Se(N.comparator);o=o.insert(i,De.newNoDocument(i,K.min()));const a=re().add(i),c=new Xo(K.min(),new Map,new Se(ee),o,a);await cE(r,c),r.va=r.va.remove(i),r.Fa.delete(e),Dd(r)}else await ai(r.localStore,e,!1).then(()=>ui(r,e,n)).catch(Ir)}async function L1(t,e){const n=M(t),r=e.batch.batchId;try{const s=await ZS(n.localStore,e);xd(n,r,null),Cd(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await qn(n,s)}catch(s){await Ir(s)}}async function B1(t,e,n){const r=M(t);try{const s=await function(o,a){const c=M(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let u;return c.mutationQueue.lookupMutationBatch(l,a).next(h=>(z(h!==null),u=h.keys(),c.mutationQueue.removeMutationBatch(l,h))).next(()=>c.mutationQueue.performConsistencyCheck(l)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(l,u,a)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,u)).next(()=>c.localDocuments.getDocuments(l,u))})}(r.localStore,e);xd(r,e,n),Cd(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await qn(r,s)}catch(s){await Ir(s)}}async function U1(t,e){const n=M(t);br(n.remoteStore)||S("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=await function(o){const a=M(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",c=>a.mutationQueue.getHighestUnacknowledgedBatchId(c))}(n.localStore);if(r===-1)return void e.resolve();const s=n.Oa.get(r)||[];s.push(e),n.Oa.set(r,s)}catch(r){const s=Ri(r,"Initialization of waitForPendingWrites() operation failed");e.reject(s)}}function Cd(t,e){(t.Oa.get(e)||[]).forEach(n=>{n.resolve()}),t.Oa.delete(e)}function xd(t,e,n){const r=M(t);let s=r.xa[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.xa[r.currentUser.toKey()]=s}}function ui(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Da.get(e))t.ba.delete(r),n&&t.Sa.ka(r,n);t.Da.delete(e),t.isPrimaryClient&&t.Ma.Rr(e).forEach(r=>{t.Ma.containsKey(r)||lE(t,r)})}function lE(t,e){t.Ca.delete(e.path.canonicalString());const n=t.va.get(e);n!==null&&(ci(t.remoteStore,n),t.va=t.va.remove(e),t.Fa.delete(n),Dd(t))}function Yu(t,e,n){for(const r of n)r instanceof sE?(t.Ma.addReference(r.key,e),$1(t,r)):r instanceof iE?(S("SyncEngine","Document no longer in limbo: "+r.key),t.Ma.removeReference(r.key,e),t.Ma.containsKey(r.key)||lE(t,r.key)):$()}function $1(t,e){const n=e.key,r=n.path.canonicalString();t.va.get(n)||t.Ca.has(r)||(S("SyncEngine","New document in limbo: "+n),t.Ca.add(r),Dd(t))}function Dd(t){for(;t.Ca.size>0&&t.va.size<t.maxConcurrentLimboResolutions;){const e=t.Ca.values().next().value;t.Ca.delete(e);const n=new N(ae.fromString(e)),r=t.Na.next();t.Fa.set(r,new x1(n)),t.va=t.va.insert(n,r),il(t.remoteStore,new Dn(At(Ei(n.path)),r,"TargetPurposeLimboResolution",kt.oe))}}async function qn(t,e,n){const r=M(t),s=[],i=[],o=[];r.ba.isEmpty()||(r.ba.forEach((a,c)=>{o.push(r.Ba(c,e,n).then(l=>{if((l||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(c.targetId,l!=null&&l.fromCache?"not-current":"current"),l){s.push(l);const u=_d.Qi(c.targetId,l);i.push(u)}}))}),await Promise.all(o),r.Sa.l_(s),await async function(c,l){const u=M(c);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>_.forEach(l,d=>_.forEach(d.ki,f=>u.persistence.referenceDelegate.addReference(h,d.targetId,f)).next(()=>_.forEach(d.qi,f=>u.persistence.referenceDelegate.removeReference(h,d.targetId,f)))))}catch(h){if(!vr(h))throw h;S("LocalStore","Failed to update sequence numbers: "+h)}for(const h of l){const d=h.targetId;if(!h.fromCache){const f=u.ts.get(d),y=f.snapshotVersion,w=f.withLastLimboFreeSnapshotVersion(y);u.ts=u.ts.insert(d,w)}}}(r.localStore,i))}async function q1(t,e){const n=M(t);if(!n.currentUser.isEqual(e)){S("SyncEngine","User change. New user:",e.toKey());const r=await jw(n.localStore,e);n.currentUser=e,function(i,o){i.Oa.forEach(a=>{a.forEach(c=>{c.reject(new P(E.CANCELLED,o))})}),i.Oa.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await qn(n,r._s)}}function j1(t,e){const n=M(t),r=n.Fa.get(e);if(r&&r.wa)return re().add(r.key);{let s=re();const i=n.Da.get(e);if(!i)return s;for(const o of i){const a=n.ba.get(o);s=s.unionWith(a.view.Ea)}return s}}async function z1(t,e){const n=M(t),r=await dc(n.localStore,e.query,!0),s=e.view.pa(r);return n.isPrimaryClient&&Yu(n,e.targetId,s.fa),s}async function K1(t,e){const n=M(t);return Hw(n.localStore,e).then(r=>qn(n,r))}async function G1(t,e,n,r){const s=M(t),i=await function(a,c){const l=M(a),u=M(l.mutationQueue);return l.persistence.runTransaction("Lookup mutation documents","readonly",h=>u.Cn(h,c).next(d=>d?l.localDocuments.getDocuments(h,d):_.resolve(null)))}(s.localStore,e);i!==null?(n==="pending"?await bi(s.remoteStore):n==="acknowledged"||n==="rejected"?(xd(s,e,r||null),Cd(s,e),function(a,c){M(M(a).mutationQueue).Fn(c)}(s.localStore,e)):$(),await qn(s,i)):S("SyncEngine","Cannot apply mutation batch with id: "+e)}async function H1(t,e){const n=M(t);if(ol(n),kd(n),e===!0&&n.La!==!0){const r=n.sharedClientState.getAllActiveQueryTargets(),s=await Tp(n,r.toArray());n.La=!0,await Wu(n.remoteStore,!0);for(const i of s)il(n.remoteStore,i)}else if(e===!1&&n.La!==!1){const r=[];let s=Promise.resolve();n.Da.forEach((i,o)=>{n.sharedClientState.isLocalQueryTarget(o)?r.push(o):s=s.then(()=>(ui(n,o),ai(n.localStore,o,!0))),ci(n.remoteStore,o)}),await s,await Tp(n,r),function(o){const a=M(o);a.Fa.forEach((c,l)=>{ci(a.remoteStore,l)}),a.Ma.Vr(),a.Fa=new Map,a.va=new Se(N.comparator)}(n),n.La=!1,await Wu(n.remoteStore,!1)}}async function Tp(t,e,n){const r=M(t),s=[],i=[];for(const o of e){let a;const c=r.Da.get(o);if(c&&c.length!==0){a=await oi(r.localStore,At(c[0]));for(const l of c){const u=r.ba.get(l),h=await z1(r,u);h.snapshot&&i.push(h.snapshot)}}else{const l=await Gw(r.localStore,o);a=await oi(r.localStore,l),await Sd(r,uE(l),o,!1,a.resumeToken)}s.push(a)}return r.Sa.l_(i),s}function uE(t){return Jy(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function W1(t){return function(n){return M(M(n).persistence).Li()}(M(t).localStore)}async function Q1(t,e,n,r){const s=M(t);if(s.La)return void S("SyncEngine","Ignoring unexpected query state notification.");const i=s.Da.get(e);if(i&&i.length>0)switch(n){case"current":case"not-current":{const o=await Hw(s.localStore,Zy(i[0])),a=Xo.createSynthesizedRemoteEventForCurrentChange(e,n==="current",Je.EMPTY_BYTE_STRING);await qn(s,o,a);break}case"rejected":await ai(s.localStore,e,!0),ui(s,e,r);break;default:$()}}async function Y1(t,e,n){const r=ol(t);if(r.La){for(const s of e){if(r.Da.has(s)&&r.sharedClientState.isActiveQueryTarget(s)){S("SyncEngine","Adding an already active target "+s);continue}const i=await Gw(r.localStore,s),o=await oi(r.localStore,i);await Sd(r,uE(i),o.targetId,!1,o.resumeToken),il(r.remoteStore,o)}for(const s of n)r.Da.has(s)&&await ai(r.localStore,s,!1).then(()=>{ci(r.remoteStore,s),ui(r,s)}).catch(Ir)}}function ol(t){const e=M(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=cE.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=j1.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=F1.bind(null,e),e.Sa.l_=A1.bind(null,e.eventManager),e.Sa.ka=R1.bind(null,e.eventManager),e}function kd(t){const e=M(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=L1.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=B1.bind(null,e),e}function J1(t,e,n){const r=M(t);(async function(i,o,a){try{const c=await o.getMetadata();if(await function(f,y){const w=M(f),I=ze(y.createTime);return w.persistence.runTransaction("hasNewerBundle","readonly",b=>w.Kr.getBundleMetadata(b,y.id)).then(b=>!!b&&b.createTime.compareTo(I)>=0)}(i.localStore,c))return await o.close(),a._completeWith(function(f){return{taskState:"Success",documentsLoaded:f.totalDocuments,bytesLoaded:f.totalBytes,totalDocuments:f.totalDocuments,totalBytes:f.totalBytes}}(c)),Promise.resolve(new Set);a._updateProgress(rE(c));const l=new S1(c,i.localStore,o.serializer);let u=await o.qa();for(;u;){const d=await l._a(u);d&&a._updateProgress(d),u=await o.qa()}const h=await l.complete();return await qn(i,h.ca,void 0),await function(f,y){const w=M(f);return w.persistence.runTransaction("Save bundle","readwrite",I=>w.Kr.saveBundleMetadata(I,y))}(i.localStore,c),a._completeWith(h.progress),Promise.resolve(h.ua)}catch(c){return on("SyncEngine",`Loading bundle failed with ${c}`),a._failWith(c),Promise.resolve(new Set)}})(r,e,n).then(s=>{r.sharedClientState.notifyBundleLoaded(s)})}class Ju{constructor(){this.synchronizeTabs=!1}async initialize(e){this.serializer=ea(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),await this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)}createGarbageCollectionScheduler(e,n){return null}createIndexBackfillerScheduler(e,n){return null}createLocalStore(e){return qw(this.persistence,new $w,e.initialUser,this.serializer)}createPersistence(e){return new Uw(sl.jr,this.serializer)}createSharedClientState(e){return new Qw}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class hE extends Ju{constructor(e,n,r){super(),this.Qa=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Qa.initialize(this,e),await kd(this.Qa.syncEngine),await bi(this.Qa.remoteStore),await this.persistence.mi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}createLocalStore(e){return qw(this.persistence,new $w,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new MS(r,e.asyncQueue,n)}createIndexBackfillerScheduler(e,n){const r=new wP(n,this.persistence);return new yP(e.asyncQueue,r)}createPersistence(e){const n=gd(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?xt.withCacheSize(this.cacheSizeBytes):xt.DEFAULT;return new pd(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,Yw(),$a(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new Qw}}class X1 extends hE{constructor(e,n){super(e,n,!1),this.Qa=e,this.cacheSizeBytes=n,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const n=this.Qa.syncEngine;this.sharedClientState instanceof Yl&&(this.sharedClientState.syncEngine={Ys:G1.bind(null,n),Zs:Q1.bind(null,n),Xs:Y1.bind(null,n),Li:W1.bind(null,n),Js:K1.bind(null,n)},await this.sharedClientState.start()),await this.persistence.mi(async r=>{await H1(this.Qa.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())})}createSharedClientState(e){const n=Yw();if(!Yl.D(n))throw new P(E.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=gd(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Yl(n,e.asyncQueue,r,e.clientId,e.initialUser)}}class Vd{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>vp(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=q1.bind(null,this.syncEngine),await Wu(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new b1}()}createDatastore(e){const n=ea(e.databaseInfo.databaseId),r=function(i){return new a1(i)}(e.databaseInfo);return function(i,o,a,c){return new u1(i,o,a,c)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,o,a){return new d1(r,s,i,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>vp(this.syncEngine,n,0),function(){return _p.D()?new _p:new s1}())}createSyncEngine(e,n){return function(s,i,o,a,c,l,u){const h=new D1(s,i,o,a,c,l);return u&&(h.La=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e;await async function(r){const s=M(r);S("RemoteStore","RemoteStore shutting down."),s.M_.add(5),await Ti(s),s.O_.shutdown(),s.N_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bp(t,e=10240){let n=0;return{async read(){if(n<t.byteLength){const r={value:t.slice(n,n+e),done:!1};return n+=e,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class al{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ka(this.observer.next,e)}error(e){this.observer.error?this.Ka(this.observer.error,e):je("Uncaught Error in snapshot listener:",e.toString())}$a(){this.muted=!0}Ka(e,n){this.muted||setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z1{constructor(e,n){this.Ua=e,this.serializer=n,this.metadata=new et,this.buffer=new Uint8Array,this.Wa=function(){return new TextDecoder("utf-8")}(),this.Ga().then(r=>{r&&r.sa()?this.metadata.resolve(r.ia.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r==null?void 0:r.ia)}`))},r=>this.metadata.reject(r))}close(){return this.Ua.cancel()}async getMetadata(){return this.metadata.promise}async qa(){return await this.getMetadata(),this.Ga()}async Ga(){const e=await this.za();if(e===null)return null;const n=this.Wa.decode(e),r=Number(n);isNaN(r)&&this.ja(`length string (${n}) is not valid number`);const s=await this.Ha(r);return new P1(JSON.parse(s),e.length+r)}Ja(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}async za(){for(;this.Ja()<0&&!await this.Ya(););if(this.buffer.length===0)return null;const e=this.Ja();e<0&&this.ja("Reached the end of bundle when a length string is expected.");const n=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),n}async Ha(e){for(;this.buffer.length<e;)await this.Ya()&&this.ja("Reached the end of bundle when more is expected.");const n=this.Wa.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),n}ja(e){throw this.Ua.cancel(),new Error(`Invalid bundle format: ${e}`)}async Ya(){const e=await this.Ua.read();if(!e.done){const n=new Uint8Array(this.buffer.length+e.value.length);n.set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n}return e.done}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eC{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new P(E.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const n=await async function(s,i){const o=M(s),a={documents:i.map(h=>Do(o.serializer,h))},c=await o.Mo("BatchGetDocuments",o.serializer.databaseId,ae.emptyPath(),a,i.length),l=new Map;c.forEach(h=>{const d=_S(o.serializer,h);l.set(d.key.toString(),d)});const u=[];return i.forEach(h=>{const d=l.get(h.toString());z(!!d),u.push(d)}),u}(this.datastore,e);return n.forEach(r=>this.recordVersion(r)),n}set(e,n){this.write(n.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,n){try{this.write(n.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new vi(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(n=>{e.delete(n.key.toString())}),e.forEach((n,r)=>{const s=N.fromPath(r);this.mutations.push(new id(s,this.precondition(s)))}),await async function(r,s){const i=M(r),o={writes:s.map(a=>ko(i.serializer,a))};await i.Do("Commit",i.serializer.databaseId,ae.emptyPath(),o)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let n;if(e.isFoundDocument())n=e.version;else{if(!e.isNoDocument())throw $();n=K.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!n.isEqual(r))throw new P(E.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),n)}precondition(e){const n=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&n?n.isEqual(K.min())?Ne.exists(!1):Ne.updateTime(n):Ne.none()}preconditionForUpdate(e){const n=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&n){if(n.isEqual(K.min()))throw new P(E.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Ne.updateTime(n)}return Ne.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tC{constructor(e,n,r,s,i){this.asyncQueue=e,this.datastore=n,this.options=r,this.updateFunction=s,this.deferred=i,this.Za=r.maxAttempts,this.Jo=new wd(this.asyncQueue,"transaction_retry")}Xa(){this.Za-=1,this.eu()}eu(){this.Jo.Ko(async()=>{const e=new eC(this.datastore),n=this.tu(e);n&&n.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(s=>{this.nu(s)}))}).catch(r=>{this.nu(r)})})}tu(e){try{const n=this.updateFunction(e);return!Ho(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}}nu(e){this.Za>0&&this.ru(e)?(this.Za-=1,this.asyncQueue.enqueueAndForget(()=>(this.eu(),Promise.resolve()))):this.deferred.reject(e)}ru(e){if(e.name==="FirebaseError"){const n=e.code;return n==="aborted"||n==="failed-precondition"||n==="already-exists"||!fw(n)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nC{constructor(e,n,r,s){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=Ze.UNAUTHENTICATED,this.clientId=Py.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,async i=>{S("FirestoreClient","Received user=",i.uid),await this.authCredentialListener(i),this.user=i}),this.appCheckCredentials.start(r,i=>(S("FirestoreClient","Received new app check token=",i),this.appCheckCredentialListener(i,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new P(E.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new et;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Ri(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function qa(t,e){t.asyncQueue.verifyOperationInProgress(),S("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await jw(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function Xu(t,e){t.asyncQueue.verifyOperationInProgress();const n=await Nd(t);S("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>yp(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>yp(e.remoteStore,s)),t._onlineComponents=e}function dE(t){return t.name==="FirebaseError"?t.code===E.FAILED_PRECONDITION||t.code===E.UNIMPLEMENTED:!(typeof DOMException<"u"&&t instanceof DOMException)||t.code===22||t.code===20||t.code===11}async function Nd(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){S("FirestoreClient","Using user provided OfflineComponentProvider");try{await qa(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!dE(n))throw n;on("Error using user provided cache. Falling back to memory cache: "+n),await qa(t,new Ju)}}else S("FirestoreClient","Using default OfflineComponentProvider"),await qa(t,new Ju);return t._offlineComponents}async function cl(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(S("FirestoreClient","Using user provided OnlineComponentProvider"),await Xu(t,t._uninitializedComponentsProvider._online)):(S("FirestoreClient","Using default OnlineComponentProvider"),await Xu(t,new Vd))),t._onlineComponents}function fE(t){return Nd(t).then(e=>e.persistence)}function Od(t){return Nd(t).then(e=>e.localStore)}function mE(t){return cl(t).then(e=>e.remoteStore)}function Md(t){return cl(t).then(e=>e.syncEngine)}function rC(t){return cl(t).then(e=>e.datastore)}async function hi(t){const e=await cl(t),n=e.eventManager;return n.onListen=k1.bind(null,e.syncEngine),n.onUnlisten=N1.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=V1.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=O1.bind(null,e.syncEngine),n}function sC(t){return t.asyncQueue.enqueue(async()=>{const e=await fE(t),n=await mE(t);return e.setNetworkEnabled(!0),function(s){const i=M(s);return i.M_.delete(0),ta(i)}(n)})}function iC(t){return t.asyncQueue.enqueue(async()=>{const e=await fE(t),n=await mE(t);return e.setNetworkEnabled(!1),async function(s){const i=M(s);i.M_.add(0),await Ti(i),i.N_.set("Offline")}(n)})}function oC(t,e){const n=new et;return t.asyncQueue.enqueueAndForget(async()=>async function(s,i,o){try{const a=await function(l,u){const h=M(l);return h.persistence.runTransaction("read document","readonly",d=>h.localDocuments.getDocument(d,u))}(s,i);a.isFoundDocument()?o.resolve(a):a.isNoDocument()?o.resolve(null):o.reject(new P(E.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){const c=Ri(a,`Failed to get document '${i} from cache`);o.reject(c)}}(await Od(t),e,n)),n.promise}function pE(t,e,n={}){const r=new et;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,a,c,l){const u=new al({next:d=>{o.enqueueAndForget(()=>Ad(i,h));const f=d.docs.has(a);!f&&d.fromCache?l.reject(new P(E.UNAVAILABLE,"Failed to get document because the client is offline.")):f&&d.fromCache&&c&&c.source==="server"?l.reject(new P(E.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(d)},error:d=>l.reject(d)}),h=new Pd(Ei(a.path),u,{includeMetadataChanges:!0,ra:!0});return bd(i,h)}(await hi(t),t.asyncQueue,e,n,r)),r.promise}function aC(t,e){const n=new et;return t.asyncQueue.enqueueAndForget(async()=>async function(s,i,o){try{const a=await dc(s,i,!0),c=new oE(i,a.ls),l=c.da(a.documents),u=c.applyChanges(l,!1);o.resolve(u.snapshot)}catch(a){const c=Ri(a,`Failed to execute query '${i} against cache`);o.reject(c)}}(await Od(t),e,n)),n.promise}function gE(t,e,n={}){const r=new et;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,a,c,l){const u=new al({next:d=>{o.enqueueAndForget(()=>Ad(i,h)),d.fromCache&&c.source==="server"?l.reject(new P(E.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):l.resolve(d)},error:d=>l.reject(d)}),h=new Pd(a,u,{includeMetadataChanges:!0,ra:!0});return bd(i,h)}(await hi(t),t.asyncQueue,e,n,r)),r.promise}function cC(t,e){const n=new al(e);return t.asyncQueue.enqueueAndForget(async()=>function(s,i){M(s).z_.add(i),i.next()}(await hi(t),n)),()=>{n.$a(),t.asyncQueue.enqueueAndForget(async()=>function(s,i){M(s).z_.delete(i)}(await hi(t),n))}}function lC(t,e,n,r){const s=function(o,a){let c;return c=typeof o=="string"?pw().encode(o):o,function(u,h){return new Z1(u,h)}(function(u,h){if(u instanceof Uint8Array)return bp(u,h);if(u instanceof ArrayBuffer)return bp(new Uint8Array(u),h);if(u instanceof ReadableStream)return u.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(c),a)}(n,ea(e));t.asyncQueue.enqueueAndForget(async()=>{J1(await Md(t),s,r)})}function uC(t,e){return t.asyncQueue.enqueue(async()=>function(r,s){const i=M(r);return i.persistence.runTransaction("Get named query","readonly",o=>i.Kr.getNamedQuery(o,s))}(await Od(t),e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _E(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ap=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fd(t,e,n){if(!n)throw new P(E.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function yE(t,e,n,r){if(e===!0&&r===!0)throw new P(E.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function Rp(t){if(!N.isDocumentKey(t))throw new P(E.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Pp(t){if(N.isDocumentKey(t))throw new P(E.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function ll(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":$()}function pe(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new P(E.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=ll(t);throw new P(E.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function wE(t,e){if(e<=0)throw new P(E.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sp{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new P(E.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new P(E.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}yE("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=_E((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new P(E.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new P(E.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new P(E.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class na{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Sp({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new P(E.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new P(E.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Sp(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new aP;switch(r.type){case"firstParty":return new hP(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new P(E.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=Ap.get(n);r&&(S("ComponentProvider","Removing Datastore"),Ap.delete(n),r.terminate())}(this),Promise.resolve()}}function hC(t,e,n,r={}){var s;const i=(t=pe(t,na))._getSettings(),o=`${e}:${n}`;if(i.host!=="firestore.googleapis.com"&&i.host!==o&&on("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},i),{host:o,ssl:!1})),r.mockUserToken){let a,c;if(typeof r.mockUserToken=="string")a=r.mockUserToken,c=Ze.MOCK_USER;else{a=o_(r.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const l=r.mockUserToken.sub||r.mockUserToken.user_id;if(!l)throw new P(E.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new Ze(l)}t._authCredentials=new cP(new Ry(a,c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Pt=class EE{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new EE(this.firestore,e,this._query)}},Fe=class IE{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new sr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new IE(this.firestore,e,this._key)}},sr=class vE extends Pt{constructor(e,n,r){super(e,n,Ei(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Fe(this.firestore,null,new N(e))}withConverter(e){return new vE(this.firestore,e,this._path)}};function TE(t,e,...n){if(t=be(t),Fd("collection","path",e),t instanceof na){const r=ae.fromString(e,...n);return Pp(r),new sr(t,null,r)}{if(!(t instanceof Fe||t instanceof sr))throw new P(E.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(ae.fromString(e,...n));return Pp(r),new sr(t.firestore,null,r)}}function dC(t,e){if(t=pe(t,na),Fd("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new P(E.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Pt(t,null,function(r){return new Un(ae.emptyPath(),r)}(e))}function gc(t,e,...n){if(t=be(t),arguments.length===1&&(e=Py.newId()),Fd("doc","path",e),t instanceof na){const r=ae.fromString(e,...n);return Rp(r),new Fe(t,null,new N(r))}{if(!(t instanceof Fe||t instanceof sr))throw new P(E.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(ae.fromString(e,...n));return Rp(r),new Fe(t.firestore,t instanceof sr?t.converter:null,new N(r))}}function bE(t,e){return t=be(t),e=be(e),(t instanceof Fe||t instanceof sr)&&(e instanceof Fe||e instanceof sr)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function AE(t,e){return t=be(t),e=be(e),t instanceof Pt&&e instanceof Pt&&t.firestore===e.firestore&&Qo(t._query,e._query)&&t.converter===e.converter}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fC{constructor(){this.iu=Promise.resolve(),this.su=[],this.ou=!1,this._u=[],this.au=null,this.uu=!1,this.cu=!1,this.lu=[],this.Jo=new wd(this,"async_queue_retry"),this.hu=()=>{const n=$a();n&&S("AsyncQueue","Visibility state changed to "+n.visibilityState),this.Jo.Uo()};const e=$a();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.hu)}get isShuttingDown(){return this.ou}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Pu(),this.Iu(e)}enterRestrictedMode(e){if(!this.ou){this.ou=!0,this.cu=e||!1;const n=$a();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.hu)}}enqueue(e){if(this.Pu(),this.ou)return new Promise(()=>{});const n=new et;return this.Iu(()=>this.ou&&this.cu?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.su.push(e),this.Tu()))}async Tu(){if(this.su.length!==0){try{await this.su[0](),this.su.shift(),this.Jo.reset()}catch(e){if(!vr(e))throw e;S("AsyncQueue","Operation failed with retryable error: "+e)}this.su.length>0&&this.Jo.Ko(()=>this.Tu())}}Iu(e){const n=this.iu.then(()=>(this.uu=!0,e().catch(r=>{this.au=r,this.uu=!1;const s=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw je("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.uu=!1,r))));return this.iu=n,n}enqueueAfterDelay(e,n,r){this.Pu(),this.lu.indexOf(e)>-1&&(n=0);const s=Td.createAndSchedule(this,e,n,r,i=>this.Eu(i));return this._u.push(s),s}Pu(){this.au&&$()}verifyOperationInProgress(){}async du(){let e;do e=this.iu,await e;while(e!==this.iu)}Au(e){for(const n of this._u)if(n.timerId===e)return!0;return!1}Ru(e){return this.du().then(()=>{this._u.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this._u)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.du()})}Vu(e){this.lu.push(e)}Eu(e){const n=this._u.indexOf(e);this._u.splice(n,1)}}function Zu(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const s=n;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(t,["next","error","complete"])}class mC{constructor(){this._progressObserver={},this._taskCompletionResolver=new et,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,n,r){this._progressObserver={next:e,error:n,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,n){return this._taskCompletionResolver.promise.then(e,n)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pC=-1;let qe=class extends na{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=function(){return new fC}(),this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||RE(this),this._firestoreClient.terminate()}};function st(t){return t._firestoreClient||RE(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function RE(t){var e,n,r;const s=t._freezeSettings(),i=function(a,c,l,u){return new UP(a,c,l,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,_E(u.experimentalLongPollingOptions),u.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._firestoreClient=new nC(t._authCredentials,t._appCheckCredentials,t._queue,i),!((n=s.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:s.localCache.kind,_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider})}function gC(t,e){SE(t=pe(t,qe));const n=st(t);if(n._uninitializedComponentsProvider)throw new P(E.FAILED_PRECONDITION,"SDK cache is already specified.");on("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const r=t._freezeSettings(),s=new Vd;return PE(n,s,new hE(s,r.cacheSizeBytes,e==null?void 0:e.forceOwnership))}function _C(t){SE(t=pe(t,qe));const e=st(t);if(e._uninitializedComponentsProvider)throw new P(E.FAILED_PRECONDITION,"SDK cache is already specified.");on("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=t._freezeSettings(),r=new Vd;return PE(e,r,new X1(r,n.cacheSizeBytes))}function PE(t,e,n){const r=new et;return t.asyncQueue.enqueue(async()=>{try{await qa(t,n),await Xu(t,e),r.resolve()}catch(s){const i=s;if(!dE(i))throw i;on("Error enabling indexeddb cache. Falling back to memory cache: "+i),r.reject(i)}}).then(()=>r.promise)}function yC(t){if(t._initialized&&!t._terminated)throw new P(E.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new et;return t._queue.enqueueAndForgetEvenWhileRestricted(async()=>{try{await async function(r){if(!En.D())return Promise.resolve();const s=r+"main";await En.delete(s)}(gd(t._databaseId,t._persistenceKey)),e.resolve()}catch(n){e.reject(n)}}),e.promise}function wC(t){return function(n){const r=new et;return n.asyncQueue.enqueueAndForget(async()=>U1(await Md(n),r)),r.promise}(st(t=pe(t,qe)))}function EC(t){return sC(st(t=pe(t,qe)))}function IC(t){return iC(st(t=pe(t,qe)))}function vC(t,e){const n=st(t=pe(t,qe)),r=new mC;return lC(n,t._databaseId,e,r),r}function TC(t,e){return uC(st(t=pe(t,qe)),e).then(n=>n?new Pt(t,null,n.query):null)}function SE(t){if(t._initialized||t._terminated)throw new P(E.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class An{constructor(e){this._byteString=e}static fromBase64String(e){try{return new An(Je.fromBase64String(e))}catch(n){throw new P(E.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new An(Je.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let mr=class{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new P(E.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ve(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let fs=class{constructor(e){this._methodName=e}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ul{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new P(E.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new P(E.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ee(this._lat,e._lat)||ee(this._long,e._long)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bC=/^__.*__$/;class AC{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new $n(e,this.data,this.fieldMask,n,this.fieldTransforms):new Ii(e,this.data,n,this.fieldTransforms)}}class CE{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new $n(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function xE(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw $()}}class hl{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.mu(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get fu(){return this.settings.fu}gu(e){return new hl(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}pu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.gu({path:r,yu:!1});return s.wu(e),s}Su(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.gu({path:r,yu:!1});return s.mu(),s}bu(e){return this.gu({path:void 0,yu:!0})}Du(e){return _c(e,this.settings.methodName,this.settings.Cu||!1,this.path,this.settings.vu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}mu(){if(this.path)for(let e=0;e<this.path.length;e++)this.wu(this.path.get(e))}wu(e){if(e.length===0)throw this.Du("Document fields must not be empty");if(xE(this.fu)&&bC.test(e))throw this.Du('Document fields cannot begin and end with "__"')}}class RC{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||ea(e)}Fu(e,n,r,s=!1){return new hl({fu:e,methodName:n,vu:r,path:Ve.emptyPath(),yu:!1,Cu:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function ms(t){const e=t._freezeSettings(),n=ea(t._databaseId);return new RC(t._databaseId,!!e.ignoreUndefinedProperties,n)}function dl(t,e,n,r,s,i={}){const o=t.Fu(i.merge||i.mergeFields?2:0,e,n,s);zd("Data must be an object, but it was:",o,r);const a=VE(r,o);let c,l;if(i.merge)c=new Vt(o.fieldMask),l=o.fieldTransforms;else if(i.mergeFields){const u=[];for(const h of i.mergeFields){const d=eh(e,h,n);if(!o.contains(d))throw new P(E.INVALID_ARGUMENT,`Field '${d}' is specified in your field mask but missing from your input data.`);OE(u,d)||u.push(d)}c=new Vt(u),l=o.fieldTransforms.filter(h=>c.covers(h.field))}else c=null,l=o.fieldTransforms;return new AC(new at(a),c,l)}class ra extends fs{_toFieldTransform(e){if(e.fu!==2)throw e.fu===1?e.Du(`${this._methodName}() can only appear at the top level of your update data`):e.Du(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof ra}}function DE(t,e,n){return new hl({fu:3,vu:e.settings.vu,methodName:t._methodName,yu:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class Ld extends fs{_toFieldTransform(e){return new Jo(e.path,new ri)}isEqual(e){return e instanceof Ld}}class Bd extends fs{constructor(e,n){super(e),this.Mu=n}_toFieldTransform(e){const n=DE(this,e,!0),r=this.Mu.map(i=>ps(i,n)),s=new ss(r);return new Jo(e.path,s)}isEqual(e){return e instanceof Bd&&fo(this.Mu,e.Mu)}}class Ud extends fs{constructor(e,n){super(e),this.Mu=n}_toFieldTransform(e){const n=DE(this,e,!0),r=this.Mu.map(i=>ps(i,n)),s=new is(r);return new Jo(e.path,s)}isEqual(e){return e instanceof Ud&&fo(this.Mu,e.Mu)}}class $d extends fs{constructor(e,n){super(e),this.xu=n}_toFieldTransform(e){const n=new si(e.serializer,ow(e.serializer,this.xu));return new Jo(e.path,n)}isEqual(e){return e instanceof $d&&this.xu===e.xu}}function qd(t,e,n,r){const s=t.Fu(1,e,n);zd("Data must be an object, but it was:",s,r);const i=[],o=at.empty();ds(r,(c,l)=>{const u=Kd(e,c,n);l=be(l);const h=s.Su(u);if(l instanceof ra)i.push(u);else{const d=ps(l,h);d!=null&&(i.push(u),o.set(u,d))}});const a=new Vt(i);return new CE(o,a,s.fieldTransforms)}function jd(t,e,n,r,s,i){const o=t.Fu(1,e,n),a=[eh(e,r,n)],c=[s];if(i.length%2!=0)throw new P(E.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let d=0;d<i.length;d+=2)a.push(eh(e,i[d])),c.push(i[d+1]);const l=[],u=at.empty();for(let d=a.length-1;d>=0;--d)if(!OE(l,a[d])){const f=a[d];let y=c[d];y=be(y);const w=o.Su(f);if(y instanceof ra)l.push(f);else{const I=ps(y,w);I!=null&&(l.push(f),u.set(f,I))}}const h=new Vt(l);return new CE(u,h,o.fieldTransforms)}function kE(t,e,n,r=!1){return ps(n,t.Fu(r?4:3,e))}function ps(t,e){if(NE(t=be(t)))return zd("Unsupported field value:",e,t),VE(t,e);if(t instanceof fs)return function(r,s){if(!xE(s.fu))throw s.Du(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Du(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.yu&&e.fu!==4)throw e.Du("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const a of r){let c=ps(a,s.bu(o));c==null&&(c={nullValue:"NULL_VALUE"}),i.push(c),o++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=be(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return ow(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=Oe.fromDate(r);return{timestampValue:ii(s.serializer,i)}}if(r instanceof Oe){const i=new Oe(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:ii(s.serializer,i)}}if(r instanceof ul)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof An)return{bytesValue:yw(s.serializer,r._byteString)};if(r instanceof Fe){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Du(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:ud(r.firestore._databaseId||s.databaseId,r._key.path)}}throw s.Du(`Unsupported field value: ${ll(r)}`)}(t,e)}function VE(t,e){const n={};return Uy(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ds(t,(r,s)=>{const i=ps(s,e.pu(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function NE(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Oe||t instanceof ul||t instanceof An||t instanceof Fe||t instanceof fs)}function zd(t,e,n){if(!NE(n)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(n)){const r=ll(n);throw r==="an object"?e.Du(t+" a custom object"):e.Du(t+" "+r)}}function eh(t,e,n){if((e=be(e))instanceof mr)return e._internalPath;if(typeof e=="string")return Kd(t,e);throw _c("Field path arguments must be of type string or ",t,!1,void 0,n)}const PC=new RegExp("[~\\*/\\[\\]]");function Kd(t,e,n){if(e.search(PC)>=0)throw _c(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new mr(...e.split("."))._internalPath}catch{throw _c(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function _c(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(i||o)&&(c+=" (found",i&&(c+=` in field ${r}`),o&&(c+=` in document ${s}`),c+=")"),new P(E.INVALID_ARGUMENT,a+t+c)}function OE(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vo{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Fe(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new SC(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(fl("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class SC extends Vo{data(){return super.data()}}function fl(t,e){return typeof e=="string"?Kd(t,e):e instanceof mr?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ME(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new P(E.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Gd{}class sa extends Gd{}function Qn(t,e,...n){let r=[];e instanceof Gd&&r.push(e),r=r.concat(n),function(i){const o=i.filter(c=>c instanceof Hd).length,a=i.filter(c=>c instanceof ml).length;if(o>1||o>0&&a>0)throw new P(E.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class ml extends sa{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new ml(e,n,r)}_apply(e){const n=this._parse(e);return LE(e._query,n),new Pt(e.firestore,e.converter,Bu(e._query,n))}_parse(e){const n=ms(e.firestore);return function(i,o,a,c,l,u,h){let d;if(l.isKeyField()){if(u==="array-contains"||u==="array-contains-any")throw new P(E.INVALID_ARGUMENT,`Invalid Query. You can't perform '${u}' queries on documentId().`);if(u==="in"||u==="not-in"){xp(h,u);const f=[];for(const y of h)f.push(Cp(c,i,y));d={arrayValue:{values:f}}}else d=Cp(c,i,h)}else u!=="in"&&u!=="not-in"&&u!=="array-contains-any"||xp(h,u),d=kE(a,o,h,u==="in"||u==="not-in");return ce.create(l,u,d)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function CC(t,e,n){const r=e,s=fl("where",t);return ml._create(s,r,n)}class Hd extends Gd{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Hd(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:we.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let o=s;const a=i.getFlattenedFilters();for(const c of a)LE(o,c),o=Bu(o,c)}(e._query,n),new Pt(e.firestore,e.converter,Bu(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Wd extends sa{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new Wd(e,n)}_apply(e){const n=function(s,i,o){if(s.startAt!==null)throw new P(E.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new P(E.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new xo(i,o)}(e._query,this._field,this._direction);return new Pt(e.firestore,e.converter,function(s,i){const o=s.explicitOrderBy.concat([i]);return new Un(s.path,s.collectionGroup,o,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,n))}}function xC(t,e="asc"){const n=e,r=fl("orderBy",t);return Wd._create(r,n)}class pl extends sa{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new pl(e,n,r)}_apply(e){return new Pt(e.firestore,e.converter,cc(e._query,this._limit,this._limitType))}}function DC(t){return wE("limit",t),pl._create("limit",t,"F")}function kC(t){return wE("limitToLast",t),pl._create("limitToLast",t,"L")}class gl extends sa{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new gl(e,n,r)}_apply(e){const n=FE(e,this.type,this._docOrFields,this._inclusive);return new Pt(e.firestore,e.converter,function(s,i){return new Un(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,i,s.endAt)}(e._query,n))}}function VC(...t){return gl._create("startAt",t,!0)}function NC(...t){return gl._create("startAfter",t,!1)}class _l extends sa{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new _l(e,n,r)}_apply(e){const n=FE(e,this.type,this._docOrFields,this._inclusive);return new Pt(e.firestore,e.converter,function(s,i){return new Un(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,s.startAt,i)}(e._query,n))}}function OC(...t){return _l._create("endBefore",t,!1)}function MC(...t){return _l._create("endAt",t,!0)}function FE(t,e,n,r){if(n[0]=be(n[0]),n[0]instanceof Vo)return function(i,o,a,c,l){if(!c)throw new P(E.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);const u=[];for(const h of $s(i))if(h.field.isKeyField())u.push(ns(o,c.key));else{const d=c.data.field(h.field);if(Zc(d))throw new P(E.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+h.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(d===null){const f=h.field.canonicalString();throw new P(E.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${f}' (used as the orderBy) does not exist.`)}u.push(d)}return new dr(u,l)}(t._query,t.firestore._databaseId,e,n[0]._document,r);{const s=ms(t.firestore);return function(o,a,c,l,u,h){const d=o.explicitOrderBy;if(u.length>d.length)throw new P(E.INVALID_ARGUMENT,`Too many arguments provided to ${l}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const f=[];for(let y=0;y<u.length;y++){const w=u[y];if(d[y].field.isKeyField()){if(typeof w!="string")throw new P(E.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${l}(), but got a ${typeof w}`);if(!rd(o)&&w.indexOf("/")!==-1)throw new P(E.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${l}() must be a plain document ID, but '${w}' contains a slash.`);const I=o.path.child(ae.fromString(w));if(!N.isDocumentKey(I))throw new P(E.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${l}() must result in a valid document path, but '${I}' is not because it contains an odd number of segments.`);const b=new N(I);f.push(ns(a,b))}else{const I=kE(c,l,w);f.push(I)}}return new dr(f,h)}(t._query,t.firestore._databaseId,s,e,n,r)}}function Cp(t,e,n){if(typeof(n=be(n))=="string"){if(n==="")throw new P(E.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!rd(e)&&n.indexOf("/")!==-1)throw new P(E.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(ae.fromString(n));if(!N.isDocumentKey(r))throw new P(E.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return ns(t,new N(r))}if(n instanceof Fe)return ns(t,n._key);throw new P(E.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${ll(n)}.`)}function xp(t,e){if(!Array.isArray(t)||t.length===0)throw new P(E.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function LE(t,e){const n=function(s,i){for(const o of s)for(const a of o.getFlattenedFilters())if(i.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new P(E.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new P(E.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class Qd{convertValue(e,n="none"){switch(ts(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ue(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(lr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 10:return this.convertObject(e.mapValue,n);default:throw $()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return ds(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertGeoPoint(e){return new ul(Ue(e.latitude),Ue(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=td(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Po(e));default:return null}}convertTimestamp(e){const n=Fn(e);return new Oe(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=ae.fromString(e);z(Cw(r));const s=new ur(r.get(1),r.get(3)),i=new N(r.popFirst(5));return s.isEqual(n)||je(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yl(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class FC extends Qd{constructor(e){super(),this.firestore=e}convertBytes(e){return new An(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Fe(this.firestore,null,n)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gr{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}let Ln=class extends Vo{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new no(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(fl("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}},no=class extends Ln{data(e={}){return super.data(e)}},pr=class{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new Gr(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new no(this._firestore,this._userDataWriter,r.key,r,new Gr(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new P(E.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(a=>{const c=new no(s._firestore,s._userDataWriter,a.doc.key,a.doc,new Gr(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(a=>i||a.type!==3).map(a=>{const c=new no(s._firestore,s._userDataWriter,a.doc.key,a.doc,new Gr(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);let l=-1,u=-1;return a.type!==0&&(l=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),u=o.indexOf(a.doc.key)),{type:LC(a.type),doc:c,oldIndex:l,newIndex:u}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}};function LC(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return $()}}function BE(t,e){return t instanceof Ln&&e instanceof Ln?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(t._document===null?e._document===null:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof pr&&e instanceof pr&&t._firestore===e._firestore&&AE(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BC(t){t=pe(t,Fe);const e=pe(t.firestore,qe);return pE(st(e),t._key).then(n=>Yd(e,t,n))}class gs extends Qd{constructor(e){super(),this.firestore=e}convertBytes(e){return new An(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Fe(this.firestore,null,n)}}function UC(t){t=pe(t,Fe);const e=pe(t.firestore,qe),n=st(e),r=new gs(e);return oC(n,t._key).then(s=>new Ln(e,r,t._key,s,new Gr(s!==null&&s.hasLocalMutations,!0),t.converter))}function $C(t){t=pe(t,Fe);const e=pe(t.firestore,qe);return pE(st(e),t._key,{source:"server"}).then(n=>Yd(e,t,n))}function qC(t){t=pe(t,Pt);const e=pe(t.firestore,qe),n=st(e),r=new gs(e);return ME(t._query),gE(n,t._query).then(s=>new pr(e,r,t,s))}function jC(t){t=pe(t,Pt);const e=pe(t.firestore,qe),n=st(e),r=new gs(e);return aC(n,t._query).then(s=>new pr(e,r,t,s))}function zC(t){t=pe(t,Pt);const e=pe(t.firestore,qe),n=st(e),r=new gs(e);return gE(n,t._query,{source:"server"}).then(s=>new pr(e,r,t,s))}function Dp(t,e,n){t=pe(t,Fe);const r=pe(t.firestore,qe),s=yl(t.converter,e,n);return ia(r,[dl(ms(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,Ne.none())])}function kp(t,e,n,...r){t=pe(t,Fe);const s=pe(t.firestore,qe),i=ms(s);let o;return o=typeof(e=be(e))=="string"||e instanceof mr?jd(i,"updateDoc",t._key,e,n,r):qd(i,"updateDoc",t._key,e),ia(s,[o.toMutation(t._key,Ne.exists(!0))])}function KC(t){return ia(pe(t.firestore,qe),[new vi(t._key,Ne.none())])}function GC(t,e){const n=pe(t.firestore,qe),r=gc(t),s=yl(t.converter,e);return ia(n,[dl(ms(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,Ne.exists(!1))]).then(()=>r)}function UE(t,...e){var n,r,s;t=be(t);let i={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||Zu(e[o])||(i=e[o],o++);const a={includeMetadataChanges:i.includeMetadataChanges,source:i.source};if(Zu(e[o])){const h=e[o];e[o]=(n=h.next)===null||n===void 0?void 0:n.bind(h),e[o+1]=(r=h.error)===null||r===void 0?void 0:r.bind(h),e[o+2]=(s=h.complete)===null||s===void 0?void 0:s.bind(h)}let c,l,u;if(t instanceof Fe)l=pe(t.firestore,qe),u=Ei(t._key.path),c={next:h=>{e[o]&&e[o](Yd(l,t,h))},error:e[o+1],complete:e[o+2]};else{const h=pe(t,Pt);l=pe(h.firestore,qe),u=h._query;const d=new gs(l);c={next:f=>{e[o]&&e[o](new pr(l,d,h,f))},error:e[o+1],complete:e[o+2]},ME(t._query)}return function(d,f,y,w){const I=new al(w),b=new Pd(f,I,y);return d.asyncQueue.enqueueAndForget(async()=>bd(await hi(d),b)),()=>{I.$a(),d.asyncQueue.enqueueAndForget(async()=>Ad(await hi(d),b))}}(st(l),u,a,c)}function HC(t,e){return cC(st(t=pe(t,qe)),Zu(e)?e:{next:e})}function ia(t,e){return function(r,s){const i=new et;return r.asyncQueue.enqueueAndForget(async()=>M1(await Md(r),s,i)),i.promise}(st(t),e)}function Yd(t,e,n){const r=n.docs.get(e._key),s=new gs(t);return new Ln(t,s,e._key,r,new Gr(n.hasPendingWrites,n.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WC={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let QC=class{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=ms(e)}set(e,n,r){this._verifyNotCommitted();const s=Zn(e,this._firestore),i=yl(s.converter,n,r),o=dl(this._dataReader,"WriteBatch.set",s._key,i,s.converter!==null,r);return this._mutations.push(o.toMutation(s._key,Ne.none())),this}update(e,n,r,...s){this._verifyNotCommitted();const i=Zn(e,this._firestore);let o;return o=typeof(n=be(n))=="string"||n instanceof mr?jd(this._dataReader,"WriteBatch.update",i._key,n,r,s):qd(this._dataReader,"WriteBatch.update",i._key,n),this._mutations.push(o.toMutation(i._key,Ne.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=Zn(e,this._firestore);return this._mutations=this._mutations.concat(new vi(n._key,Ne.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new P(E.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function Zn(t,e){if((t=be(t)).firestore!==e)throw new P(E.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let YC=class extends class{constructor(n,r){this._firestore=n,this._transaction=r,this._dataReader=ms(n)}get(n){const r=Zn(n,this._firestore),s=new FC(this._firestore);return this._transaction.lookup([r._key]).then(i=>{if(!i||i.length!==1)return $();const o=i[0];if(o.isFoundDocument())return new Vo(this._firestore,s,o.key,o,r.converter);if(o.isNoDocument())return new Vo(this._firestore,s,r._key,null,r.converter);throw $()})}set(n,r,s){const i=Zn(n,this._firestore),o=yl(i.converter,r,s),a=dl(this._dataReader,"Transaction.set",i._key,o,i.converter!==null,s);return this._transaction.set(i._key,a),this}update(n,r,s,...i){const o=Zn(n,this._firestore);let a;return a=typeof(r=be(r))=="string"||r instanceof mr?jd(this._dataReader,"Transaction.update",o._key,r,s,i):qd(this._dataReader,"Transaction.update",o._key,r),this._transaction.update(o._key,a),this}delete(n){const r=Zn(n,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,n){super(e,n),this._firestore=e}get(e){const n=Zn(e,this._firestore),r=new gs(this._firestore);return super.get(e).then(s=>new Ln(this._firestore,r,n._key,s._document,new Gr(!1,!1),n.converter))}};function JC(t,e,n){t=pe(t,qe);const r=Object.assign(Object.assign({},WC),n);return function(i){if(i.maxAttempts<1)throw new P(E.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(i,o,a){const c=new et;return i.asyncQueue.enqueueAndForget(async()=>{const l=await rC(i);new tC(i.asyncQueue,l,a,o,c).Xa()}),c.promise}(st(t),s=>e(new YC(t,s)),r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XC(){return new ra("deleteField")}function ZC(){return new Ld("serverTimestamp")}function ex(...t){return new Bd("arrayUnion",t)}function tx(...t){return new Ud("arrayRemove",t)}function nx(t){return new $d("increment",t)}(function(e,n=!0){(function(s){wi=s})(Mc),es(new On("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),a=new qe(new lP(r.getProvider("auth-internal")),new fP(r.getProvider("app-check-internal")),function(l,u){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new P(E.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ur(l.options.projectId,u)}(o,s),o);return i=Object.assign({useFetchStreams:n},i),a._setSettings(i),a},"PUBLIC").setMultipleInstances(!0)),nn(Am,"4.6.1",e),nn(Am,"4.6.1","esm2017")})();const rx="@firebase/firestore-compat",sx="0.3.30";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jd(t,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new P("invalid-argument",`Invalid options passed to function ${t}(): You cannot specify both "merge" and "mergeFields".`);return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vp(){if(typeof Uint8Array>"u")throw new P("unimplemented","Uint8Arrays are not available in this environment.")}function Np(){if(!LP())throw new P("unimplemented","Blobs are unavailable in Firestore in this environment.")}let $E=class th{constructor(e){this._delegate=e}static fromBase64String(e){return Np(),new th(An.fromBase64String(e))}static fromUint8Array(e){return Vp(),new th(An.fromUint8Array(e))}toBase64(){return Np(),this._delegate.toBase64()}toUint8Array(){return Vp(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nh(t){return ix(t,["next","error","complete"])}function ix(t,e){if(typeof t!="object"||t===null)return!1;const n=t;for(const r of e)if(r in n&&typeof n[r]=="function")return!0;return!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ox{enableIndexedDbPersistence(e,n){return gC(e._delegate,{forceOwnership:n})}enableMultiTabIndexedDbPersistence(e){return _C(e._delegate)}clearIndexedDbPersistence(e){return yC(e._delegate)}}class qE{constructor(e,n,r){this._delegate=n,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof ur||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const n=this._delegate._getSettings();!e.merge&&n.host!==e.host&&on("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},n),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,n,r={}){hC(this._delegate,e,n,r)}enableNetwork(){return EC(this._delegate)}disableNetwork(){return IC(this._delegate)}enablePersistence(e){let n=!1,r=!1;return e&&(n=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,yE("synchronizeTabs",n,"experimentalForceOwningTab",r)),n?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return wC(this._delegate)}onSnapshotsInSync(e){return HC(this._delegate,e)}get app(){if(!this._appCompat)throw new P("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new di(this,TE(this._delegate,e))}catch(n){throw wt(n,"collection()","Firestore.collection()")}}doc(e){try{return new zt(this,gc(this._delegate,e))}catch(n){throw wt(n,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new yt(this,dC(this._delegate,e))}catch(n){throw wt(n,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return JC(this._delegate,n=>e(new jE(this,n)))}batch(){return st(this._delegate),new zE(new QC(this._delegate,e=>ia(this._delegate,e)))}loadBundle(e){return vC(this._delegate,e)}namedQuery(e){return TC(this._delegate,e).then(n=>n?new yt(this,n):null)}}class wl extends Qd{constructor(e){super(),this.firestore=e}convertBytes(e){return new $E(new An(e))}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return zt.forKey(n,this.firestore,null)}}function ax(t){iP(t)}class jE{constructor(e,n){this._firestore=e,this._delegate=n,this._userDataWriter=new wl(e)}get(e){const n=Hr(e);return this._delegate.get(n).then(r=>new No(this._firestore,new Ln(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,n.converter)))}set(e,n,r){const s=Hr(e);return r?(Jd("Transaction.set",r),this._delegate.set(s,n,r)):this._delegate.set(s,n),this}update(e,n,r,...s){const i=Hr(e);return arguments.length===2?this._delegate.update(i,n):this._delegate.update(i,n,r,...s),this}delete(e){const n=Hr(e);return this._delegate.delete(n),this}}class zE{constructor(e){this._delegate=e}set(e,n,r){const s=Hr(e);return r?(Jd("WriteBatch.set",r),this._delegate.set(s,n,r)):this._delegate.set(s,n),this}update(e,n,r,...s){const i=Hr(e);return arguments.length===2?this._delegate.update(i,n):this._delegate.update(i,n,r,...s),this}delete(e){const n=Hr(e);return this._delegate.delete(n),this}commit(){return this._delegate.commit()}}class ls{constructor(e,n,r){this._firestore=e,this._userDataWriter=n,this._delegate=r}fromFirestore(e,n){const r=new no(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new Oo(this._firestore,r),n??{})}toFirestore(e,n){return n?this._delegate.toFirestore(e,n):this._delegate.toFirestore(e)}static getInstance(e,n){const r=ls.INSTANCES;let s=r.get(e);s||(s=new WeakMap,r.set(e,s));let i=s.get(n);return i||(i=new ls(e,new wl(e),n),s.set(n,i)),i}}ls.INSTANCES=new WeakMap;class zt{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new wl(e)}static forPath(e,n,r){if(e.length%2!==0)throw new P("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new zt(n,new Fe(n._delegate,r,new N(e)))}static forKey(e,n,r){return new zt(n,new Fe(n._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new di(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new di(this.firestore,TE(this._delegate,e))}catch(n){throw wt(n,"collection()","DocumentReference.collection()")}}isEqual(e){return e=be(e),e instanceof Fe?bE(this._delegate,e):!1}set(e,n){n=Jd("DocumentReference.set",n);try{return n?Dp(this._delegate,e,n):Dp(this._delegate,e)}catch(r){throw wt(r,"setDoc()","DocumentReference.set()")}}update(e,n,...r){try{return arguments.length===1?kp(this._delegate,e):kp(this._delegate,e,n,...r)}catch(s){throw wt(s,"updateDoc()","DocumentReference.update()")}}delete(){return KC(this._delegate)}onSnapshot(...e){const n=KE(e),r=GE(e,s=>new No(this.firestore,new Ln(this.firestore._delegate,this._userDataWriter,s._key,s._document,s.metadata,this._delegate.converter)));return UE(this._delegate,n,r)}get(e){let n;return(e==null?void 0:e.source)==="cache"?n=UC(this._delegate):(e==null?void 0:e.source)==="server"?n=$C(this._delegate):n=BC(this._delegate),n.then(r=>new No(this.firestore,new Ln(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new zt(this.firestore,e?this._delegate.withConverter(ls.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function wt(t,e,n){return t.message=t.message.replace(e,n),t}function KE(t){for(const e of t)if(typeof e=="object"&&!nh(e))return e;return{}}function GE(t,e){var n,r;let s;return nh(t[0])?s=t[0]:nh(t[1])?s=t[1]:typeof t[0]=="function"?s={next:t[0],error:t[1],complete:t[2]}:s={next:t[1],error:t[2],complete:t[3]},{next:i=>{s.next&&s.next(e(i))},error:(n=s.error)===null||n===void 0?void 0:n.bind(s),complete:(r=s.complete)===null||r===void 0?void 0:r.bind(s)}}class No{constructor(e,n){this._firestore=e,this._delegate=n}get ref(){return new zt(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,n){return this._delegate.get(e,n)}isEqual(e){return BE(this._delegate,e._delegate)}}class Oo extends No{data(e){const n=this._delegate.data(e);return this._delegate._converter||oP(n!==void 0),n}}class yt{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new wl(e)}where(e,n,r){try{return new yt(this.firestore,Qn(this._delegate,CC(e,n,r)))}catch(s){throw wt(s,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,n){try{return new yt(this.firestore,Qn(this._delegate,xC(e,n)))}catch(r){throw wt(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new yt(this.firestore,Qn(this._delegate,DC(e)))}catch(n){throw wt(n,"limit()","Query.limit()")}}limitToLast(e){try{return new yt(this.firestore,Qn(this._delegate,kC(e)))}catch(n){throw wt(n,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new yt(this.firestore,Qn(this._delegate,VC(...e)))}catch(n){throw wt(n,"startAt()","Query.startAt()")}}startAfter(...e){try{return new yt(this.firestore,Qn(this._delegate,NC(...e)))}catch(n){throw wt(n,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new yt(this.firestore,Qn(this._delegate,OC(...e)))}catch(n){throw wt(n,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new yt(this.firestore,Qn(this._delegate,MC(...e)))}catch(n){throw wt(n,"endAt()","Query.endAt()")}}isEqual(e){return AE(this._delegate,e._delegate)}get(e){let n;return(e==null?void 0:e.source)==="cache"?n=jC(this._delegate):(e==null?void 0:e.source)==="server"?n=zC(this._delegate):n=qC(this._delegate),n.then(r=>new rh(this.firestore,new pr(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){const n=KE(e),r=GE(e,s=>new rh(this.firestore,new pr(this.firestore._delegate,this._userDataWriter,this._delegate,s._snapshot)));return UE(this._delegate,n,r)}withConverter(e){return new yt(this.firestore,e?this._delegate.withConverter(ls.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}class cx{constructor(e,n){this._firestore=e,this._delegate=n}get type(){return this._delegate.type}get doc(){return new Oo(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class rh{constructor(e,n){this._firestore=e,this._delegate=n}get query(){return new yt(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new Oo(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(n=>new cx(this._firestore,n))}forEach(e,n){this._delegate.forEach(r=>{e.call(n,new Oo(this._firestore,r))})}isEqual(e){return BE(this._delegate,e._delegate)}}class di extends yt{constructor(e,n){super(e,n),this.firestore=e,this._delegate=n}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new zt(this.firestore,e):null}doc(e){try{return e===void 0?new zt(this.firestore,gc(this._delegate)):new zt(this.firestore,gc(this._delegate,e))}catch(n){throw wt(n,"doc()","CollectionReference.doc()")}}add(e){return GC(this._delegate,e).then(n=>new zt(this.firestore,n))}isEqual(e){return bE(this._delegate,e._delegate)}withConverter(e){return new di(this.firestore,e?this._delegate.withConverter(ls.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function Hr(t){return pe(t,Fe)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xd{constructor(...e){this._delegate=new mr(...e)}static documentId(){return new Xd(Ve.keyField().canonicalString())}isEqual(e){return e=be(e),e instanceof mr?this._delegate._internalPath.isEqual(e._internalPath):!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qr{constructor(e){this._delegate=e}static serverTimestamp(){const e=ZC();return e._methodName="FieldValue.serverTimestamp",new qr(e)}static delete(){const e=XC();return e._methodName="FieldValue.delete",new qr(e)}static arrayUnion(...e){const n=ex(...e);return n._methodName="FieldValue.arrayUnion",new qr(n)}static arrayRemove(...e){const n=tx(...e);return n._methodName="FieldValue.arrayRemove",new qr(n)}static increment(e){const n=nx(e);return n._methodName="FieldValue.increment",new qr(n)}isEqual(e){return this._delegate.isEqual(e._delegate)}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lx={Firestore:qE,GeoPoint:ul,Timestamp:Oe,Blob:$E,Transaction:jE,WriteBatch:zE,DocumentReference:zt,DocumentSnapshot:No,Query:yt,QueryDocumentSnapshot:Oo,QuerySnapshot:rh,CollectionReference:di,FieldPath:Xd,FieldValue:qr,setLogLevel:ax,CACHE_SIZE_UNLIMITED:pC};function ux(t,e){t.INTERNAL.registerComponent(new On("firestore-compat",n=>{const r=n.getProvider("app-compat").getImmediate(),s=n.getProvider("firestore").getImmediate();return e(r,s)},"PUBLIC").setServiceProps(Object.assign({},lx)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hx(t){ux(t,(e,n)=>new qE(e,n,new ox)),t.registerVersion(rx,sx)}hx(me);const Sn=gi({items:[],get total(){return this.items.reduce((t,e)=>t+e.product.price*e.quantity,0)},get itemCount(){return this.items.reduce((t,e)=>t+e.quantity,0)},addItem(t){const e=this.items.find(n=>n.product.id===t.id);e?e.quantity++:this.items.push({product:t,quantity:1}),this.saveToStorage()},removeItem(t){this.items.splice(t,1),this.saveToStorage()},updateQuantity(t,e){e<=0?this.removeItem(t):(this.items[t].quantity=e,this.saveToStorage())},clearCart(){this.items=[],this.saveToStorage()},saveToStorage(){localStorage.setItem("foodiex_cart",JSON.stringify(this.items))},loadFromStorage(){const t=localStorage.getItem("foodiex_cart");t&&(this.items=JSON.parse(t))}});Sn.loadFromStorage();const dx={name:"ProductList",data(){return{storeName:"",products:[],categories:[],selectedCategoryId:null}},computed:{cartItemCount(){return Sn.itemCount}},created(){this.initializeFirebase(),this.fetchCategories()},methods:{initializeFirebase(){const t={apiKey:"AIzaSyASwq11lvLT6YfaGwp7W_dCBICDzVsBbSM",authDomain:"bankapp-9798a.firebaseapp.com",projectId:"bankapp-9798a",storageBucket:"bankapp-9798a.appspot.com",messagingSenderId:"868698601721",appId:"1:868698601721:web:e061dcefcb437f53854a28",measurementId:"G-WY7R44DDM4"};me.apps.length||me.initializeApp(t)},fetchCategories(){me.firestore().collection("categories").get().then(e=>{this.categories=[],e.forEach(n=>{const r=n.data();r.receivingOrders===!0&&(r.id=n.id,this.categories.push(r))}),this.categories.length>0&&(this.selectedCategoryId=this.categories[0].id,this.fetchProducts(this.selectedCategoryId))})},fetchProducts(t){const e=me.firestore();e.collection("categories").doc(t).collection("products").get().then(n=>{this.products=[],n.forEach(r=>{const s=r.data();s.id=r.id,this.products.push(s)}),e.collection("categories").doc(t).get().then(r=>{r.exists?this.storeName=r.data().name:this.storeName=""})})},switchCategory(t){this.selectedCategoryId=t,this.fetchProducts(t)},addToCart(t){Sn.addItem(t),this.showAddToCartFeedback(t)},showAddToCartFeedback(t){const e=document.createElement("div");e.className="toast-notification",e.innerHTML=`
        <div class="d-flex align-items-center">
          <i class="fa fa-check-circle text-success me-2"></i>
          <span>${t.name} added to cart!</span>
        </div>
      `,e.style.cssText=`
        position: fixed;
        top: 80px;
        right: 20px;
        background: white;
        padding: 12px 20px;
        border-radius: 8px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        z-index: 1000;
        animation: slideInRight 0.3s ease;
      `,document.body.appendChild(e),setTimeout(()=>{e.style.animation="slideOutRight 0.3s ease",setTimeout(()=>{document.body.removeChild(e)},300)},2500)}}},El=t=>(gr("data-v-c7ea1408"),t=t(),_r(),t),fx={class:"navbar navbar-light bg-light mb-3 appbar"},mx={class:"container-fluid d-flex align-items-center justify-content-between"},px=El(()=>m("i",{class:"fa fa-arrow-left"},null,-1)),gx=[px],_x={class:"navbar-brand mb-0 h4 flex-grow-1 text-center"},yx=El(()=>m("i",{class:"fa fa-shopping-cart",style:{color:"#111"}},null,-1)),wx={key:0,class:"position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger",style:{"font-size":"0.8rem"}},Ex={style:{padding:"2rem"},class:"container"},Ix=El(()=>m("div",{class:"row align-items-center mb-1"},[m("div",{class:"col-auto"},[m("h2",null,"Products")])],-1)),vx={class:"row mb-3"},Tx={class:"col"},bx={class:"category-chips"},Ax=["onClick"],Rx={class:"product-grid"},Px={class:"product-image-container"},Sx=["src","alt"],Cx={class:"product-overlay"},xx=["onClick"],Dx=El(()=>m("i",{class:"fa fa-plus"},null,-1)),kx={class:"product-info"},Vx={class:"product-name"},Nx={class:"product-price"};function Ox(t,e,n,r,s,i){const o=Fo("router-link");return te(),ne("div",null,[m("nav",fx,[m("div",mx,[m("button",{class:"btn btn-link text-dark p-0 me-2",onClick:e[0]||(e[0]=a=>t.$router.back()),title:"Back"},gx),m("span",_x,he(s.storeName||"Shop"),1),Qe(o,{to:"/cart",class:"cart-icon ms-2 position-relative",style:{cursor:"pointer","text-decoration":"none"}},{default:Ks(()=>[yx,i.cartItemCount?(te(),ne("span",wx,he(i.cartItemCount),1)):Tt("",!0)]),_:1})])]),m("div",Ex,[Ix,m("div",vx,[m("div",Tx,[m("div",bx,[(te(!0),ne(It,null,Gs(s.categories,a=>(te(),ne("span",{key:a.id,class:wc(["chip",{selected:a.id===s.selectedCategoryId}]),onClick:c=>i.switchCategory(a.id)},he(a.name),11,Ax))),128))])])]),m("div",Rx,[(te(!0),ne(It,null,Gs(s.products,a=>(te(),ne("div",{key:a.id,class:"product-card"},[m("div",Px,[m("img",{src:a.image_url,alt:a.name,class:"product-image"},null,8,Sx),m("div",Cx,[m("button",{class:"add-to-cart-btn",onClick:c=>i.addToCart(a)},[Dx,Dt(" Add to Cart ")],8,xx)])]),m("div",kx,[m("h3",Vx,he(a.name),1),m("div",Nx,"$"+he(a.price)+".00",1)])]))),128))])])])}const Mx=an(dx,[["render",Ox],["__scopeId","data-v-c7ea1408"]]),Fx="modulepreload",Lx=function(t){return"/"+t},Op={},Bx=function(e,n,r){if(!n||n.length===0)return e();const s=document.getElementsByTagName("link");return Promise.all(n.map(i=>{if(i=Lx(i),i in Op)return;Op[i]=!0;const o=i.endsWith(".css"),a=o?'[rel="stylesheet"]':"";if(!!r)for(let u=s.length-1;u>=0;u--){const h=s[u];if(h.href===i&&(!o||h.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${i}"]${a}`))return;const l=document.createElement("link");if(l.rel=o?"stylesheet":Fx,o||(l.as="script",l.crossOrigin=""),l.href=i,document.head.appendChild(l),o)return new Promise((u,h)=>{l.addEventListener("load",u),l.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${i}`)))})})).then(()=>e()).catch(i=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i})};const Ux={name:"Cart",data(){return{email:"",name:"",address:"",currentOrderID:null}},computed:{cartItems(){return Sn.items},cartTotal(){return Sn.total},isFormValid(){return this.email&&this.name&&this.address}},methods:{increaseQuantity(t){Sn.updateQuantity(t,this.cartItems[t].quantity+1)},decreaseQuantity(t){const e=this.cartItems[t].quantity-1;Sn.updateQuantity(t,e)},removeFromCart(t){Sn.removeItem(t)},proceedToCheckout(){new window.bootstrap.Modal(this.$refs.checkoutModal).show()},closeCheckoutModal(){const t=window.bootstrap.Modal.getInstance(this.$refs.checkoutModal);t&&t.hide()},async submitPayment(){if(!this.isFormValid){alert("Please fill in all required fields.");return}try{const t={apiKey:"AIzaSyASwq11lvLT6YfaGwp7W_dCBICDzVsBbSM",authDomain:"bankapp-9798a.firebaseapp.com",projectId:"bankapp-9798a",storageBucket:"bankapp-9798a.appspot.com",messagingSenderId:"868698601721",appId:"1:868698601721:web:e061dcefcb437f53854a28",measurementId:"G-WY7R44DDM4"};me.apps.length||me.initializeApp(t);const e=me.firestore(),r=(await e.collection("web-orders").add({status:"pending",total:this.cartTotal,timestamp:me.firestore.FieldValue.serverTimestamp(),email:this.email,name:this.name,address:this.address})).id;this.currentOrderID=r;const s=e.collection("web-orders").doc(r).collection("cart");for(const a of this.cartItems)await s.add({product_image_url:a.product.image_url,product_name:a.product.name,price:a.product.price,quantity:a.quantity});const o=await(await Bx(()=>import("./index-d8d2d627.js"),[])).default.post("https://api.theholylabs.com/create-checkout-session",{order:r,email:this.email,total:this.cartTotal,name:this.name});this.closeCheckoutModal(),Sn.clearCart(),window.location.href=o.data.sessionUrl}catch(t){console.error("Error creating checkout session:",t),alert("There was an error processing your order. Please try again.")}}}},pt=t=>(gr("data-v-5c7d6372"),t=t(),_r(),t),$x={class:"navbar navbar-light bg-light mb-3 appbar"},qx={class:"container-fluid d-flex align-items-center justify-content-between"},jx=pt(()=>m("i",{class:"fa fa-arrow-left"},null,-1)),zx=[jx],Kx=pt(()=>m("span",{class:"navbar-brand mb-0 h4 flex-grow-1 text-center"},"Shopping Cart",-1)),Gx=pt(()=>m("div",{style:{width:"40px"}},null,-1)),Hx={class:"container",style:{padding:"2rem"}},Wx={key:0},Qx={class:"cart-item-info d-flex align-items-stretch"},Yx=["src"],Jx={class:"ms-3 d-flex flex-column justify-content-center"},Xx={class:"mb-1"},Zx={class:"mb-0 text-muted"},eD={class:"mb-0 text-success fw-bold"},tD={class:"d-flex align-items-center"},nD={class:"quantity-controls me-3"},rD=["onClick"],sD=pt(()=>m("i",{class:"fa fa-minus"},null,-1)),iD=[sD],oD={class:"mx-2"},aD=["onClick"],cD=pt(()=>m("i",{class:"fa fa-plus"},null,-1)),lD=[cD],uD=["onClick"],hD=pt(()=>m("i",{class:"fa fa-trash"},null,-1)),dD=[hD],fD={class:"cart-summary mt-4 p-3 bg-light rounded"},mD={class:"d-flex justify-content-between align-items-center mb-3"},pD={class:"mb-0"},gD={key:1,class:"text-center py-5"},_D=pt(()=>m("i",{class:"fa fa-shopping-cart fa-4x text-muted mb-3"},null,-1)),yD=pt(()=>m("h3",{class:"text-muted"},"Your cart is empty",-1)),wD=pt(()=>m("p",{class:"text-muted"},"Add some products to get started!",-1)),ED={class:"modal fade",id:"checkoutModal",tabindex:"-1","aria-labelledby":"checkoutModalLabel","aria-hidden":"true",ref:"checkoutModal"},ID={class:"modal-dialog modal-dialog-centered"},vD={class:"modal-content"},TD={class:"modal-header"},bD=pt(()=>m("h5",{class:"modal-title",id:"checkoutModalLabel"},"Checkout Details",-1)),AD={class:"modal-body"},RD={class:"form-group mb-3"},PD=pt(()=>m("label",{for:"email",class:"form-label"},"Email *",-1)),SD={class:"form-group mb-3"},CD=pt(()=>m("label",{for:"name",class:"form-label"},"Full Name *",-1)),xD={class:"form-group mb-3"},DD=pt(()=>m("label",{for:"address",class:"form-label"},"Delivery Address *",-1)),kD={class:"cart-summary p-3 bg-light rounded"},VD=pt(()=>m("h6",null,"Order Summary:",-1)),ND=pt(()=>m("hr",null,null,-1)),OD={class:"d-flex justify-content-between fw-bold"},MD=pt(()=>m("span",null,"Total:",-1)),FD={class:"modal-footer"},LD=["disabled"];function BD(t,e,n,r,s,i){const o=Fo("router-link");return te(),ne("div",null,[m("nav",$x,[m("div",qx,[m("button",{class:"btn btn-link text-dark p-0 me-2",onClick:e[0]||(e[0]=a=>t.$router.back()),title:"Back"},zx),Kx,Gx])]),m("div",Hx,[i.cartItems.length?(te(),ne("div",Wx,[(te(!0),ne(It,null,Gs(i.cartItems,(a,c)=>(te(),ne("div",{key:c,class:"cart-item d-flex justify-content-between align-items-stretch p-3 mb-3 border rounded"},[m("div",Qx,[m("img",{class:"cart-item-image",src:a.product.image_url,alt:""},null,8,Yx),m("div",Jx,[m("h5",Xx,he(a.product.name),1),m("p",Zx,"Quantity: "+he(a.quantity),1),m("p",eD,"$"+he(a.product.price)+".00",1)])]),m("div",tD,[m("div",nD,[m("button",{class:"btn btn-outline-secondary btn-sm",onClick:l=>i.decreaseQuantity(c)},iD,8,rD),m("span",oD,he(a.quantity),1),m("button",{class:"btn btn-outline-secondary btn-sm",onClick:l=>i.increaseQuantity(c)},lD,8,aD)]),m("button",{class:"btn btn-danger btn-sm",onClick:l=>i.removeFromCart(c)},dD,8,uD)])]))),128)),m("div",fD,[m("div",mD,[m("h4",pD,"Total: $"+he(i.cartTotal.toFixed(2)),1)]),m("button",{class:"btn btn-success btn-lg w-100",onClick:e[1]||(e[1]=(...a)=>i.proceedToCheckout&&i.proceedToCheckout(...a))}," Proceed to Checkout ")])])):(te(),ne("div",gD,[_D,yD,wD,Qe(o,{to:"/",class:"btn btn-primary"},{default:Ks(()=>[Dt("Continue Shopping")]),_:1})]))]),m("div",ED,[m("div",ID,[m("div",vD,[m("div",TD,[bD,m("button",{type:"button",class:"btn-close",onClick:e[2]||(e[2]=(...a)=>i.closeCheckoutModal&&i.closeCheckoutModal(...a))})]),m("div",AD,[m("div",RD,[PD,tn(m("input",{type:"email",id:"email","onUpdate:modelValue":e[3]||(e[3]=a=>s.email=a),required:"",class:"form-control"},null,512),[[wn,s.email]])]),m("div",SD,[CD,tn(m("input",{type:"text",id:"name","onUpdate:modelValue":e[4]||(e[4]=a=>s.name=a),required:"",class:"form-control"},null,512),[[wn,s.name]])]),m("div",xD,[DD,tn(m("textarea",{id:"address","onUpdate:modelValue":e[5]||(e[5]=a=>s.address=a),required:"",class:"form-control",rows:"3"},null,512),[[wn,s.address]])]),m("div",kD,[VD,(te(!0),ne(It,null,Gs(i.cartItems,a=>(te(),ne("div",{key:a.product.id,class:"d-flex justify-content-between"},[m("span",null,he(a.product.name)+" x"+he(a.quantity),1),m("span",null,"$"+he((a.product.price*a.quantity).toFixed(2)),1)]))),128)),ND,m("div",OD,[MD,m("span",null,"$"+he(i.cartTotal.toFixed(2)),1)])])]),m("div",FD,[m("button",{type:"button",class:"btn btn-secondary",onClick:e[6]||(e[6]=(...a)=>i.closeCheckoutModal&&i.closeCheckoutModal(...a))},"Cancel"),m("button",{type:"button",class:"btn btn-success",onClick:e[7]||(e[7]=(...a)=>i.submitPayment&&i.submitPayment(...a)),disabled:!i.isFormValid}," Proceed to Payment ",8,LD)])])])],512)])}const UD=an(Ux,[["render",BD],["__scopeId","data-v-5c7d6372"]]);const $D={name:"PaymentSuccess",data(){return{orderId:"",email:"",total:"",customerName:"",orderUpdated:!1}},async created(){const t=new URLSearchParams(window.location.search);this.orderId=t.get("order")||"",this.email=t.get("email")||"",this.total=t.get("total")||"",this.customerName=decodeURIComponent(t.get("name")||""),console.log("PaymentSuccess created with params:",{orderId:this.orderId,email:this.email,total:this.total,customerName:this.customerName}),this.orderId&&await this.updateOrderStatus()},methods:{async updateOrderStatus(){try{const t={apiKey:"AIzaSyASwq11lvLT6YfaGwp7W_dCBICDzVsBbSM",authDomain:"bankapp-9798a.firebaseapp.com",projectId:"bankapp-9798a",storageBucket:"bankapp-9798a.appspot.com",messagingSenderId:"868698601721",appId:"1:868698601721:web:e061dcefcb437f53854a28",measurementId:"G-WY7R44DDM4"};me.apps.length||me.initializeApp(t),await me.firestore().collection("web-orders").doc(this.orderId).update({status:"completed",completedAt:me.firestore.FieldValue.serverTimestamp(),paymentStatus:"paid"}),this.orderUpdated=!0,console.log("Order status updated to completed for order:",this.orderId)}catch(t){console.error("Error updating order status:",t)}}}},Ar=t=>(gr("data-v-0f4ac8b4"),t=t(),_r(),t),qD={class:"success-container"},jD={class:"success-card"},zD=Ar(()=>m("div",{class:"success-icon"},[m("i",{class:"fa fa-check-circle"})],-1)),KD=Ar(()=>m("h1",{class:"success-title"},"Payment Successful!",-1)),GD={class:"success-message"},HD={class:"order-details"},WD=Ar(()=>m("h3",null,"Order Details",-1)),QD=Ar(()=>m("strong",null,"Order ID:",-1)),YD=Ar(()=>m("strong",null,"Total:",-1)),JD=Ar(()=>m("strong",null,"Email:",-1)),XD={key:0,class:"order-status"},ZD=Ar(()=>m("i",{class:"fa fa-check-circle text-success"},null,-1)),ek=Ar(()=>m("span",{class:"text-success"},"Order processed successfully",-1)),tk=[ZD,ek],nk={class:"success-actions"};function rk(t,e,n,r,s,i){const o=Fo("router-link");return te(),ne("div",qD,[m("div",jD,[zD,KD,m("p",GD," Thank you "+he(s.customerName)+" for your order! ",1),m("div",HD,[WD,m("p",null,[QD,Dt(" "+he(s.orderId),1)]),m("p",null,[YD,Dt(" $"+he(s.total),1)]),m("p",null,[JD,Dt(" "+he(s.email),1)]),s.orderUpdated?(te(),ne("div",XD,tk)):Tt("",!0)]),m("div",nk,[Qe(o,{to:"/shop",class:"btn btn-primary btn-lg"},{default:Ks(()=>[Dt(" Continue Shopping ")]),_:1}),Qe(o,{to:"/",class:"btn btn-outline-secondary btn-lg ms-3"},{default:Ks(()=>[Dt(" Back to Home ")]),_:1})])])])}const sk=an($D,[["render",rk],["__scopeId","data-v-0f4ac8b4"]]),ik={apiKey:"AIzaSyASwq11lvLT6YfaGwp7W_dCBICDzVsBbSM",authDomain:"bankapp-9798a.firebaseapp.com",projectId:"bankapp-9798a",storageBucket:"bankapp-9798a.appspot.com",messagingSenderId:"868698601721",appId:"1:868698601721:web:e061dcefcb437f53854a28",measurementId:"G-WY7R44DDM4"};me.apps.length||me.initializeApp(ik);const Mp=me.firestore();const ok={data(){return{loginEmail:"",categories:[],showDeleteConfirm:!1,deleteTarget:null}},methods:{logout(){this.loginEmail=""},fetchCategories(){Mp.collection("categories").get().then(t=>{this.categories=[],t.forEach(e=>{const n=e.data();n.id=e.id,this.categories.push(n)})})},goToAdd(){this.$router.push("/admin/add")},goToMenu(t){this.$router.push(`/admin/menu/${t}`)},confirmDelete(t){this.deleteTarget=t,this.showDeleteConfirm=!0},deleteCategory(){Mp.collection("categories").doc(this.deleteTarget.id).delete().then(()=>{this.fetchCategories(),this.showDeleteConfirm=!1,this.deleteTarget=null})}},mounted(){this.loginEmail="",this.fetchCategories()}},HE=t=>(gr("data-v-89609d73"),t=t(),_r(),t),ak={class:"admin-dashboard-wrapper"},ck={class:"admin-header"},lk={class:"admin-email"},uk=HE(()=>m("h1",{class:"admin-dashboard-title"},"Admin Dashboard",-1)),hk={class:"table-responsive"},dk={class:"admin-table"},fk=HE(()=>m("thead",null,[m("tr",null,[m("th",null,"Name"),m("th",null,"Receiving Orders"),m("th",null,"Email"),m("th",null,"Image"),m("th",null,"Actions")])],-1)),mk=["src"],pk=["onClick"];function gk(t,e,n,r,s,i){return te(),ne("div",ak,[m("div",null,[m("div",ck,[m("span",lk,he(s.loginEmail),1),m("button",{class:"logout-btn",onClick:e[0]||(e[0]=(...o)=>i.logout&&i.logout(...o))},"Logout")]),uk,m("div",hk,[m("table",dk,[fk,m("tbody",null,[(te(!0),ne(It,null,Gs(s.categories,o=>(te(),ne("tr",{key:o.id},[m("td",null,he(o.name),1),m("td",null,he(o.receivingOrders?"Yes":"No"),1),m("td",null,he(o.email),1),m("td",null,[o.link?(te(),ne("img",{key:0,src:o.link,alt:"Category Image",style:{width:"60px",height:"60px","object-fit":"cover","border-radius":"6px"}},null,8,mk)):Tt("",!0)]),m("td",null,[m("button",{class:"edit-btn",onClick:a=>i.goToMenu(o.id)},"Edit",8,pk)])]))),128))])])]),m("button",{class:"fab",onClick:e[1]||(e[1]=(...o)=>i.goToAdd&&i.goToAdd(...o))},"+")])])}const _k=an(ok,[["render",gk],["__scopeId","data-v-89609d73"]]);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WE="firebasestorage.googleapis.com",QE="storageBucket",yk=2*60*1e3,wk=10*60*1e3,Ek=1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Le extends yr{constructor(e,n,r=0){super(Xl(e),`Firebase Storage: ${n} (${Xl(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Le.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Xl(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var ke;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(ke||(ke={}));function Xl(t){return"storage/"+t}function Zd(){const t="An unknown error occurred, please check the error payload for server response.";return new Le(ke.UNKNOWN,t)}function Ik(t){return new Le(ke.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function vk(t){return new Le(ke.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function Tk(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Le(ke.UNAUTHENTICATED,t)}function bk(){return new Le(ke.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function Ak(t){return new Le(ke.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function YE(){return new Le(ke.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function JE(){return new Le(ke.CANCELED,"User canceled the upload/download.")}function Rk(t){return new Le(ke.INVALID_URL,"Invalid URL '"+t+"'.")}function Pk(t){return new Le(ke.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function Sk(){return new Le(ke.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+QE+"' property when initializing the app?")}function XE(){return new Le(ke.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function Ck(){return new Le(ke.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}function xk(){return new Le(ke.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function Dk(t){return new Le(ke.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function js(t){return new Le(ke.INVALID_ARGUMENT,t)}function ZE(){return new Le(ke.APP_DELETED,"The Firebase app was deleted.")}function eI(t){return new Le(ke.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function ro(t,e){return new Le(ke.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function Bi(t){throw new Le(ke.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dt{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=dt.makeFromUrl(e,n)}catch{return new dt(e,"")}if(r.path==="")return r;throw Pk(e)}static makeFromUrl(e,n){let r=null;const s="([A-Za-z0-9.\\-_]+)";function i(B){B.path.charAt(B.path.length-1)==="/"&&(B.path_=B.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+s+o,"i"),c={bucket:1,path:3};function l(B){B.path_=decodeURIComponent(B.path)}const u="v[A-Za-z0-9_]+",h=n.replace(/[.]/g,"\\."),d="(/([^?#]*).*)?$",f=new RegExp(`^https?://${h}/${u}/b/${s}/o${d}`,"i"),y={bucket:1,path:3},w=n===WE?"(?:storage.googleapis.com|storage.cloud.google.com)":n,I="([^?#]*)",b=new RegExp(`^https?://${w}/${s}/${I}`,"i"),R=[{regex:a,indices:c,postModify:i},{regex:f,indices:y,postModify:l},{regex:b,indices:{bucket:1,path:2},postModify:l}];for(let B=0;B<R.length;B++){const Y=R[B],Z=Y.regex.exec(e);if(Z){const ge=Z[Y.indices.bucket];let Be=Z[Y.indices.path];Be||(Be=""),r=new dt(ge,Be),Y.postModify(r);break}}if(r==null)throw Rk(e);return r}}class kk{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vk(t,e,n){let r=1,s=null,i=null,o=!1,a=0;function c(){return a===2}let l=!1;function u(...I){l||(l=!0,e.apply(null,I))}function h(I){s=setTimeout(()=>{s=null,t(f,c())},I)}function d(){i&&clearTimeout(i)}function f(I,...b){if(l){d();return}if(I){d(),u.call(null,I,...b);return}if(c()||o){d(),u.call(null,I,...b);return}r<64&&(r*=2);let R;a===1?(a=2,R=0):R=(r+Math.random())*1e3,h(R)}let y=!1;function w(I){y||(y=!0,d(),!l&&(s!==null?(I||(a=2),clearTimeout(s),h(0)):I||(a=1)))}return h(0),i=setTimeout(()=>{o=!0,w(!0)},n),w}function Nk(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ok(t){return t!==void 0}function Mk(t){return typeof t=="function"}function Fk(t){return typeof t=="object"&&!Array.isArray(t)}function Il(t){return typeof t=="string"||t instanceof String}function Fp(t){return ef()&&t instanceof Blob}function ef(){return typeof Blob<"u"}function sh(t,e,n,r){if(r<e)throw js(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw js(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rr(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function tI(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const s=e(r)+"="+e(t[r]);n=n+s+"&"}return n=n.slice(0,-1),n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Jr;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(Jr||(Jr={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nI(t,e){const n=t>=500&&t<600,s=[408,429].indexOf(t)!==-1,i=e.indexOf(t)!==-1;return n||s||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lk{constructor(e,n,r,s,i,o,a,c,l,u,h,d=!0){this.url_=e,this.method_=n,this.headers_=r,this.body_=s,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=c,this.timeout_=l,this.progressCallback_=u,this.connectionFactory_=h,this.retry=d,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((f,y)=>{this.resolve_=f,this.reject_=y,this.start_()})}start_(){const e=(r,s)=>{if(s){r(!1,new Aa(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const o=a=>{const c=a.loaded,l=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,l)};this.progressCallback_!==null&&i.addUploadProgressListener(o),i.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(o),this.pendingConnection_=null;const a=i.getErrorCode()===Jr.NO_ERROR,c=i.getStatus();if(!a||nI(c,this.additionalRetryCodes_)&&this.retry){const u=i.getErrorCode()===Jr.ABORT;r(!1,new Aa(!1,null,u));return}const l=this.successCodes_.indexOf(c)!==-1;r(!0,new Aa(l,i))})},n=(r,s)=>{const i=this.resolve_,o=this.reject_,a=s.connection;if(s.wasSuccessCode)try{const c=this.callback_(a,a.getResponse());Ok(c)?i(c):i()}catch(c){o(c)}else if(a!==null){const c=Zd();c.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,c)):o(c)}else if(s.canceled){const c=this.appDelete_?ZE():JE();o(c)}else{const c=YE();o(c)}};this.canceled_?n(!1,new Aa(!1,null,!0)):this.backoffId_=Vk(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&Nk(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Aa{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function Bk(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function Uk(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function $k(t,e){e&&(t["X-Firebase-GMPID"]=e)}function qk(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function jk(t,e,n,r,s,i,o=!0){const a=tI(t.urlParams),c=t.url+a,l=Object.assign({},t.headers);return $k(l,e),Bk(l,n),Uk(l,i),qk(l,r),new Lk(c,t.method,l,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,s,o)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zk(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function Kk(...t){const e=zk();if(e!==void 0){const n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(ef())return new Blob(t);throw new Le(ke.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function Gk(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hk(t){if(typeof atob>"u")throw Dk("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kt={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Zl{constructor(e,n){this.data=e,this.contentType=n||null}}function rI(t,e){switch(t){case Kt.RAW:return new Zl(sI(e));case Kt.BASE64:case Kt.BASE64URL:return new Zl(iI(t,e));case Kt.DATA_URL:return new Zl(Qk(e),Yk(e))}throw Zd()}function sI(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const i=r,o=t.charCodeAt(++n);r=65536|(i&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function Wk(t){let e;try{e=decodeURIComponent(t)}catch{throw ro(Kt.DATA_URL,"Malformed data URL.")}return sI(e)}function iI(t,e){switch(t){case Kt.BASE64:{const s=e.indexOf("-")!==-1,i=e.indexOf("_")!==-1;if(s||i)throw ro(t,"Invalid character '"+(s?"-":"_")+"' found: is it base64url encoded?");break}case Kt.BASE64URL:{const s=e.indexOf("+")!==-1,i=e.indexOf("/")!==-1;if(s||i)throw ro(t,"Invalid character '"+(s?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=Hk(e)}catch(s){throw s.message.includes("polyfill")?s:ro(t,"Invalid character found")}const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}class oI{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw ro(Kt.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;r!=null&&(this.base64=Jk(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function Qk(t){const e=new oI(t);return e.base64?iI(Kt.BASE64,e.rest):Wk(e.rest)}function Yk(t){return new oI(t).contentType}function Jk(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cn{constructor(e,n){let r=0,s="";Fp(e)?(this.data_=e,r=e.size,s=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=s}size(){return this.size_}type(){return this.type_}slice(e,n){if(Fp(this.data_)){const r=this.data_,s=Gk(r,e,n);return s===null?null:new Cn(s)}else{const r=new Uint8Array(this.data_.buffer,e,n-e);return new Cn(r,!0)}}static getBlob(...e){if(ef()){const n=e.map(r=>r instanceof Cn?r.data_:r);return new Cn(Kk.apply(null,n))}else{const n=e.map(o=>Il(o)?rI(Kt.RAW,o).data:o.data_);let r=0;n.forEach(o=>{r+=o.byteLength});const s=new Uint8Array(r);let i=0;return n.forEach(o=>{for(let a=0;a<o.length;a++)s[i++]=o[a]}),new Cn(s,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tf(t){let e;try{e=JSON.parse(t)}catch{return null}return Fk(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xk(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function Zk(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function aI(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eV(t,e){return e}class gt{constructor(e,n,r,s){this.server=e,this.local=n||e,this.writable=!!r,this.xform=s||eV}}let Ra=null;function tV(t){return!Il(t)||t.length<2?t:aI(t)}function vl(){if(Ra)return Ra;const t=[];t.push(new gt("bucket")),t.push(new gt("generation")),t.push(new gt("metageneration")),t.push(new gt("name","fullPath",!0));function e(i,o){return tV(o)}const n=new gt("name");n.xform=e,t.push(n);function r(i,o){return o!==void 0?Number(o):o}const s=new gt("size");return s.xform=r,t.push(s),t.push(new gt("timeCreated")),t.push(new gt("updated")),t.push(new gt("md5Hash",null,!0)),t.push(new gt("cacheControl",null,!0)),t.push(new gt("contentDisposition",null,!0)),t.push(new gt("contentEncoding",null,!0)),t.push(new gt("contentLanguage",null,!0)),t.push(new gt("contentType",null,!0)),t.push(new gt("metadata","customMetadata",!0)),Ra=t,Ra}function nV(t,e){function n(){const r=t.bucket,s=t.fullPath,i=new dt(r,s);return e._makeStorageReference(i)}Object.defineProperty(t,"ref",{get:n})}function rV(t,e,n){const r={};r.type="file";const s=n.length;for(let i=0;i<s;i++){const o=n[i];r[o.local]=o.xform(r,e[o.server])}return nV(r,t),r}function cI(t,e,n){const r=tf(e);return r===null?null:rV(t,r,n)}function sV(t,e,n,r){const s=tf(e);if(s===null||!Il(s.downloadTokens))return null;const i=s.downloadTokens;if(i.length===0)return null;const o=encodeURIComponent;return i.split(",").map(l=>{const u=t.bucket,h=t.fullPath,d="/b/"+o(u)+"/o/"+o(h),f=Rr(d,n,r),y=tI({alt:"media",token:l});return f+y})[0]}function nf(t,e){const n={},r=e.length;for(let s=0;s<r;s++){const i=e[s];i.writable&&(n[i.server]=t[i.local])}return JSON.stringify(n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lp="prefixes",Bp="items";function iV(t,e,n){const r={prefixes:[],items:[],nextPageToken:n.nextPageToken};if(n[Lp])for(const s of n[Lp]){const i=s.replace(/\/$/,""),o=t._makeStorageReference(new dt(e,i));r.prefixes.push(o)}if(n[Bp])for(const s of n[Bp]){const i=t._makeStorageReference(new dt(e,s.name));r.items.push(i)}return r}function oV(t,e,n){const r=tf(n);return r===null?null:iV(t,e,r)}class jn{constructor(e,n,r,s){this.url=e,this.method=n,this.handler=r,this.timeout=s,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vn(t){if(!t)throw Zd()}function Tl(t,e){function n(r,s){const i=cI(t,s,e);return vn(i!==null),i}return n}function aV(t,e){function n(r,s){const i=oV(t,e,s);return vn(i!==null),i}return n}function cV(t,e){function n(r,s){const i=cI(t,s,e);return vn(i!==null),sV(i,s,t.host,t._protocol)}return n}function Pi(t){function e(n,r){let s;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?s=bk():s=Tk():n.getStatus()===402?s=vk(t.bucket):n.getStatus()===403?s=Ak(t.path):s=r,s.status=n.getStatus(),s.serverResponse=r.serverResponse,s}return e}function bl(t){const e=Pi(t);function n(r,s){let i=e(r,s);return r.getStatus()===404&&(i=Ik(t.path)),i.serverResponse=s.serverResponse,i}return n}function lI(t,e,n){const r=e.fullServerUrl(),s=Rr(r,t.host,t._protocol),i="GET",o=t.maxOperationRetryTime,a=new jn(s,i,Tl(t,n),o);return a.errorHandler=bl(e),a}function lV(t,e,n,r,s){const i={};e.isRoot?i.prefix="":i.prefix=e.path+"/",n&&n.length>0&&(i.delimiter=n),r&&(i.pageToken=r),s&&(i.maxResults=s);const o=e.bucketOnlyServerUrl(),a=Rr(o,t.host,t._protocol),c="GET",l=t.maxOperationRetryTime,u=new jn(a,c,aV(t,e.bucket),l);return u.urlParams=i,u.errorHandler=Pi(e),u}function uV(t,e,n){const r=e.fullServerUrl(),s=Rr(r,t.host,t._protocol),i="GET",o=t.maxOperationRetryTime,a=new jn(s,i,cV(t,n),o);return a.errorHandler=bl(e),a}function hV(t,e,n,r){const s=e.fullServerUrl(),i=Rr(s,t.host,t._protocol),o="PATCH",a=nf(n,r),c={"Content-Type":"application/json; charset=utf-8"},l=t.maxOperationRetryTime,u=new jn(i,o,Tl(t,r),l);return u.headers=c,u.body=a,u.errorHandler=bl(e),u}function dV(t,e){const n=e.fullServerUrl(),r=Rr(n,t.host,t._protocol),s="DELETE",i=t.maxOperationRetryTime;function o(c,l){}const a=new jn(r,s,o,i);return a.successCodes=[200,204],a.errorHandler=bl(e),a}function fV(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function uI(t,e,n){const r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=fV(null,e)),r}function mV(t,e,n,r,s){const i=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let R="";for(let B=0;B<2;B++)R=R+Math.random().toString().slice(2);return R}const c=a();o["Content-Type"]="multipart/related; boundary="+c;const l=uI(e,r,s),u=nf(l,n),h="--"+c+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+u+`\r
--`+c+`\r
Content-Type: `+l.contentType+`\r
\r
`,d=`\r
--`+c+"--",f=Cn.getBlob(h,r,d);if(f===null)throw XE();const y={name:l.fullPath},w=Rr(i,t.host,t._protocol),I="POST",b=t.maxUploadRetryTime,D=new jn(w,I,Tl(t,n),b);return D.urlParams=y,D.headers=o,D.body=f.uploadData(),D.errorHandler=Pi(e),D}class yc{constructor(e,n,r,s){this.current=e,this.total=n,this.finalized=!!r,this.metadata=s||null}}function rf(t,e){let n=null;try{n=t.getResponseHeader("X-Goog-Upload-Status")}catch{vn(!1)}return vn(!!n&&(e||["active"]).indexOf(n)!==-1),n}function pV(t,e,n,r,s){const i=e.bucketOnlyServerUrl(),o=uI(e,r,s),a={name:o.fullPath},c=Rr(i,t.host,t._protocol),l="POST",u={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${r.size()}`,"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},h=nf(o,n),d=t.maxUploadRetryTime;function f(w){rf(w);let I;try{I=w.getResponseHeader("X-Goog-Upload-URL")}catch{vn(!1)}return vn(Il(I)),I}const y=new jn(c,l,f,d);return y.urlParams=a,y.headers=u,y.body=h,y.errorHandler=Pi(e),y}function gV(t,e,n,r){const s={"X-Goog-Upload-Command":"query"};function i(l){const u=rf(l,["active","final"]);let h=null;try{h=l.getResponseHeader("X-Goog-Upload-Size-Received")}catch{vn(!1)}h||vn(!1);const d=Number(h);return vn(!isNaN(d)),new yc(d,r.size(),u==="final")}const o="POST",a=t.maxUploadRetryTime,c=new jn(n,o,i,a);return c.headers=s,c.errorHandler=Pi(e),c}const Up=256*1024;function _V(t,e,n,r,s,i,o,a){const c=new yc(0,0);if(o?(c.current=o.current,c.total=o.total):(c.current=0,c.total=r.size()),r.size()!==c.total)throw Ck();const l=c.total-c.current;let u=l;s>0&&(u=Math.min(u,s));const h=c.current,d=h+u;let f="";u===0?f="finalize":l===u?f="upload, finalize":f="upload";const y={"X-Goog-Upload-Command":f,"X-Goog-Upload-Offset":`${c.current}`},w=r.slice(h,d);if(w===null)throw XE();function I(B,Y){const Z=rf(B,["active","final"]),ge=c.current+u,Be=r.size();let Ut;return Z==="final"?Ut=Tl(e,i)(B,Y):Ut=null,new yc(ge,Be,Z==="final",Ut)}const b="POST",D=e.maxUploadRetryTime,R=new jn(n,b,I,D);return R.headers=y,R.body=w.uploadData(),R.progressCallback=a||null,R.errorHandler=Pi(t),R}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yV={STATE_CHANGED:"state_changed"},Et={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function eu(t){switch(t){case"running":case"pausing":case"canceling":return Et.RUNNING;case"paused":return Et.PAUSED;case"success":return Et.SUCCESS;case"canceled":return Et.CANCELED;case"error":return Et.ERROR;default:return Et.ERROR}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wV{constructor(e,n,r){if(Mk(e)||n!=null||r!=null)this.next=e,this.error=n??void 0,this.complete=r??void 0;else{const i=e;this.next=i.next,this.error=i.error,this.complete=i.complete}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rs(t){return(...e)=>{Promise.resolve().then(()=>t(...e))}}class EV{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Jr.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Jr.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Jr.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,s){if(this.sent_)throw Bi("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(n,e,!0),s!==void 0)for(const i in s)s.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,s[i].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Bi("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Bi("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Bi("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Bi("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class IV extends EV{initXhr(){this.xhr_.responseType="text"}}function mn(){return new IV}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hI{constructor(e,n,r=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=n,this._metadata=r,this._mappings=vl(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=s=>{if(this._request=void 0,this._chunkMultiplier=1,s._codeEquals(ke.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{const i=this.isExponentialBackoffExpired();if(nI(s.status,[]))if(i)s=YE();else{this.sleepTime=Math.max(this.sleepTime*2,Ek),this._needToFetchStatus=!0,this.completeTransitions_();return}this._error=s,this._transition("error")}},this._metadataErrorHandler=s=>{this._request=void 0,s._codeEquals(ke.CANCELED)?this.completeTransitions_():(this._error=s,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((s,i)=>{this._resolve=s,this._reject=i,this._start()}),this._promise.then(null,()=>{})}isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}_makeProgressCallback(){const e=this._transferred;return n=>this._updateProgress(e+n)}_shouldDoResumable(e){return e.size()>256*1024}_start(){this._state==="running"&&this._request===void 0&&(this._resumable?this._uploadUrl===void 0?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([n,r])=>{switch(this._state){case"running":e(n,r);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused");break}})}_createResumable(){this._resolveToken((e,n)=>{const r=pV(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),s=this._ref.storage._makeRequest(r,mn,e,n);this._request=s,s.getPromise().then(i=>{this._request=void 0,this._uploadUrl=i,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const e=this._uploadUrl;this._resolveToken((n,r)=>{const s=gV(this._ref.storage,this._ref._location,e,this._blob),i=this._ref.storage._makeRequest(s,mn,n,r);this._request=i,i.getPromise().then(o=>{o=o,this._request=void 0,this._updateProgress(o.current),this._needToFetchStatus=!1,o.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const e=Up*this._chunkMultiplier,n=new yc(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken((s,i)=>{let o;try{o=_V(this._ref._location,this._ref.storage,r,this._blob,e,this._mappings,n,this._makeProgressCallback())}catch(c){this._error=c,this._transition("error");return}const a=this._ref.storage._makeRequest(o,mn,s,i,!1);this._request=a,a.getPromise().then(c=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(c.current),c.finalized?(this._metadata=c.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){Up*this._chunkMultiplier*2<32*1024*1024&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,n)=>{const r=lI(this._ref.storage,this._ref._location,this._mappings),s=this._ref.storage._makeRequest(r,mn,e,n);this._request=s,s.getPromise().then(i=>{this._request=void 0,this._metadata=i,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,n)=>{const r=mV(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),s=this._ref.storage._makeRequest(r,mn,e,n);this._request=s,s.getPromise().then(i=>{this._request=void 0,this._metadata=i,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){const n=this._transferred;this._transferred=e,this._transferred!==n&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,this._request!==void 0?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":const n=this._state==="paused";this._state=e,n&&(this._notifyObservers(),this._start());break;case"paused":this._state=e,this._notifyObservers();break;case"canceled":this._error=JE(),this._state=e,this._notifyObservers();break;case"error":this._state=e,this._notifyObservers();break;case"success":this._state=e,this._notifyObservers();break}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start();break}}get snapshot(){const e=eu(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,n,r,s){const i=new wV(n||void 0,r||void 0,s||void 0);return this._addObserver(i),()=>{this._removeObserver(i)}}then(e,n){return this._promise.then(e,n)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){const n=this._observers.indexOf(e);n!==-1&&this._observers.splice(n,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(n=>{this._notifyObserver(n)})}_finishPromise(){if(this._resolve!==void 0){let e=!0;switch(eu(this._state)){case Et.SUCCESS:Rs(this._resolve.bind(null,this.snapshot))();break;case Et.CANCELED:case Et.ERROR:const n=this._reject;Rs(n.bind(null,this._error))();break;default:e=!1;break}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(eu(this._state)){case Et.RUNNING:case Et.PAUSED:e.next&&Rs(e.next.bind(e,this.snapshot))();break;case Et.SUCCESS:e.complete&&Rs(e.complete.bind(e))();break;case Et.CANCELED:case Et.ERROR:e.error&&Rs(e.error.bind(e,this._error))();break;default:e.error&&Rs(e.error.bind(e,this._error))()}}resume(){const e=this._state==="paused"||this._state==="pausing";return e&&this._transition("running"),e}pause(){const e=this._state==="running";return e&&this._transition("pausing"),e}cancel(){const e=this._state==="running"||this._state==="pausing";return e&&this._transition("canceling"),e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class us{constructor(e,n){this._service=e,n instanceof dt?this._location=n:this._location=dt.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new us(e,n)}get root(){const e=new dt(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return aI(this._location.path)}get storage(){return this._service}get parent(){const e=Xk(this._location.path);if(e===null)return null;const n=new dt(this._location.bucket,e);return new us(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw eI(e)}}function vV(t,e,n){return t._throwIfRoot("uploadBytesResumable"),new hI(t,new Cn(e),n)}function TV(t){const e={prefixes:[],items:[]};return dI(t,e).then(()=>e)}async function dI(t,e,n){const s=await fI(t,{pageToken:n});e.prefixes.push(...s.prefixes),e.items.push(...s.items),s.nextPageToken!=null&&await dI(t,e,s.nextPageToken)}function fI(t,e){e!=null&&typeof e.maxResults=="number"&&sh("options.maxResults",1,1e3,e.maxResults);const n=e||{},r=lV(t.storage,t._location,"/",n.pageToken,n.maxResults);return t.storage.makeRequestWithTokens(r,mn)}function bV(t){t._throwIfRoot("getMetadata");const e=lI(t.storage,t._location,vl());return t.storage.makeRequestWithTokens(e,mn)}function AV(t,e){t._throwIfRoot("updateMetadata");const n=hV(t.storage,t._location,e,vl());return t.storage.makeRequestWithTokens(n,mn)}function RV(t){t._throwIfRoot("getDownloadURL");const e=uV(t.storage,t._location,vl());return t.storage.makeRequestWithTokens(e,mn).then(n=>{if(n===null)throw xk();return n})}function PV(t){t._throwIfRoot("deleteObject");const e=dV(t.storage,t._location);return t.storage.makeRequestWithTokens(e,mn)}function mI(t,e){const n=Zk(t._location.path,e),r=new dt(t._location.bucket,n);return new us(t.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SV(t){return/^[A-Za-z]+:\/\//.test(t)}function CV(t,e){return new us(t,e)}function pI(t,e){if(t instanceof sf){const n=t;if(n._bucket==null)throw Sk();const r=new us(n,n._bucket);return e!=null?pI(r,e):r}else return e!==void 0?mI(t,e):t}function xV(t,e){if(e&&SV(e)){if(t instanceof sf)return CV(t,e);throw js("To use ref(service, url), the first argument must be a Storage instance.")}else return pI(t,e)}function $p(t,e){const n=e==null?void 0:e[QE];return n==null?null:dt.makeFromBucketSpec(n,t)}function DV(t,e,n,r={}){t.host=`${e}:${n}`,t._protocol="http";const{mockUserToken:s}=r;s&&(t._overrideAuthToken=typeof s=="string"?s:o_(s,t.app.options.projectId))}class sf{constructor(e,n,r,s,i){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=s,this._firebaseVersion=i,this._bucket=null,this._host=WE,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=yk,this._maxUploadRetryTime=wk,this._requests=new Set,s!=null?this._bucket=dt.makeFromBucketSpec(s,this._host):this._bucket=$p(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=dt.makeFromBucketSpec(this._url,e):this._bucket=$p(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){sh("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){sh("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new us(this,e)}_makeRequest(e,n,r,s,i=!0){if(this._deleted)return new kk(ZE());{const o=jk(e,this._appId,r,s,n,this._firebaseVersion,i);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,n){const[r,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,s).getPromise()}}const qp="@firebase/storage",jp="0.12.4";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kV="storage";function VV(t,e,n){return t=be(t),vV(t,e,n)}function NV(t){return t=be(t),bV(t)}function OV(t,e){return t=be(t),AV(t,e)}function MV(t,e){return t=be(t),fI(t,e)}function FV(t){return t=be(t),TV(t)}function LV(t){return t=be(t),RV(t)}function BV(t){return t=be(t),PV(t)}function zp(t,e){return t=be(t),xV(t,e)}function UV(t,e){return mI(t,e)}function $V(t,e,n,r={}){DV(t,e,n,r)}function qV(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new sf(n,r,s,e,Mc)}function jV(){es(new On(kV,qV,"PUBLIC").setMultipleInstances(!0)),nn(qp,jp,""),nn(qp,jp,"esm2017")}jV();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pa{constructor(e,n,r){this._delegate=e,this.task=n,this.ref=r}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kp{constructor(e,n){this._delegate=e,this._ref=n,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new Pa(this._delegate.snapshot,this,this._ref)}then(e,n){return this._delegate.then(r=>{if(e)return e(new Pa(r,this,this._ref))},n)}on(e,n,r,s){let i;return n&&(typeof n=="function"?i=o=>n(new Pa(o,this,this._ref)):i={next:n.next?o=>n.next(new Pa(o,this,this._ref)):void 0,complete:n.complete||void 0,error:n.error||void 0}),this._delegate.on(e,i,r||void 0,s||void 0)}}class Gp{constructor(e,n){this._delegate=e,this._service=n}get prefixes(){return this._delegate.prefixes.map(e=>new Vn(e,this._service))}get items(){return this._delegate.items.map(e=>new Vn(e,this._service))}get nextPageToken(){return this._delegate.nextPageToken||null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *  http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vn{constructor(e,n){this._delegate=e,this.storage=n}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(e){const n=UV(this._delegate,e);return new Vn(n,this.storage)}get root(){return new Vn(this._delegate.root,this.storage)}get parent(){const e=this._delegate.parent;return e==null?null:new Vn(e,this.storage)}put(e,n){return this._throwIfRoot("put"),new Kp(VV(this._delegate,e,n),this)}putString(e,n=Kt.RAW,r){this._throwIfRoot("putString");const s=rI(n,e),i=Object.assign({},r);return i.contentType==null&&s.contentType!=null&&(i.contentType=s.contentType),new Kp(new hI(this._delegate,new Cn(s.data,!0),i),this)}listAll(){return FV(this._delegate).then(e=>new Gp(e,this.storage))}list(e){return MV(this._delegate,e||void 0).then(n=>new Gp(n,this.storage))}getMetadata(){return NV(this._delegate)}updateMetadata(e){return OV(this._delegate,e)}getDownloadURL(){return LV(this._delegate)}delete(){return this._throwIfRoot("delete"),BV(this._delegate)}_throwIfRoot(e){if(this._delegate._location.path==="")throw eI(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gI{constructor(e,n){this.app=e,this._delegate=n}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(e){if(Hp(e))throw js("ref() expected a child path but got a URL, use refFromURL instead.");return new Vn(zp(this._delegate,e),this)}refFromURL(e){if(!Hp(e))throw js("refFromURL() expected a full URL but got a child path, use ref() instead.");try{dt.makeFromUrl(e,this._delegate.host)}catch{throw js("refFromUrl() expected a valid full URL but got an invalid one.")}return new Vn(zp(this._delegate,e),this)}setMaxUploadRetryTime(e){this._delegate.maxUploadRetryTime=e}setMaxOperationRetryTime(e){this._delegate.maxOperationRetryTime=e}useEmulator(e,n,r={}){$V(this._delegate,e,n,r)}}function Hp(t){return/^[A-Za-z]+:\/\//.test(t)}const zV="@firebase/storage-compat",KV="0.3.7";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GV="storage-compat";function HV(t,{instanceIdentifier:e}){const n=t.getProvider("app-compat").getImmediate(),r=t.getProvider("storage").getImmediate({identifier:e});return new gI(n,r)}function WV(t){const e={TaskState:Et,TaskEvent:yV,StringFormat:Kt,Storage:gI,Reference:Vn};t.INTERNAL.registerComponent(new On(GV,HV,"PUBLIC").setServiceProps(e).setMultipleInstances(!0)),t.registerVersion(zV,KV)}WV(me);const Wp="admin_dashboard_email",QV={data(){return{name:"",receivingOrders:!1,email:"",message:"",imageFile:null,imagePreview:"",uploading:!1}},mounted(){this.email=localStorage.getItem(Wp)||""},methods:{onFileChange(t){const e=t.target.files[0];e&&(this.imageFile=e,this.imagePreview=URL.createObjectURL(e))},async uploadImage(){if(!this.imageFile)return"";this.uploading=!0;const t=me.storage().ref(),e=`category_images/${Date.now()}_${this.imageFile.name}`,n=t.child(e);await n.put(this.imageFile);const r=await n.getDownloadURL();return this.uploading=!1,r},async addCategory(){let t="";this.imageFile&&(t=await this.uploadImage());const e=localStorage.getItem(Wp)||this.email;me.firestore().collection("categories").add({name:this.name,link:t,receivingOrders:this.receivingOrders,email:e}).then(()=>{this.message="Category added!",setTimeout(()=>{this.$router.push("/admin")},1e3)}).catch(r=>{this.message="Error: "+r.message})},goBack(){this.$router.push("/admin")}}},oa=t=>(gr("data-v-b27febf0"),t=t(),_r(),t),YV={class:"admin-merchant-wrapper"},JV={class:"admin-merchant-content"},XV={class:"edit-actions"},ZV=oa(()=>m("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none"},[m("path",{d:"M15 19l-7-7 7-7",stroke:"#fff","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)),eN=[ZV],tN=oa(()=>m("h1",{class:"admin-dashboard-title"},"Add Category",-1)),nN={class:"image-upload-row"},rN=oa(()=>m("label",{class:"image-upload-label"},"Hero Image",-1)),sN={key:0,class:"image-preview-container"},iN=["src"],oN={class:"switch-row"},aN=oa(()=>m("label",{class:"switch-label"},"Receiving Orders",-1)),cN={class:"switch"},lN=oa(()=>m("span",{class:"slider"},null,-1)),uN={class:"switch-value"},hN=["disabled"],dN={key:0,class:"form-message"};function fN(t,e,n,r,s,i){return te(),ne("div",YV,[m("div",JV,[m("div",XV,[m("button",{class:"back-btn",onClick:e[0]||(e[0]=(...o)=>i.goBack&&i.goBack(...o)),title:"Back"},eN)]),tN,m("form",{onSubmit:e[4]||(e[4]=Vc((...o)=>i.addCategory&&i.addCategory(...o),["prevent"])),class:"admin-form"},[m("div",nN,[rN,m("input",{type:"file",accept:"image/*",onChange:e[1]||(e[1]=(...o)=>i.onFileChange&&i.onFileChange(...o))},null,32)]),s.imagePreview?(te(),ne("div",sN,[m("img",{src:s.imagePreview,class:"image-preview",alt:"Preview"},null,8,iN)])):Tt("",!0),tn(m("input",{"onUpdate:modelValue":e[2]||(e[2]=o=>s.name=o),placeholder:"Category Name",required:""},null,512),[[wn,s.name]]),m("div",oN,[aN,m("label",cN,[tn(m("input",{type:"checkbox","onUpdate:modelValue":e[3]||(e[3]=o=>s.receivingOrders=o)},null,512),[[BT,s.receivingOrders]]),lN]),m("span",uN,he(s.receivingOrders?"Yes":"No"),1)]),m("button",{type:"submit",class:"primary-btn",disabled:s.uploading},"Add Category",8,hN)],32),s.message?(te(),ne("p",dN,he(s.message),1)):Tt("",!0)])])}const mN=an(QV,[["render",fN],["__scopeId","data-v-b27febf0"]]);const pN={data(){return{name:"",link:"",receivingOrders:!1,email:"",message:"",loaded:!1,imageFile:null,imagePreview:"",uploading:!1,showDeleteConfirm:!1}},mounted(){const t=this.$route.params.id;me.firestore().collection("categories").doc(t).get().then(n=>{if(n.exists){const r=n.data();this.name=r.name||"",this.link=r.link||"",this.receivingOrders=r.receivingOrders===!0,this.email=r.email||"",this.loaded=!0}else this.message="Category not found."}).catch(n=>{this.message="Error: "+n.message})},methods:{triggerFileInput(){this.$refs.fileInput.click()},onFileChange(t){const e=t.target.files[0];e&&(this.imageFile=e,this.imagePreview=URL.createObjectURL(e))},async uploadImage(){if(!this.imageFile)return this.link;this.uploading=!0;const t=me.storage().ref(),e=`category_images/${Date.now()}_${this.imageFile.name}`,n=t.child(e);await n.put(this.imageFile);const r=await n.getDownloadURL();return this.uploading=!1,r},async updateCategory(){const t=this.$route.params.id;let e=this.link;this.imageFile&&(e=await this.uploadImage()),me.firestore().collection("categories").doc(t).update({name:this.name,link:e,receivingOrders:this.receivingOrders,email:this.email}).then(()=>{this.message="Category updated!",setTimeout(()=>{this.$router.push("/admin")},1e3)}).catch(r=>{this.message="Error: "+r.message})},goBack(){this.$router.push("/admin")},async deleteCategory(){const t=this.$route.params.id;await me.firestore().collection("categories").doc(t).delete(),this.showDeleteConfirm=!1,this.$router.push("/admin")}}},aa=t=>(gr("data-v-35aa221e"),t=t(),_r(),t),gN={class:"admin-merchant-wrapper"},_N={class:"admin-merchant-content"},yN={class:"edit-actions"},wN=aa(()=>m("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none"},[m("path",{d:"M15 19l-7-7 7-7",stroke:"#fff","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)),EN=[wN],IN=aa(()=>m("h1",{class:"admin-dashboard-title"},"Edit Category",-1)),vN={class:"image-upload-row"},TN=aa(()=>m("label",{class:"image-upload-label"},"Hero Image",-1)),bN={class:"image-hero-container"},AN=["src"],RN=aa(()=>m("svg",{width:"22",height:"22",viewBox:"0 0 20 20",fill:"none"},[m("path",{d:"M17.414 2.586a2 2 0 0 0-2.828 0l-9.5 9.5A2 2 0 0 0 4 13.414V16a1 1 0 0 0 1 1h2.586a2 2 0 0 0 1.414-.586l9.5-9.5a2 2 0 0 0 0-2.828l-2-2z",stroke:"#333","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),m("path",{d:"M15 5l-10 10",stroke:"#333","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)),PN=[RN],SN=["disabled"],CN={key:1,class:"form-message"},xN={key:2,class:"modal-overlay"},DN={class:"modal-content"},kN=aa(()=>m("h2",null,"Delete Category",-1));function VN(t,e,n,r,s,i){return te(),ne("div",gN,[m("div",_N,[m("div",yN,[m("button",{class:"back-btn",onClick:e[0]||(e[0]=(...o)=>i.goBack&&i.goBack(...o)),title:"Back"},EN)]),IN,s.loaded?(te(),ne("form",{key:0,onSubmit:e[4]||(e[4]=Vc((...o)=>i.updateCategory&&i.updateCategory(...o),["prevent"])),class:"admin-form"},[m("div",vN,[TN,m("div",bN,[m("img",{src:s.imagePreview||s.link,class:"image-preview",alt:"Hero"},null,8,AN),m("button",{type:"button",class:"edit-image-btn",onClick:e[1]||(e[1]=(...o)=>i.triggerFileInput&&i.triggerFileInput(...o)),title:"Replace image"},PN),m("input",{ref:"fileInput",type:"file",accept:"image/*",onChange:e[2]||(e[2]=(...o)=>i.onFileChange&&i.onFileChange(...o)),style:{display:"none"}},null,544)])]),tn(m("input",{"onUpdate:modelValue":e[3]||(e[3]=o=>s.name=o),placeholder:"Category Name",required:""},null,512),[[wn,s.name]]),m("button",{type:"submit",class:"primary-btn",disabled:s.uploading},"Update Category",8,SN)],32)):Tt("",!0),s.message?(te(),ne("p",CN,he(s.message),1)):Tt("",!0),s.showDeleteConfirm?(te(),ne("div",xN,[m("div",DN,[kN,m("p",null,[Dt("Are you sure you want to delete "),m("b",null,he(s.name),1),Dt("? This cannot be undone.")]),m("button",{class:"delete-btn",onClick:e[5]||(e[5]=(...o)=>i.deleteCategory&&i.deleteCategory(...o))},"Yes, Delete"),m("button",{class:"close-btn",onClick:e[6]||(e[6]=o=>s.showDeleteConfirm=!1)},"Cancel")])])):Tt("",!0)])])}const NN=an(pN,[["render",VN],["__scopeId","data-v-35aa221e"]]);const ON={data(){return{categoryId:"",categoryName:"",products:[],loaded:!1,categoryLoaded:!1,name:"",link:"",imageFile:null,imagePreview:"",uploading:!1,message:"",showDropdown:!1,receivingOrders:!1}},mounted(){this.categoryId=this.$route.params.categoryId,this.fetchCategory(),this.fetchProducts(),document.addEventListener("click",this.handleClickOutside)},beforeDestroy(){document.removeEventListener("click",this.handleClickOutside)},methods:{fetchCategory(){me.firestore().collection("categories").doc(this.categoryId).get().then(e=>{if(e.exists){const n=e.data();this.categoryName=n.name||"",this.name=n.name||"",this.link=n.link||"",this.receivingOrders=n.receivingOrders===!0,this.categoryLoaded=!0}})},fetchProducts(){this.loaded=!1,me.firestore().collection("categories").doc(this.categoryId).collection("products").get().then(e=>{this.products=[],e.forEach(n=>{const r=n.data();r.id=n.id,this.products.push(r)}),this.loaded=!0})},deleteProduct(t){me.firestore().collection("categories").doc(this.categoryId).collection("products").doc(t.id).delete().then(()=>{this.fetchProducts()})},goToAdd(){this.$router.push(`/admin/menu/${this.categoryId}/add`)},goBack(){this.$router.push("/admin")},goToEditCategory(){this.$router.push(`/admin/edit/${this.categoryId}`)},triggerFileInput(){this.$refs.fileInput.click()},onFileChange(t){const e=t.target.files[0];e&&(this.imageFile=e,this.imagePreview=URL.createObjectURL(e))},async uploadImage(){if(!this.imageFile)return this.link;this.uploading=!0;const t=me.storage().ref(),e=`category_images/${Date.now()}_${this.imageFile.name}`,n=t.child(e);await n.put(this.imageFile);const r=await n.getDownloadURL();return this.uploading=!1,r},async updateCategory(){let t=this.link;this.imageFile&&(t=await this.uploadImage()),me.firestore().collection("categories").doc(this.categoryId).update({name:this.name,link:t}).then(()=>{this.message="Category updated!",setTimeout(()=>{this.message=""},1e3),this.fetchCategory()}).catch(n=>{this.message="Error: "+n.message})},toggleDropdown(){this.showDropdown=!this.showDropdown},toggleReceivingOrders(){const t=me.firestore(),e=!this.receivingOrders;t.collection("categories").doc(this.categoryId).update({receivingOrders:e}).then(()=>{this.receivingOrders=e,this.showDropdown=!1})},handleClickOutside(t){this.showDropdown&&this.$refs.dropdown&&!this.$refs.dropdown.contains(t.target)&&(this.showDropdown=!1)},deleteCategory(){this.showDropdown=!1,me.firestore().collection("categories").doc(this.categoryId).delete().then(()=>{this.message="Category deleted!",setTimeout(()=>{this.message="",this.$router.push("/admin")},1e3)}).catch(e=>{this.message="Error: "+e.message})}}},Al=t=>(gr("data-v-b9545b64"),t=t(),_r(),t),MN={class:"admin-menu-wrapper"},FN={class:"admin-menu-content"},LN={class:"edit-actions"},BN=Al(()=>m("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none"},[m("path",{d:"M15 19l-7-7 7-7",stroke:"#fff","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)),UN=[BN],$N={class:"edit-actions-right"},qN={class:"dropdown-wrapper",ref:"dropdown"},jN=Al(()=>m("svg",{width:"24",height:"24",viewBox:"0 0 24 24"},[m("circle",{cx:"5",cy:"12",r:"2",fill:"#333"}),m("circle",{cx:"12",cy:"12",r:"2",fill:"#333"}),m("circle",{cx:"19",cy:"12",r:"2",fill:"#333"})],-1)),zN=[jN],KN={key:0,class:"dropdown-menu"},GN=Al(()=>m("h1",{class:"admin-dashboard-title"},"Edit Menu",-1)),HN={key:0,class:"form-message"},WN={key:1,class:"loading"},QN={key:2},YN={class:"category-name"},JN={class:"menu-table-wrapper"},XN={class:"menu-table"},ZN=Al(()=>m("thead",null,[m("tr",null,[m("th",null,"Image"),m("th",null,"Name"),m("th",null,"Price"),m("th",null,"Edit")])],-1)),eO=["src"],tO=["onClick"],nO=cT('<svg width="22" height="22" viewBox="0 0 24 24" fill="none" data-v-b9545b64><path d="M3 6h18" stroke="#e53935" stroke-width="2" stroke-linecap="round" data-v-b9545b64></path><path d="M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2" stroke="#e53935" stroke-width="2" data-v-b9545b64></path><rect x="5" y="6" width="14" height="14" rx="2" stroke="#e53935" stroke-width="2" data-v-b9545b64></rect><path d="M10 11v6" stroke="#e53935" stroke-width="2" stroke-linecap="round" data-v-b9545b64></path><path d="M14 11v6" stroke="#e53935" stroke-width="2" stroke-linecap="round" data-v-b9545b64></path></svg>',1),rO=[nO];function sO(t,e,n,r,s,i){return te(),ne("div",MN,[m("div",FN,[m("div",LN,[m("button",{class:"back-btn",onClick:e[0]||(e[0]=(...o)=>i.goBack&&i.goBack(...o)),title:"Back"},UN),m("div",$N,[m("div",qN,[m("button",{class:"burger-btn",onClick:e[1]||(e[1]=(...o)=>i.toggleDropdown&&i.toggleDropdown(...o)),title:"More actions"},zN),s.showDropdown?(te(),ne("div",KN,[m("button",{class:"dropdown-item",onClick:e[2]||(e[2]=(...o)=>i.goToEditCategory&&i.goToEditCategory(...o))},"Edit Category"),m("button",{class:"dropdown-item delete",onClick:e[3]||(e[3]=(...o)=>i.deleteCategory&&i.deleteCategory(...o))},"Delete Category"),m("button",{class:"dropdown-item",onClick:e[4]||(e[4]=(...o)=>i.toggleReceivingOrders&&i.toggleReceivingOrders(...o))},"Receiving Orders: "+he(s.receivingOrders?"On":"Off"),1)])):Tt("",!0)],512)])]),GN,s.message?(te(),ne("p",HN,he(s.message),1)):Tt("",!0),s.loaded?(te(),ne("div",QN,[m("h2",YN,he(s.categoryName),1),m("div",JN,[m("table",XN,[ZN,m("tbody",null,[(te(!0),ne(It,null,Gs(s.products,o=>(te(),ne("tr",{key:o.id},[m("td",null,[o.image_url?(te(),ne("img",{key:0,src:o.image_url,class:"menu-item-image",alt:"Product"},null,8,eO)):Tt("",!0)]),m("td",null,he(o.name),1),m("td",null,"$"+he(o.price),1),m("td",null,[m("button",{class:"delete-icon-btn",onClick:a=>i.deleteProduct(o),title:"Delete"},rO,8,tO)])]))),128))])])]),m("button",{class:"fab",onClick:e[5]||(e[5]=(...o)=>i.goToAdd&&i.goToAdd(...o))},"+")])):(te(),ne("div",WN,"Loading..."))])])}const iO=an(ON,[["render",sO],["__scopeId","data-v-b9545b64"]]);const oO={data(){return{name:"",price:"",imageFile:null,imagePreview:"",uploading:!1,message:""}},methods:{goBack(){this.$router.push(`/admin/menu/${this.$route.params.categoryId}`)},onFileChange(t){const e=t.target.files[0];e&&(this.imageFile=e,this.imagePreview=URL.createObjectURL(e))},async uploadImage(){if(!this.imageFile)return"";this.uploading=!0;const t=me.storage().ref(),e=`product_images/${Date.now()}_${this.imageFile.name}`,n=t.child(e);await n.put(this.imageFile);const r=await n.getDownloadURL();return this.uploading=!1,r},async addProduct(){let t="";this.imageFile&&(t=await this.uploadImage());const e=me.firestore(),n=this.$route.params.categoryId;e.collection("categories").doc(n).collection("products").add({name:this.name,price:this.price,image_url:t}).then(()=>{this.message="Product added!",setTimeout(()=>{this.$router.push(`/admin/menu/${n}`)},1e3)}).catch(r=>{this.message="Error: "+r.message})}}},_I=t=>(gr("data-v-154eacfd"),t=t(),_r(),t),aO={class:"admin-add-product-wrapper"},cO={class:"admin-add-product-content"},lO=_I(()=>m("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none"},[m("path",{d:"M15 19l-7-7 7-7",stroke:"#fff","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)),uO=[lO],hO=_I(()=>m("h1",{class:"admin-dashboard-title"},"Add Product",-1)),dO={key:0,class:"image-preview-container"},fO=["src"],mO=["disabled"],pO={key:0,class:"form-message"};function gO(t,e,n,r,s,i){return te(),ne("div",aO,[m("div",cO,[m("button",{class:"back-btn",onClick:e[0]||(e[0]=(...o)=>i.goBack&&i.goBack(...o)),title:"Back"},uO),hO,m("form",{onSubmit:e[4]||(e[4]=Vc((...o)=>i.addProduct&&i.addProduct(...o),["prevent"])),class:"admin-form"},[tn(m("input",{"onUpdate:modelValue":e[1]||(e[1]=o=>s.name=o),placeholder:"Product Name",required:""},null,512),[[wn,s.name]]),tn(m("input",{"onUpdate:modelValue":e[2]||(e[2]=o=>s.price=o),placeholder:"Price",type:"number",min:"0",step:"0.01",required:""},null,512),[[wn,s.price,void 0,{number:!0}]]),m("input",{type:"file",accept:"image/*",onChange:e[3]||(e[3]=(...o)=>i.onFileChange&&i.onFileChange(...o))},null,32),s.imagePreview?(te(),ne("div",dO,[m("img",{src:s.imagePreview,class:"image-preview",alt:"Preview"},null,8,fO)])):Tt("",!0),m("button",{type:"submit",class:"primary-btn",disabled:s.uploading},"Add Product",8,mO)],32),s.message?(te(),ne("p",pO,he(s.message),1)):Tt("",!0)])])}const _O=an(oO,[["render",gO],["__scopeId","data-v-154eacfd"]]),yO={name:"Contact",data(){return{name:"",email:"",message:"",loading:!1,successMessage:"",errorMessage:""}},methods:{async submitForm(){this.successMessage="",this.errorMessage="",this.loading=!0;try{const t=new URLSearchParams({name:this.name,email:this.email,text:this.message});(await fetch(`https://api.theholylabs.com/subscribe?${t.toString()}`,{method:"POST"})).ok?(this.successMessage="Thank you for contacting us!",this.name="",this.email="",this.message=""):this.errorMessage="There was an error. Please try again later."}catch{this.errorMessage="There was an error. Please try again later."}finally{this.loading=!1}}}},wO={class:"container my-5"},EO=m("h2",{class:"mb-4"},"Contact Us",-1),IO={class:"mb-3"},vO=m("label",{for:"contact-name",class:"form-label"},"Your Name",-1),TO={class:"mb-3"},bO=m("label",{for:"contact-email",class:"form-label"},"Your Email",-1),AO={class:"mb-3"},RO=m("label",{for:"contact-message",class:"form-label"},"Message",-1),PO=["disabled"],SO={class:"mt-3"},CO={key:0,class:"text-success"},xO={key:1,class:"text-danger"};function DO(t,e,n,r,s,i){return te(),ne("div",wO,[EO,m("form",{onSubmit:e[3]||(e[3]=Vc((...o)=>i.submitForm&&i.submitForm(...o),["prevent"]))},[m("div",IO,[vO,tn(m("input",{type:"text",class:"form-control",id:"contact-name","onUpdate:modelValue":e[0]||(e[0]=o=>s.name=o),required:""},null,512),[[wn,s.name]])]),m("div",TO,[bO,tn(m("input",{type:"email",class:"form-control",id:"contact-email","onUpdate:modelValue":e[1]||(e[1]=o=>s.email=o),required:""},null,512),[[wn,s.email]])]),m("div",AO,[RO,tn(m("textarea",{class:"form-control",id:"contact-message","onUpdate:modelValue":e[2]||(e[2]=o=>s.message=o),rows:"5",required:""},null,512),[[wn,s.message]])]),m("button",{type:"submit",class:"btn btn-success",disabled:s.loading},"Send Message",8,PO),m("div",SO,[s.successMessage?(te(),ne("span",CO,he(s.successMessage),1)):Tt("",!0),s.errorMessage?(te(),ne("span",xO,he(s.errorMessage),1)):Tt("",!0)])],32)])}const kO=an(yO,[["render",DO]]),VO=[{path:"/",name:"Home",component:fA},{path:"/shop",name:"Shop",component:Mx},{path:"/cart",name:"Cart",component:UD},{path:"/payment-success",name:"PaymentSuccess",component:sk},{path:"/admin",name:"AdminDashboard",component:_k},{path:"/admin/add",name:"AdminAddCategory",component:mN},{path:"/admin/edit/:id",name:"AdminEditCategory",component:NN,props:!0},{path:"/admin/menu/:categoryId",name:"AdminMenuManager",component:iO,props:!0},{path:"/admin/menu/:categoryId/add",name:"AdminAddProduct",component:_O,props:!0},{path:"/contact",name:"Contact",component:kO}],NO=Xb({history:mb(),routes:VO});KT(YT).use(NO).mount("#app");
